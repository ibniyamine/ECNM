/*! 22.0.0.2 */
/*! VersionVI: 01F250052j x */
function IWDConstante(){}function Align(){}function IWDChartConstant(){}function ETimeScale(){}function eDESSINVALEURNULLE(){}function ETypeCategorieWaterfall(){}function _clone(n,t){return clWDUtil.isObject(n)&&clWDUtil.isObject(t)?$.extend(!0,t,n):JSON.parse(JSON.stringify(n))}function sGetFunctionName(n){var t=n.name;if(!t){var i=n.toString(),r=i.indexOf(" ")+1,u=i.indexOf("(");t=i.substr(r,u-r).trim()}return t}function bCompareFonctions(n,t){return n==t?!0:sGetFunctionName(n)==sGetFunctionName(t)?!0:!1}function stPath(n,t,i,r,u){if(arguments.length){if(clWDUtil.isObject(n)){var f=n;i=WDRect.getWidth(f)/2;r=WDRect.getHeight(f)/2;u=t;t=f.m_nTop+WDRect.getHeight(f)/2;n=f.m_nLeft+WDRect.getWidth(f)/2}this.x=n;this.y=t;this.width=i;this.height=r;this.options=u}}function EPointStyle(){}function JSONPOO(n){arguments.length&&$.extend(this,n)}function WDGraphe(n,t,i,r,u){if(arguments.length){WDChampParametresHote.prototype.constructor.apply(this,arguments);var f=u[6],e=u[7],o=u[8];this.m_tabEtat=f;this.m_sURLBase=e;this.m_bInteractif=o;this.m_oVue=new WDChartView(this);this.m_oModele=undefined;this.m_oBarreAutomatique=WDBarreOutilsGraphe.s_pclCreate(this,arguments)}}function WDChartSeries(n,t,i){if(arguments.length){JSONPOO.prototype.constructor.apply(this,[t]);i&&(this.m_tabValeur=i);this.m_oGraphe=n;this.m_dMinValue=Number.POSITIVE_INFINITY;this.m_dMaxValue=Number.NEGATIVE_INFINITY;this.m_bContainDecimalValues=!1;this.m_tabValeur||(this.m_tabValeur=[]);for(var r=0;r<this.m_tabValeur.length;++r)this.onValueAddedOrChanged(this.m_tabValeur[r])}}function WDChartAnimator(n){arguments.length&&(this.m_tabAnimations=[],this.m_oGraphe=n,this.m_bDessinComplet=!0)}function WDChartAnimation(n,t){arguments.length&&(this.duration=400,this.easing="swing",this.m_oAnimator=undefined,this.m_oPicture=t,this.m_domEtatInitial=undefined,this.m_oGraphe=n,this.m_dNow=0,this.m_dProgress=0,this.m_dRemainingMS=this.duration,this.queue="fx",this.m_domBaliseAnim=$("<p/>"),this.oStyleCssAnimation={content:1},this.m_bToujoursAvecLibelles=!1)}function WDChartAnimationValeur(n){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_oModelePrecedent=n.m_oVue.m_oModelePrecedent===undefined?undefined:n.m_oVue.m_oModelePrecedent,this.duration=600,this.easing="swing")}function WDChartXYAnimationValeur(){arguments.length&&(WDChartAnimationValeur.prototype.constructor.apply(this,arguments),this.m_bDejaRelativise=!1)}function WDXYChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDPieChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDPieChartZoomAnimation(n,t,i,r){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.duration=200,this.easing="easeInOutQuint",this.m_bIn=i,this.m_dZoom=1+(this.m_bIn?1:-1)*.1*(r||1))}function WDChartAnimationNoDraw(){arguments.length&&WDChartAnimation.prototype.constructor.apply(this,arguments)}function WDPieChartAnimationSurbrillancePartNoDraw(n,t,i,r){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.m_nEcart=10,this.m_nEcartInitial=r.parent().wbData("wbGrfAnimSurbrillanceEcart")||0,this.duration=200,this.easing="swing")}function WDPieChartAnimationSelectionLegende(n,t,i){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domPartSelectionne=i,this.m_nIndiceValeurDansSerie=WDPieChartRenderer.nGetIndicePart(t,this.m_domPartSelectionne),this.m_bAffiche=!this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndiceValeurDansSerie),this.duration=1e3,this.easing="easeOutExpo")}function WDPieChartAnimationSurbrillancePart(n,t,i,r){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.duration=this.m_bEtat?1:1,this.easing="swing")}function WDPieChartAnimation1erAffichageBase(n){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="easeOutExpo")}function WDPieChartAnimation1erAffichageArretDuVinyle(){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.m_dPourcentRotation=.2)}function WDPieChartAnimationSelectionPart(n,t,i){if(arguments.length){WDChartAnimation.prototype.constructor.apply(this,arguments);this.m_dAngleAffichage=90;this.m_dAngleInitial=n.m_oVue.m_oRenderer.getInitialStartAngle(n.m_oVue.m_oRenderer.m_params);var r=i.wbData("wbGrfDrawPath");for(this.m_dAngleFinal=(this.m_dAngleAffichage-(r.options.startAngle-r.options.firstAngle+r.options.sweep/2))%360;(this.m_dAngleInitial>this.m_dAngleFinal?this.m_dAngleInitial-this.m_dAngleFinal:this.m_dAngleFinal-this.m_dAngleInitial)>180;)this.m_dAngleInitial>this.m_dAngleFinal?this.m_dAngleFinal+=360:this.m_dAngleInitial+=360}}function WDPieChartAnimation1erAffichageWindevLike(){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.m_dPourcentRotation=0,this.easing="swing")}function WDPieChartAnimation1erAffichageClipPath(){arguments.length&&WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments)}function WDPieChartAnimation1erAffichageAngleFinCroissant(n){arguments.length&&(WDPieChartAnimation1erAffichageBase.prototype.constructor.apply(this,arguments),this.duration=1e3,this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oVue.m_oRenderer.m_rectChart))}function WDChartListener(n,t){arguments.length&&(this.m_oVue=n.m_oVue,this.m_oGraphe=n,this.m_domBalise=t)}function WDChartMireListener(n,t,i){arguments.length&&(WDChartListener.prototype.constructor.apply(this,arguments),this.m_domBulle=i)}function WDXYChartLegendListener(n,t,i,r){arguments.length&&(WDChartListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDPieChartSelectionnePartListenerBase(){arguments.length&&WDChartListener.prototype.constructor.apply(this,arguments)}function WDPieChartAnimationTourneNoDraw(n,t,i){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_nAngle=i)}function WDPieChartPartListener(){arguments.length&&(WDPieChartSelectionnePartListenerBase.prototype.constructor.apply(this,arguments),this.m_domLegende=undefined)}function WDPieChartLegendListener(){arguments.length&&(WDPieChartSelectionnePartListenerBase.prototype.constructor.apply(this,arguments),this.m_domPart=undefined)}function WDChartParameters(n,t){var i,r;arguments.length&&(JSONPOO.prototype.constructor.apply(this,[t]),this.m_bAnimationGraphe===!1&&(this.m_nDureeAnimation=0),this.m_sClasseBulle||this.m_oPoliceBulle||(i=WDPaintCSS.oGetInfoCSS(this.m_sClasseLibelle,"0",["fontFamily","fontWeight","fontStyle","textDecoration","fontSize","color"],"color:black"),this.m_oPoliceBulle={m_sNom:i.fontFamily,m_nGras:i.fontWeight,m_bItalique:i.fontStyle=="italic",m_bSouligne:(i.textDecoration||"").indexOf("underline")>-1?1:0,m_bBarre:(i.textDecoration||"").indexOf("line-through")>-1?1:0,m_sTaille:i.fontSize,m_sCouleur:i.color}),r=this,clWDUtil.bForEachIn(["Titre","Axe","Legende","Libelle","Valeur","Bulle"],function(t,i){return r["m_oPolice"+i]&&(r["m_sClasse"+i]=WDChartParameters.__sCreeClasseDepuisPolice(n,r["m_oPolice"+i],i)),!0}),this.m_sClasseValeur&&this.m_sClasseValeur!=""||(this.m_sClasseValeur=this.m_sClasseLibelle))}function WDChartUtils(){}function WDMathUtils(){}function WDRect(n,t,i,r){this.set(n,t,i,r)}function EAxisType(){}function EAxisOrientation(){}function WDChartAxis(n,t,i){var r,u,f;if(arguments.length){for(this.m_type=n,this.m_lstData=t,this.m_dOriginValue=0,this.m_dMinValue=Number.NEGATIVE_INFINITY,this.m_dMaxValue=Number.POSITIVE_INFINITY,this.m_oModele=i,this.m_dOriginValue=0,r=this.isXAxis(),this.m_oModele.m_oParametres.m_bAxeXHorizontal||(r=!r),this.m_orientation=r?EAxisOrientation.HORIZONTAL:this.m_type==EAxisType.Z?undefined:EAxisOrientation.VERTICAL,u=0;u<this.m_lstData.length;++u)f=this.m_lstData[u],f.m_axis=this;this.update(this.m_oModele.m_oParametres)}}function WDChartAxisContinu(){arguments.length&&WDChartAxis.prototype.constructor.apply(this,arguments)}function EAlgoGestionAltitude(){}function CCouleurAltitude(n){arguments.length&&(JSONPOO.prototype.constructor.apply(this,[{m_tabCouleurAltitude:n.m_tabCouleurAltitude||{},m_eAlgoPalier:n.m_eAlgoPalier||EAlgoGestionAltitude.eagaDegradeLineaire}]),this.m_tabKeysTriees=[],this.Trie())}function WDChartCategories(n,t){arguments.length&&(JSONPOO.prototype.constructor.apply(this,[t]),this.m_axis=undefined,this.m_oModele=n,this.bEchelleTemporelle()&&(this.m_tabValeurMS=this.tabConvertionVersValeursTemporels(n.m_oParametres.m_sMasqueAxeTemporel||this.sGetFormatDefaut())))}function WDChartModel(n){if(arguments.length){this.m_oGraphe=n;JSONPOO.prototype.constructor.apply(this,[n.m_oDonnees]);for(var t=0;this.m_tabSeries&&t<this.m_tabSeries.length;++t)this.m_tabSeries[t]=new WDChartSeries(n,this.m_tabSeries[t]);this.m_oParametres=new WDChartParameters(n,n.m_oParametres);this.m_oCategories=new WDChartCategories(this,this.m_oCategories);this.m_lstAxis=undefined}}function WDPaintCSS(n){this.m_oStyle={};this.m_stRadialGradient=undefined;this.m_stLinearGradient=undefined;this.m_sClasse=undefined;JSONPOO.prototype.constructor.apply(this,[n])}function WDPictureSVG(n){arguments.length&&(this.m_Id=n.m_oHoteImage.id,this.m_domBaliseSVG=undefined,this.m_domDefsSVG=undefined,this.m_tabClipActif=[],this.m_bDessinDirectementDansLaPage=!1,this.m_b3DActive=!1,this.m_b3DInnerOuterDansPartEffet=!1,this.m_oGraphe=undefined,this.m_tabCache=[],this.m_bAncrageLargeur=!1,this.m_bAncrageHauteur=!1,this.m_tabId={})}function WDSvgAnimation(n,t,i,r,u,f){arguments.length&&(WDChartAnimation.prototype.constructor.apply(this,arguments),this.m_domBalise=i,this.m_oAttributsAvant=r,this.m_oAttributs=u,this.m_oPicture=t,this.duration=100,this.easing="linear",this.queue=sGetFunctionName(this.constructor),this.m_domBaliseAnim=this.m_domBalise,this.ArreteEtVideAnimations(this.m_domBaliseAnim),this.m_fFinAnimation=undefined,f&&(this.oStyleCssAnimation=f))}function WDSvgAnimationGridLine(n){arguments.length&&(WDSvgAnimation.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation,WDSvgAnimationGridLine.ms_bActiveAnimation!==!0&&(this.duration=0))}function WDSvgAnimationBulle(n,t){if(arguments.length){WDSvgAnimation.prototype.constructor.apply(this,arguments);this.duration=WDSvgAnimationBulle.gbEase==!0?200:150;var i=(n||t.m_oGraphe).m_oModele.m_oParametres.getType();(i==WDChartParameters.kSecteur||i==WDChartParameters.kDonut||i==WDChartParameters.kHemicycle)&&(this.duration=200);this.easing=WDSvgAnimationBulle.gbEase==!0?"easeOutExpo":"linear"}}function WDSvgAnimationLegende(){arguments.length&&(WDSvgAnimation.prototype.constructor.apply(this,arguments),this.duration=600,this.easing="easeOutExpo")}function WDChartRenderer(){arguments.length&&(this.m_oPaint=undefined,this.m_oGraphe=undefined,this.m_rectChart=undefined,this.m_rectChartInitial=undefined,this.m_dInitialStartAngle=0,this.m_domGroupeSeries=undefined,this.m_domGroupeLegendeEtTitre=undefined,this.m_domBulle=undefined,this.m_nPasSerie=1,this.m_nNbMaxSerieLegende=undefined)}function WDXYChartRenderer(){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),this.m_tabAxisRenderer=[],this.m_rectAxis=new WDRect,this.m_nXOrigin=0,this.m_nYOrigin=0,this.m_nXOrigin2=0,this.m_nYOrigin2=0,this.m_dXPixelsPerUnit=0,this.m_dX2PixelsPerUnit=0,this.m_dYPixelsPerUnit=0,this.m_dY2PixelsPerUnit=0,this.m_timeScale=ETimeScale.NONE,this.m_ProtoLegendListener=WDXYChartLegendListener)}function WDChartView(){arguments.length&&(this.m_oRenderer=undefined,this.m_oPicture=undefined,this.m_oModeleInitialSeries=undefined,this.m_tabSeriesMasquees=[],this.m_oModelePrecedent=undefined)}function WDBarreBoutonOnOffGraphe(n,t,i){arguments.length&&WDBarreBoutonOnOff.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i]])}function WDBarreBoutonGraphe(n,t,i){arguments.length&&WDBarreBouton.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i]])}function WDBarreOutilsGraphe(n,t){arguments.length&&(WDBarre.prototype.constructor.apply(this,t),this.m_oGraphe=n,this.m_tabDescBarre=[{nType:0,sSuf:"GDH",sCom:"GDH"},{nType:0,sSuf:"GDV",sCom:"GDV"},{nType:0,sSuf:"SMO",sCom:"SMO"},{nType:0,sSuf:"GRA",sCom:"GRA"},{nType:0,sSuf:"RAI",sCom:"RAI"},{nType:0,sSuf:"ANT",sCom:"ANT"},{nType:0,sSuf:"TRA",sCom:"TRA"},{nType:2,sSuf:"SAV",sCom:"OnSave",tabP:[]},{nType:2,sSuf:"PRI",sCom:"OnPrint",tabP:[]},{nType:5,sSuf:"PIE",sCom:"OnOption",tabP:["P","H","D","E"]},{nType:5,sSuf:"COL",sCom:"OnOption",tabP:["C","S","HC","HS","W"]},{nType:5,sSuf:"CUR",sCom:"OnOption",tabP:["C","S","A","R","B","H"]},{nType:5,sSuf:"STO",sCom:"OnOption",tabP:["C","B","M"]},{nType:4,sSuf:"LEG",sCom:"OnOption",tabP:["S","D","G","H","B"]},{nType:0,sSuf:"ANI",sCom:"ANI"},{nType:0,sSuf:"INT",sCom:"INT"},{nType:5,sSuf:"MIR",sCom:"OnOption",tabP:["MUL","MIR","BUL"]}],this.m_tabConversionCom={PIE:"TYP",COL:"TYP",CUR:"TYP",STO:"TYP",LEG:"LEG",MIR:"MIR"},this.m_tabConversionVal={PIE:[0,26,23,33],COL:[1,9,27,28,35],CUR:[2,5,24,25,32,37],STO:[6,7,8],LEG:[0,1,2,3,4],MIR:[0,1,2]})}function WDBurger(){arguments.length&&(WDBarreOutilsGraphe.prototype.constructor.apply(this,arguments),this.m_jqUlMenu=undefined,this.m_jqDivPositionBurger=undefined,this.m_jqBurger=undefined,this.m_bAvecTitreDeplacable=!0)}function WDChartAxisRenderer(){arguments.length&&(this.m_axis=undefined,this.m_tabGraduationLabels=[],this.m_dStep=0,this.m_dLeftOverflow=0,this.m_dRightOverflow=0,this.m_dTopOverflow=0,this.m_dBottomOverflow=0,this.m_nNbPositiveGraduations=0,this.m_nNbNegativeGraduations=0,this.m_bVerticalOrientationLabel=!1)}function WDBarChartRenderer(){arguments.length&&(WDXYChartRenderer.prototype.constructor.apply(this,arguments),this.m_tabCumulatedValues=undefined,this.m_nBarWidth=0,this.m_nBarSpacing=0,this.m_barRect=new WDRect)}function WDBarChartAxisRenderer(){arguments.length&&WDChartAxisRenderer.prototype.constructor.apply(this,arguments)}function WDFunnelChartRenderer(n){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),n.m_oVue.m_oModelePrecedent=undefined,this.m_nHauteurEmbout=0,this.m_nLargeurEmbout=0,this.m_nAireTotaleUtile=0,this.m_dSommeValeurs=0,this.m_clRectCalcul=this.m_rectChart,this.m_clTabPortions=[])}function WDFunnelChartAnimator(){arguments.length&&WDChartAnimator.prototype.constructor.apply(this,arguments)}function WDFunnelChartAnimationSurbrillancePartNoDraw(n,t,i,r){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.m_domPartEnSurbrillance=r,this.m_bEtat=i,this.m_nEchelle=n.m_oVue.m_oRenderer.m_params.m_nEspacement,this.m_nEchelleInitiale=r.wbData("wbGrfAnimSurbrillanceEcart")||0,this.duration=200,this.easing="swing")}function WDFunnelChartAnimation1erAffichageCoulissantNoDraw(n){arguments.length&&(WDChartAnimationNoDraw.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="swing")}function WDFunnelChartAnimationValeur(n){arguments.length&&(WDChartAnimationValeur.prototype.constructor.apply(this,arguments),this.duration=n.m_oModele.m_oParametres.m_nDureeAnimation>0?n.m_oModele.m_oParametres.m_nDureeAnimation:1500,this.easing="easeOutExpo",this.duration=1e3,this.easing="swing")}function WDLineChartRenderer(){arguments.length&&WDXYChartRenderer.prototype.constructor.apply(this,arguments)}function Path(){this.d=""}function WDLineChartAxisRenderer(){arguments.length&&WDChartAxisRenderer.prototype.constructor.apply(this,arguments)}function WDPieChartRenderer(){arguments.length&&(WDChartRenderer.prototype.constructor.apply(this,arguments),this.m_nCenterX=0,this.m_nCenterY=0,this.m_nRadius=0,this.m_dTotalValue=0,this.tabLabelRenderers=undefined)}function WDLabelRenderer(n,t,i,r){arguments.length&&(this.m_oRenderer=n,this.m_strValueLabel=undefined,this.m_bValueLabel=!1,this.m_strCategoryLabel=undefined,this.m_bCategoryLabel=!1,this.m_strPercentLabel=undefined,this.m_bPercentLabel=!1,this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT,this.m_dAngleR=0,this.m_dWidth=0,this.m_nIndice=r,this.setAngle(t,i))}function WDCandleStickChartRenderer(){arguments.length&&(WDBarChartRenderer.prototype.constructor.apply(this,arguments),this.m_nPasSerie=4,this.m_nNbMaxSerieLegende=1)}function WDWaterfallChartRenderer(){arguments.length&&(WDBarChartRenderer.prototype.constructor.apply(this,arguments),this.m_nNbMaxSerieLegende=1)}function WDRadarChartRenderer(n){arguments.length&&(WDLineChartRenderer.prototype.constructor.apply(this,arguments),n.m_oVue.m_oModelePrecedent=undefined,this.m_nRayon=0,this.m_dAngleDelta=0,this.m_nNombreCategories=0,this.m_clCentreRadar={x:0,y:0},this.m_dValeurMin=0,this.m_dValeurMax=0,this.m_dFacteurEchelle=0,this.m_dPas=0,this.m_nGradMin=0,this.m_nGradMax=0,this.m_ProtoLegendListener=WDRadarChartLegendListener)}function WDRadarChartLegendListener(n,t,i,r){arguments.length&&(WDXYChartLegendListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDRadarChartAnimator(n){if(arguments.length){WDXYChartAnimator.prototype.constructor.apply(this,arguments);var i=n.m_oVue.m_oPicture,t=i.m_Id;this.m_domStyle=$(('<style class="wbGrfRadarChartAnimator'+t+'">#-groupe-series > g, #-groupe-series > g text{    transition:opacity 300ms; }/*#-groupe-series:hover > g,*/#-groupe-series.wbGrfHover > g{    opacity:0.2;        transition-delay:150ms;}/*#-groupe-series:hover > g text,*/#-groupe-series.wbGrfHover > g text{    opacity:0;        transition-delay:150ms;}/*#-groupe-series:hover > g:hover, */#-groupe-series.wbGrfHover > g.wbGrfHover{    opacity:1;    transition-delay:0;    }/*#-groupe-series:hover > g:hover text, */#-groupe-series.wbGrfHover > g.wbGrfHover text {    opacity:1;        transition-delay:0;    }<\/style>').replace(/\#/g,"#"+t));$("head").append(this.m_domStyle)}}function WDScatterChartRenderer(){arguments.length&&(WDLineChartRenderer.prototype.constructor.apply(this,arguments),this.m_nPasSerie=2)}function WDBubbleChartRenderer(){arguments.length&&(WDScatterChartRenderer.prototype.constructor.apply(this,arguments),this.m_nPasSerie=3,this.m_dRayonMaxBulle=0)}function WDHeatmapChartRenderer(){arguments.length&&(WDScatterChartRenderer.prototype.constructor.apply(this,arguments),this.m_nPasSerie=3,this.m_dValeurMinZ=0,this.m_dValeurMaxZ=0,this.m_clCouleurAltitudeHeatMap=undefined,this.m_ProtoLegendListener=WDHeatmapChartLegendListener)}function WDHeatmapChartLegendListener(n,t,i,r){arguments.length&&(WDXYChartLegendListener.prototype.constructor.apply(this,arguments),this.m_domLegende=t,this.m_domGroupeSerie=i,this.m_nIndexSerie=r)}function WDHeatmapChartAnimator(){arguments.length&&WDXYChartAnimator.prototype.constructor.apply(this,arguments)}function WDChartAnimationValeurHeatMap(){arguments.length&&WDChartAnimationValeur.prototype.constructor.apply(this,arguments)}function WDHeatMapChartAxisRenderer(){arguments.length&&WDLineChartAxisRenderer.prototype.constructor.apply(this,arguments)}IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE=0;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE=1;IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT=2;IWDConstante.ALIGNEMENT_HORIZONTAL_JUSTIFIE=3;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE_PICTO_GAUCHE=4;IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE_PICTO_DROITE=5;IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE_PICTO_GAUCHE=6;IWDConstante.ALIGNEMENT_HORIZONTAL_DROITE_PICTO_DROITE=7;Align.LEFT=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;Align.CENTER=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;Align.RIGHT=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;IWDConstante.ALIGNEMENT_VERTICAL_HAUT=0;IWDConstante.ALIGNEMENT_VERTICAL_CENTRE=1;IWDConstante.ALIGNEMENT_VERTICAL_BAS=2;IWDChartConstant.DEFAULT_VALUE=-2e9;IWDChartConstant.SPECIAL_VALUE=-Math.pow(2,31);IWDChartConstant.NULL_VALUE=undefined;IWDChartConstant.FLAG_LEGEND_POSITION_NONE=0;IWDChartConstant.FLAG_LEGEND_POSITION_LEFT=1;IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT=2;IWDChartConstant.FLAG_LEGEND_POSITION_TOP=4;IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM=8;IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL=16;IWDChartConstant.FLAG_LEGEND_POSITION_MASK=31;IWDChartConstant.FLAG_LEGEND_LABEL_IN_ROW=32;IWDChartConstant.FLAG_LEGEND_ADAPT_SIZE=64;IWDChartConstant.FLAG_LEGEND_ROUNDED_BORDER=128;IWDChartConstant.FLAG_TITLE_POSITION_NONE=0;IWDChartConstant.FLAG_TITLE_POSITION_TOP=256;IWDChartConstant.FLAG_TITLE_POSITION_BOTTOM=512;IWDChartConstant.FLAG_TITLE_POSITION_MANUAL=1024;IWDChartConstant.FLAG_TITLE_POSITION_MASK=1792;IWDChartConstant.FLAG_AXIS_LABEL_ORIENTATION_AUTO=0;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_VERTICAL=4096;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_HORIZONAL=8192;IWDChartConstant.FLAG_X_AXIS_LABEL_ORIENTATION_MASK=12288;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_VERTICAL=16384;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_HORIZONAL=32768;IWDChartConstant.FLAG_Y_AXIS_LABEL_ORIENTATION_MASK=49152;IWDChartConstant.FLAG_VERTICAL_GRID=65536;IWDChartConstant.FLAG_HORIZONTAL_GRID=131072;IWDChartConstant.FLAG_ANTIALIASING=262144;IWDChartConstant.FLAG_BORDER_COLOR_AUTO=524288;IWDChartConstant.FLAG_NO_GRADIENT=0;IWDChartConstant.FLAG_VERTICAL_GRADIENT=1048576;IWDChartConstant.FLAG_HORIZONTAL_GRADIENT=2097152;IWDChartConstant.FLAG_GRADIENT_MASK=3145728;IWDChartConstant.FLAG_NULL_VALUES_NOT_DRAWN=0;IWDChartConstant.FLAG_NULL_VALUES_IGNORED=4194304;IWDChartConstant.FLAG_NULL_VALUES_BACK_TO_ZERO=8388608;IWDChartConstant.FLAG_NULL_VALUES_MASK=12582912;IWDChartConstant.FLAG_ZOOM_NONE=0;IWDChartConstant.FLAG_ZOOM_HORIZONTAL=16777216;IWDChartConstant.FLAG_ZOOM_VERTICAL=33554432;IWDChartConstant.FLAG_ZOOM_MASK=50331648;IWDChartConstant.FLAG_LINE_SMOOTING=67108864;IWDChartConstant.FLAG_SHOW_VALUES_LABEL=134217728;IWDChartConstant.FLAG_BAR_CHART_STACKED=268435456;IWDChartConstant.FLAG_SHOW_CATEGORIES_LABEL=536870912;IWDChartConstant.FLAG_SHOW_PERCENTAGE=1073741824;IWDChartConstant.FLAG_HIDE_NULL_VALUES=2147483648;IWDChartConstant.FLAG_X_AXIS_TIME_SCALE=4294967296;IWDChartConstant.ReInitModeCompact=function(n){IWDChartConstant.DESSIN_COMPACT=n;IWDChartConstant.MARGIN_BORDER=7;IWDChartConstant.MARGIN_AXIS_TITLE=IWDChartConstant.DESSIN_COMPACT?3:5;IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL=4;IWDChartConstant.MARGIN_HORIZONTAL_GRADUATION_LABEL=4;IWDChartConstant.MARGIN_TITLE_GRAPH=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_LEGEND_BORDER=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_LEGEND_ELEMENTS=IWDChartConstant.DESSIN_COMPACT?4:10;IWDChartConstant.MARGIN_PIE=IWDChartConstant.DESSIN_COMPACT?3:5;IWDChartConstant.MARGIN_LABEL_PIE=IWDChartConstant.DESSIN_COMPACT?8:10;IWDChartConstant.MARGIN_LABEL=5;IWDChartConstant.MARGIN_LABEL_HORIZ=IWDChartConstant.MARGIN_LABEL;IWDChartConstant.LEGEND_SQUARE_SIZE=IWDChartConstant.DESSIN_COMPACT?4:10};IWDChartConstant.ReInitModeCompact(!1);IWDChartConstant.GRADUATION_MIN_SIZE_Y=25;IWDChartConstant.GRADUATION_MIN_SIZE_X_HORIZONTAL=20;IWDChartConstant.GRADUATION_MIN_SIZE_X_VERTICAL=10;IWDChartConstant.GRADUATION_TICK_SIZE=3;IWDChartConstant.BAR_MIN_WIDTH=5;IWDChartConstant.BAR_MIN_SPACING=1;IWDChartConstant.GR_COULEUR_AXE=0;IWDChartConstant.GR_COULEUR_AXE_RELIEF=1;IWDChartConstant.GR_COULEUR_QUADRILLAGE=2;IWDChartConstant.GR_COULEUR_QUADRILLAGE_RELIEF=3;IWDChartConstant.GR_COULEUR_LEGENDE=4;IWDChartConstant.GR_COULEUR_LEGENDE_FOND=5;IWDChartConstant.GR_COULEUR_BORDURE=6;IWDChartConstant.GR_COULEUR_CHANDELIER_HAUSSIER=7;IWDChartConstant.GR_TOUTES_SERIES=0;IWDChartConstant.GR_ORDONNEE=0;IWDChartConstant.GR_ABSCISSE=1;IWDChartConstant.GR_ORDONNEE_SECONDAIRE=2;IWDChartConstant.GR_SANS=0;IWDChartConstant.GR_DROITE=1;IWDChartConstant.GR_GAUCHE=2;IWDChartConstant.GR_HAUT=3;IWDChartConstant.GR_BAS=4;IWDChartConstant.GR_AFFICHE_VALEUR=0;IWDChartConstant.GR_AFFICHE_POURCENTAGE=1;IWDChartConstant.GR_AFFICHE_ETIQUETTE=2;IWDChartConstant.GR_AFFICHE_VALEUR_SI_NULLE=3;IWDChartConstant.GR_MASQUE_VALEUR=0;IWDChartConstant.GR_MASQUE_POURCENTAGE=1;IWDChartConstant.GR_MASQUE_AXE=2;IWDChartConstant.GR_PROGRAMMATION=0;IWDChartConstant.GR_FONCTION=1;IWDChartConstant.GR_RUBRIQUE=2;IWDChartConstant.GR_TABLEAU=3;IWDChartConstant.GR_LISTE=4;IWDChartConstant.GR_DONNEES=-1;IWDChartConstant.GR_DONNEES_ET_STYLE=-2;IWDChartConstant.GR_SECTEUR=0;IWDChartConstant.GR_HISTO=1;IWDChartConstant.GR_COURBE=2;IWDChartConstant.GR_HISTO_EMPILE=9;IWDChartConstant.GR_DONUT=23;IWDChartConstant.GR_AIRE=24;IWDChartConstant.GR_MIN=-20001;IWDChartConstant.GR_MAX=-20002;IWDChartConstant.GR_AXE_X=-10001;IWDChartConstant.GR_AXE_Y=-10002;IWDChartConstant.GR_SERIE=0;IWDChartConstant.GR_CATEGORIE=1;IWDChartConstant.GR_VALEUR=2;IWDChartConstant.GR_VALEUR_MIN=IWDChartConstant.GR_VALEUR;IWDChartConstant.GR_VALEUR_MAX=3;IWDChartConstant.GR_VALEUR_DEBUT=4;IWDChartConstant.GR_VALEUR_FIN=5;IWDChartConstant.GR_CHEMIN=6;ETimeScale.DATE=0;ETimeScale.TIME=1;ETimeScale.NONE=2;eDESSINVALEURNULLE.eValeurNulleNonDessinee=0;eDESSINVALEURNULLE.eValeurNulleIgnoree=1;eDESSINVALEURNULLE.eValeurNulleAZero=2;ETypeCategorieWaterfall.eWaterfallDefaut=0;ETypeCategorieWaterfall.eWaterfallTotal=1;ETypeCategorieWaterfall.eWaterfallSousTotal=2;ETypeCategorieWaterfall.eWaterfallPositif=3;ETypeCategorieWaterfall.eWaterfallNegatif=4;typeof Number.prototype.toRad=="undefined"&&(Number.prototype.toRad=function(n){return(n?this%360:this)*Math.PI/180},Number.prototype.toDeg=function(n){return(n?this%360:this)*(180/Math.PI)});stPath.prototype.constructor=stPath();EPointStyle.NONE=-1;EPointStyle.CIRCLE=0;EPointStyle.DIAMOND=1;EPointStyle.TRIANGLE=2;EPointStyle.SQUARE=3;EPointStyle.CROSS=4;WDGraphe.prototype=new WDChampParametresHote;WDGraphe.prototype.constructor=WDGraphe;WDGraphe.prototype.OnDisplay=function(n,t){if((WDChampParametresHote.prototype.OnDisplay.apply(this,arguments),WDBarre.prototype.OnDisplay.apply(this.m_oBarreAutomatique,arguments),t)&&this.m_bInteractif&&(this.m_oParametres.m_bInteractif||this.m_tabEtat.INT)){if(!this.m_oHoteImage){$(window).trigger("trigger.wb.grf.1erAffichage");return}clWDUtil.bEstFils(this.m_oHoteImage,n,document)&&this.m_oVue.m_oPicture.Init(this)&&(this._InitBarreAutomatique(),this.RafBarre(null),this.m_oVue.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait",!1),this.m_oVue.m_oAnimator&&(this.m_oVue.m_oAnimator.m_bDessinComplet=!0),this.relanceInitialisation(WDChartView.ms_nDessin1erAffichage))}};WDGraphe.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_OPACITE:return this.m_oVue.bEstInteractif()?this.m_oModele.m_oParametres.byGetAlpha()/2.55:clWDUtil.nGetOpacite(undefined,this.m_oHoteImage);default:return WDChampParametresHote.prototype.GetProp.apply(this,arguments)}};WDGraphe.prototype.SetProp=function(n,t,i){switch(n){case this.XML_CHAMP_PROP_NUM_ETAT:return this.m_oVue.bEstInteractif()&&(this.m_oParametres.m_eEtat=i,this.relanceInitialisation()),WDChampParametresHote.prototype.SetProp.apply(this,arguments);case this.XML_CHAMP_PROP_NUM_COULEURFOND:return this.m_oVue.bEstInteractif()&&(this.m_oParametres.m_sCouleurFond=i,this.relanceInitialisation()),WDChampParametresHote.prototype.SetProp.apply(this,arguments);case this.XML_CHAMP_PROP_NUM_OPACITE:return this.m_oVue.bEstInteractif()?(this.m_oParametres.m_bInterditAlpha=!1,this.m_oParametres.m_byAlpha=i*2.55,this.relanceInitialisation(),1):clWDUtil.nSetOpacite(i,this.m_oHoteImage);default:return WDChampParametresHote.prototype.SetProp.apply(this,arguments)}};WDGraphe.prototype.Init=function(){function u(){n.m_oVue.Init(n);var t=clWDUtil.bEstDisplay(n.m_oHoteImage.parentNode,document);if(t){$(window).on("trigger.wb.ancrage.ie.debut",function(){n.m_oVue&&n.m_oVue.m_oPicture&&n.m_oVue.m_oPicture.OnRecalculAncrageIE(n)});n._InitBarreAutomatique();n.RafBarre(null)}}var t,i,n,r;if(WDChampParametresHote.prototype.Init.apply(this,arguments),$.acceptData=function(){return!0},$.queue=function(n,t,i){var r,u=t;if(n)return u=(u||"fx")+"queue",r=jQuery._data(n,u),i&&(!r||jQuery.isArray(i)?r=jQuery._data(n,u,jQuery.makeArray(i)):r.push(i)),r||[]},$.fn.queue=function(n,t){var u=2,i=n,r=t;return(typeof i!="string"&&(r=i,i="fx",u--),arguments.length<u)?jQuery.queue(this[0],i):r===undefined?this:this.each(function(){var n=jQuery.queue(this,i,r);jQuery._queueHooks(this,i);i==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,i)})},jQuery.Tween.propHooks.content={get:function(){return 0},set:function(){}},jQuery.Tween.propHooks.opacity={get:function(n){return n.elem.wbOpacity||1},set:function(n){n.elem.style.opacity=n.elem.wbOpacity=n.now}},t={},$.cssHooks.width||($.cssHooks.width={}),t.width=$.cssHooks.width,$.cssHooks.width={get:function(n){return(n instanceof SVGElement)?n.getBoundingClientRect().width:t.width.get?t.width.get.apply(this,arguments):n.offsetWidth},set:$.cssHooks.width.set},$.cssHooks.height||($.cssHooks.height={}),t.height=$.cssHooks.height,$.cssHooks.height={get:function(n){return(n instanceof SVGElement)?n.getBoundingClientRect().height:t.height.get?t.height.get.apply(this,arguments):n.offsetHeight},set:$.cssHooks.height.set},$.cssHooks.opacity||($.cssHooks.opacity={}),t.opacity=$.cssHooks.opacity,$.cssHooks.opacity={get:function(n,t){if(t){var i=n.wbOpacity!==undefined?n.wbOpacity:n.style.opacity;return n.wbOpacity=i===""?"1":i,n.wbOpacity}},set:function(n,t){n.wbOpacity=n.style.opacity=t}},i=jQuery.camelCase,jQuery.camelCase=function(n){return n.indexOf("-")===-1?n:i(n)},$.fn.wbRemoveData=function(n){return $._removeData(this[0],n),this},$.fn.wbData=function(n,t){return t!==undefined?($._data(this[0],n,t),this):$._data(this[0],n)},$.fn.wbDataObj=function(n){var t=this;clWDUtil.bForEachIn(n,function(i){return t.wbData(i,n[i]),!0})},n=this,r=this.m_oHoteImage&&this.m_oHoteImage.parentNode,!r){$(window).one("trigger.wb.grf.1erAffichage",function(){n.Init()});return}if($(".wbAndrageIEChargement1erAffichage").length){$(window).one("trigger.wb.ancrage.ie.1erAffichageApresAncrage",u);return}u()};WDGraphe.prototype._vLiaisonHTML=function(n,t){n="";t="";WDChampParametresHote.prototype._vLiaisonHTML.apply(this,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s
this.m_oHoteImage=this.m_oHote;WDBarre.prototype._vLiaisonHTML.apply(this.m_oBarreAutomatique,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s	
};WDGraphe.prototype._InitBarreAutomatique=function(){this.m_oBarreAutomatique.Init(this)};WDGraphe.prototype._voNewBoutonOnOff=function(n,t){return this.m_oBarreAutomatique._voNewBoutonOnOff(n,t)};WDGraphe.prototype._voNewBoutonAction=function(n,t){return this.m_oBarreAutomatique._voNewBoutonAction(n,t)};WDGraphe.prototype._voNewBoutonMenu=function(n,t){this.m_oBarreAutomatique._voNewBoutonMenu(n,t)};WDGraphe.prototype._voNewBoutonMenuS=function(n,t){return this.m_oBarreAutomatique._voNewBoutonMenu(n,t)};WDGraphe.prototype.RafBarre=function(n,t){this.m_oBarreAutomatique.RafBarre(n,t)};WDGraphe.prototype.RafBarreMMove=function(n){this.m_oBarreAutomatique.RafBarreMMove(n)};WDGraphe.prototype.bActif=function(n){return this.m_tabEtat[n[0]]};WDGraphe.prototype.ExecuteCommande=function(n,t){this.m_tabEtat[t[0]]=this.m_tabEtat[t[0]]?0:1;this.m_oVue.ExecuteCommande(this);this.RafBarre(n,!0)};WDGraphe.prototype.OnOption=function(n,t){this.m_tabEtat[t[0]]=t[1];this.m_oVue.OnOption(this);this.RafBarre(n,!0)};WDGraphe.prototype.bActifOption=function(n,t){return this.m_tabEtat[t[0]]==t[1]};WDGraphe.prototype.OnSave=function(){this.m_oVue.OnSave(this)};WDGraphe.prototype.OnPrint=function(){this.m_oVue.OnPrint(this)};WDGraphe.prototype.sGetRequete=function(n){var t=this.m_sURLBase;return t=t+(t.indexOf("?")==-1?"?":"&"),t+(this.m_oBarreAutomatique.m_oBarre?"WD_ACTION_="+(n?"GRAPHESAUVE":"GRAPHEPARAM")+"&WD_BUTTON_CLICK_="+this.m_sAliasChamp+"&":"")+"WD_PARAM_="+this._vsConstruitParam()+"&"+this.m_sAliasChamp+"="+(new Date).getTime()};WDGraphe.prototype._vsConstruitParam=function(){var n=[],t=WDChamp.prototype._vsConstruitParam.apply(this,arguments);return t.length>0&&n.push(t),n.push(this.m_tabEtat.TYP),n.push(this.m_tabEtat.GDH),n.push(this.m_tabEtat.GDV),n.push(this.m_tabEtat.SMO),n.push(this.m_tabEtat.GRA),n.push(this.m_tabEtat.RAI),n.push(this.m_tabEtat.ANT),n.push(this.m_tabEtat.TRA),n.push(this.m_tabEtat.LEG),n.push(this.m_tabEtat.MIR),n.push(this.m_tabEtat.ANI),n.push(this.m_tabEtat.INT),n.join(",")};WDGraphe.prototype.DeduitParamBarre=function(n){this.m_tabEtat=clWDUtil.isObject(n)?n:clWDUtil.oEvalJSON(n)};WDGraphe.prototype.sGetAltText=function(n){return CHART_TOOLBAR.ALTTEXT[n]};WDGraphe.prototype._vAppliqueParametres=function(){WDChampParametresHote.prototype._vAppliqueParametres.apply(this,arguments);this.relanceInitialisation();this.ConstruitParam()};WDGraphe.prototype.grInfoXY=function(n,t,i,r){var e,c,f,l,u,a,s,o,h;if(t===undefined&&(t=this.m_grInfoX),i===undefined&&(i=this.m_grInfoY),this.m_grInfoX=t,this.m_grInfoX=i,this.m_oVue&&this.m_oVue.m_oPicture&&this.m_oVue.m_oPicture.m_domBaliseSVG){for(c=this.m_oVue.m_oPicture.m_domBaliseSVG[0],f=c.createSVGRect(),f.x=t,f.y=i,f.width=f.height=1,l=c.getIntersectionList(f,null),s=l.length-1;s>-1;--s)(o=$(l[s]),h=r?o.wbData(r):o.wbData("wbGrfGrInfoXY"),h!==undefined&&h[n]!=undefined)&&(u===undefined||o.is(":hover"))&&(u=h,a=o);if(r)return u;u||(u=this.m_oVue.m_oRenderer.drawMire(this.m_oVue.m_oPicture,this.m_oVue.m_oAnimator,this.m_oVue.m_oRenderer.m_domBulle,undefined,t,i));u&&(e=clWDUtil.isFunction(u[n])?u[n].apply(this,[a,f.x,f.y]):u[n])}switch(n){case IWDChartConstant.GR_SERIE:case IWDChartConstant.GR_CATEGORIE:return e!==undefined?e+1:-1;case IWDChartConstant.GR_CHEMIN:return"";case IWDChartConstant.GR_VALEUR_MAX:case IWDChartConstant.GR_VALEUR_DEBUT:case IWDChartConstant.GR_VALEUR_FIN:case IWDChartConstant.GR_VALEUR:default:return e!==undefined?e:0}};WDGraphe.prototype.relanceInitialisation=function(n){var t,r,i,f,u;if(this.m_oVue.m_bInteractif&&(this.m_oModele&&(this.m_oModele=undefined,delete this.m_oModele),this.m_oModele=new WDChartModel(this),n=this.m_oVue.RecreerRenderer(this,n),n!==!1)&&(this.m_oVue.Redessine(this,n),this.m_oVue.m_oPicture&&this.m_oVue.m_oPicture.m_domBaliseSVG))for(this.m_oVue.m_oPicture.m_domBaliseSVG.find("desc").remove(),t=0;t<this.m_oModele.m_tabSeries.length;++t){for(r=this.m_oModele.m_tabSeries[t].m_sLibelle,i=0;i<this.m_oModele.m_tabSeries[t].m_tabValeur.length;++i)(f=this.m_oModele.getCategoryLabelAt(i),u=this.m_oModele.m_tabSeries[t].getValueAtWithNull(i),u!==IWDChartConstant.NULL_VALUE)&&(r+="\t"+f+"="+u);this.m_oVue.m_oPicture.tag(this.m_oVue.m_oPicture.m_domBaliseSVG,"desc-"+t,"desc").html(r)}};WDChartSeries.prototype=new JSONPOO;WDChartSeries.prototype.constructor=WDChartSeries;WDChartSeries.prototype.isOnSecondaryAxis=function(){return this.m_bAxeSecondaire&&!(this.m_oGraphe.m_oParametres.m_eType==WDChartParameters.kHistoEmpile||this.m_oGraphe.m_oParametres.m_eType==WDChartParameters.kHistoEmpileHorizontal)};WDChartSeries.prototype.getMinValue=function(){return this.getNbValues()>0?this.m_dMinValue:0};WDChartSeries.prototype.getMaxValue=function(){return this.getNbValues()>0?this.m_dMaxValue:0};WDChartSeries.prototype.getNbValues=function(){return this.m_tabValeur?this.m_tabValeur.length+Math.max(this.m_nOffset-1,0):0};WDChartSeries.prototype.getValueAt=function(n){var t=this.getValueAtWithNull(n);return t==IWDChartConstant.NULL_VALUE&&(t=0),t};WDChartSeries.prototype.getValueAtWithNull=function(n){return this.m_tabValeur.length==0?IWDChartConstant.NULL_VALUE:n<this.m_nOffset-1?0:this.m_tabValeur[n-(this.m_nOffset-1)]};WDChartSeries.prototype.isContainDecimalValues=function(){return this.m_bContainDecimalValues};WDChartSeries.prototype.onValueAddedOrChanged=function(n){n<this.m_dMinValue&&(this.m_dMinValue=n);n>this.m_dMaxValue&&(this.m_dMaxValue=n);this.m_bContainDecimalValues||(this.m_bContainDecimalValues=n-parseInt10(n)>0)};WDChartAnimator.prototype.constructor=WDChartAnimator;WDChartAnimator.prototype.sGetFonctionEase=function(){return["linear","swing","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInExpo","easeOutExpo","easeInOutExpo","easeInSine","easeOutSine","easeInOutSine","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce"][parseInt10(Math.random()*32)]};WDChartAnimator.prototype.add=function(n,t,i){if(i!==!0&&this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){var r=this.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG.wbData("wbGrfModeAffichage")===WDChartView.ms_nDessin1erAffichage;if(r)return}t&&(this.m_bDessinComplet=!0);this.m_tabAnimations.push(n);n.m_oAnimator=this;i!==!0&&n.run()};WDChartAnimator.prototype.call=function(n,t){var r,i=n[n.length===1?0:1],u;if(n[0]&&clWDUtil.isObject(n[0])&&n[0].queue&&n[0].queue("fx").length>0)return i;for(r=0;r<this.m_tabAnimations.length;++r)if(u=this.m_tabAnimations[r],u[t]!==undefined&&(i=u[t].apply(u,n),i!==undefined&&(n[n.length===1?0:1]=i,typeof i=="boolean"&&i)))return i;return i};WDChartAnimator.prototype.TermAnimator=function(){};WDChartAnimator.prototype.play1erAffichage=function(n,t){t.Raz();n.m_oVue.onDraw(n,WDChartView.ms_nDessinParDefaut)};WDChartAnimator.prototype.playMajDonnees=function(n,t){this.play1erAffichage(n,t)};WDChartAnimator.prototype.playModifTypeGraphe=function(n,t){this.play1erAffichage(n,t)};WDChartAnimator.prototype.retireAnimation=function(n){var t=this.m_tabAnimations.indexOf(n);t>-1&&this.m_tabAnimations.splice(t,1)};WDChartAnimator.prototype.tweenLegendPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLegendPaint")};WDChartAnimator.prototype.tweenGroupeLegende=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenGroupeLegende")};WDChartAnimator.prototype.tweenGroupeTitre=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenGroupeTitre")};WDChartAnimator.prototype.tweenValue=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenValue")};WDChartAnimator.prototype.tweenHideLabel=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenHideLabel")};WDChartAnimator.prototype.bAnimationEnCours=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"bAnimationEnCours")};WDChartAnimator.prototype.bAnimationPasCommencee=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"bAnimationPasCommencee")};WDChartAnimator.prototype.bAnimationPasFinie=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"bAnimationPasFinie")};WDChartAnimator.prototype.bDessinComplet=function(){return this.m_bDessinComplet};WDChartAnimator.prototype.NotifDessinComplet=function(){this.m_bDessinComplet=!1};WDChartAnimation.prototype.constructor=WDChartAnimation;WDChartAnimation.prototype.run=function(){var n=this.prepare(this.m_domBaliseAnim.wbData("wbGrfAnim",this));n.animate(this.oStyleCssAnimation,this);clWDUtil.bEstChaineNonVide(this.queue)&&n.dequeue(this.queue)};WDChartAnimation.getAnim=function(n){return clWDUtil.isObject(n)&&n.m_oAnimator!==undefined?n:$(n).wbData("wbGrfAnim")};WDChartAnimation.prototype.prepare=function(n){return n};WDChartAnimation.prototype.tween=function(n,t,i){i===undefined&&(i=this.m_dNow);var r=t*i+(1-i)*n;return Math.abs(r)<.1?Math.round(r*1e10)/1e10:r};WDChartAnimation.prototype.tweenX=function(n,t,i){return this.tween(n,t,i)};WDChartAnimation.prototype.tweenY=function(n,t,i){return this.tween(n,t,i)};WDChartAnimation.prototype.tweenRect=function(n,t,i){return i===undefined&&(i=this.m_dNow),new WDRect(this.tweenX(n.m_nLeft,t.m_nLeft,i),this.tweenY(n.m_nTop,t.m_nTop,i),this.tweenX(n.m_nRight,t.m_nRight,i),this.tweenY(n.m_nBottom,t.m_nBottom,i))};WDChartAnimation.prototype.start=function(){var n=WDChartAnimation.getAnim(this);n.m_domEtatInitial=n.m_oPicture.m_domBaliseSVG.clone(!0,!0).off();n.m_domEtatInitial.find("*").off();n.m_domEtatInitial[0].wbGrfClone=!0};WDChartAnimation.prototype.step=function(n){var t=WDChartAnimation.getAnim(this);t&&(t.m_dNow=n,t.m_oGraphe.m_oVue.Redessine(t.m_oGraphe,WDChartView.ms_nDessinAnimation))};WDChartAnimation.prototype.progress=function(n,t,i){var r=WDChartAnimation.getAnim(this);r&&(r.m_dProgress=t,r.m_dRemainingMS=i)};WDChartAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_domEtatInitial&&(n.m_domEtatInitial[0].wbGrfClone===!0&&n.m_domEtatInitial.empty().removeData().unbind(),n.m_domEtatInitial=null),n.m_oAnimator&&n.m_oAnimator.retireAnimation(n),n.m_domBaliseAnim&&n.m_domBaliseAnim.wbRemoveData("wbGrfAnim"))};WDChartAnimation.prototype.always=function(){var n=WDChartAnimation.getAnim(this);n&&n.done.apply(this,arguments)};WDChartAnimation.prototype.tweenHideLabel=function(n,t){return this.m_bToujoursAvecLibelles?t:this.m_dNow<=1/3?this.m_oModelePrecedent===undefined?!t:t:this.m_dNow<=2/3?!0:(this.m_dNow<1,t)};WDChartAnimation.prototype.tweenLabelPaint=function(n,t){var i=1;return this.m_dNow<=1/3?i=Math.sin(Math.PI/2*(1/3-this.m_dNow)*3):this.m_dNow<=2/3?i=0:this.m_dNow<1&&(i=Math.sin(Math.PI/2*((this.m_dNow-2/3)*3/2))),t.m_oStyle.opacity=i,t};WDChartAnimation.prototype.bAnimationEnCours=function(){var n=WDChartAnimation.getAnim(this);return n?!(n.m_dNow==0||n.m_dNow==1):!1};WDChartAnimation.prototype.bAnimationPasFinie=function(){var n=WDChartAnimation.getAnim(this);return n?n.m_domBaliseAnim.wbData("wbGrfAnim")?!(n.m_dNow==1):!1:!1};WDChartAnimation.prototype.bAnimationPasCommencee=function(){var n=WDChartAnimation.getAnim(this);return n?!(n.m_dNow==0):!1};WDChartAnimationValeur.prototype=new WDChartAnimation;WDChartAnimationValeur.prototype.constructor=WDChartAnimationValeur;WDChartAnimationValeur.prototype.tweenValue=function(n,t,i,r){var u,f=0,e,o;return this.m_oGraphe&&(e=this.m_oGraphe.m_oModele.getAxisByType(EAxisType.Y),f=e?e.m_dOriginValue:0),this.m_oModelePrecedent&&(this.m_oModelePrecedent.m_tabSeries.length<=r?u=f:(o=this.m_oModelePrecedent.m_tabSeries[r].length,i>=o&&(u=this.m_oModelePrecedent.m_tabSeries[r].m_tabValeur[o-1]))),u===undefined&&(u=this.m_oModelePrecedent?this.m_oModelePrecedent.m_tabSeries[r].m_tabValeur[i]||f:f),this.tween(u,t)};WDChartAnimationValeur.prototype.tweenRedessineAxes=function(){return this.m_dNow===0?!0:!1};WDChartXYAnimationValeur.prototype=new WDChartAnimationValeur;WDChartXYAnimationValeur.prototype.constructor=WDChartXYAnimationValeur;WDChartXYAnimationValeur.prototype._RelativiseSelonModelePrecedent=function(){var t=this.m_oGraphe.m_oVue.m_oRenderer,s=this.m_oModelePrecedent,u=this.m_oGraphe.m_oModele,f=s.m_tabSeries.length,i,n,r,l;for(t.m_nPasSerie>1&&(f=f-f%t.m_nPasSerie),i=f-1;i>=0;--i){var h=s.m_tabSeries[i],e=s.m_tabSeries[i].m_oAxis,o=u.getSeriesAt(i,!1);if(o){if(n=u.getAxisByType(o.isOnSecondaryAxis()?EAxisType.Y2:EAxisType.Y),t.m_nPasSerie>1&&!t.m_params.isBoursierChart()){switch(i%t.m_nPasSerie==0){case 0:n=u.getAxisByType(o.isOnSecondaryAxis()?EAxisType.X2:EAxisType.X);break;case 2:n=undefined}if(n===undefined)continue}var c=[],a=o.getNbValues(),v=t.getDrawnValuesCount(a,u.getAxisByType(EAxisType.X));for(r=0;r<v;++r){if(r>=a)break;l=h.m_tabValeur[r];e.m_dOriginValue&&n.m_dOriginValue&&t.m_params.isBoursierChart()?c.push(l*n.m_dOriginValue/e.m_dOriginValue):c.push(l*(n.m_dMaxValue-n.m_dMinValue)/(e.m_dMaxValue-e.m_dMinValue))}h.m_tabValeur=c;h.m_nOffset=1}}};WDChartXYAnimationValeur.prototype.tweenValue=function(n,t,i,r){return this.m_oModelePrecedent&&!this.m_bDejaRelativise&&(this._RelativiseSelonModelePrecedent(),this.m_bDejaRelativise=!0),n[0].opacity==undefined&&(n[0].opacity=n.css("opacity")),this.m_dNow==0&&n.css("display",""),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&n[0].opacity>0?(n.css("opacity",1-this.m_dNow),n[0].opacity=1-this.m_dNow,this.m_dNow==1&&n.css("display","none")):!this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&n[0].opacity<1&&(n.css("opacity",this.m_dNow),n[0].opacity=this.m_dNow),WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments)};WDXYChartAnimator.prototype=new WDChartAnimator;WDXYChartAnimator.prototype.constructor=WDPieChartAnimator;WDXYChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);i.m_oModelePrecedent=undefined;this.add(i)};WDXYChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartXYAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);this.add(i,!0)};WDXYChartAnimator.prototype.playModifTypeGraphe=function(n,t){this.playMajDonnees(n,t)};WDXYChartAnimator.prototype.tweenRedessineAxes=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRedessineAxes")};WDXYChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDPieChartAnimator.prototype=new WDChartAnimator;WDPieChartAnimator.prototype.constructor=WDPieChartAnimator;WDPieChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDPieChartAnimation1erAffichageWindevLike(n,t);this.add(i,!0)};WDPieChartAnimator.prototype.playModifTypeGraphe=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.playModifTypeGraphe.apply(this,arguments);return}this.add(new WDPieChartAnimation1erAffichageAngleFinCroissant(n,t))};WDPieChartAnimator.prototype.playSurbrillancePart=function(n,t,i,r,u){r!==undefined&&this.add(new WDPieChartAnimationSurbrillancePartNoDraw(n,t,i,r,u))};WDPieChartAnimator.prototype.playSelectionPart=function(n,t,i,r){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation!==0&&this.m_oGraphe.m_oModele.m_oParametres.getType()!=WDChartParameters.kHemicycle){var u=new WDPieChartAnimationSelectionPart(n,t,i,r);u.m_dAngleFinal!=u.m_dAngleInitial&&(u.m_bToujoursAvecLibelles=this.m_oGraphe.m_oModele.m_oParametres.m_bEtiquetteSecteurExterieures,this.add(u))}};WDPieChartAnimator.prototype.playSelectionLegende=function(n,t,i,r){if(!i.wbData("wbGrfDrawPath")||!(i.wbData("wbGrfDrawPath").options.sweep>=359)){var u=this.m_oGraphe.m_oVue.bEstSerieMasquee(WDPieChartRenderer.nGetIndicePart(t,i));r.fadeTo(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0?0:400,u?1:.5).find("text").css("text-decoration",u?"":"line-through");this.add(new WDPieChartAnimationSelectionLegende(n,t,i,r))}};WDPieChartAnimator.prototype.tweenInitialStartAngle=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenInitialStartAngle")};WDPieChartAnimator.prototype.tweenInitialEndAngle=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenInitialEndAngle")};WDPieChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDPieChartAnimator.prototype.tweenHoleRadius=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenHoleRadius")};WDPieChartAnimator.prototype.tweenPart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPart")};WDPieChartAnimator.prototype.tweenPartPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPartPaint")};WDPieChartAnimator.prototype.tweenLabelPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLabelPaint")};WDPieChartZoomAnimation.prototype=new WDChartAnimation;WDPieChartZoomAnimation.prototype.constructor=WDPieChartZoomAnimation;WDPieChartZoomAnimation.prototype.tweenRectChart=function(n,t){this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect")===undefined&&this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",t);var i=this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect"),r=(i.getWidth()-this.m_dZoom*i.getWidth())/2,u=(i.getHeight()-this.m_dZoom*i.getHeight())/2;return this.tweenRect(i,new WDRect(i.m_nLeft-r,i.m_nTop-u,i.m_nRight+r,i.m_nBottom+u))};WDPieChartZoomAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&n.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart)};WDChartAnimationNoDraw.prototype=new WDChartAnimation;WDChartAnimationNoDraw.prototype.constructor=WDChartAnimationNoDraw;WDChartAnimationNoDraw.prototype.run=function(){};WDChartAnimationNoDraw.prototype.start=function(){var n=WDChartAnimation.getAnim(this);n.m_dNow=0;n.m_domEtatInitial=n.m_oPicture.m_domBaliseSVG};WDChartAnimationNoDraw.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_dNow=1,WDChartAnimation.prototype.done.apply(this,arguments))};WDChartAnimationNoDraw.prototype.step=function(n){var t=WDChartAnimation.getAnim(this);if(t)return t.m_dNow=n,t};WDPieChartAnimationSurbrillancePartNoDraw.prototype=new WDChartAnimationNoDraw;WDPieChartAnimationSurbrillancePartNoDraw.prototype.constructor=WDPieChartAnimationSurbrillancePartNoDraw;WDPieChartAnimationSurbrillancePartNoDraw.prototype.run=function(){this.m_domPartEnSurbrillance.clearQueue().finish().animate({opacity:this.m_bEtat?.8:1},this.m_bEtat?this.duration:1,this.easing);this.m_oAnimator.retireAnimation(this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim"));this.m_domPartEnSurbrillance.parent().wbData("wbGrfAnim",this).clearQueue().finish().animate({content:1},this)};WDPieChartAnimationSurbrillancePartNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments),t;n&&(t=n.tween(n.m_nEcartInitial,n.m_bEtat?n.m_nEcart:0,n.m_dNow),WDPieChartRenderer.prototype.m_bDessinneSelonBissectire&&$(this).wbData("wbGrfAnimSurbrillanceEcart",t).attr("transform","translate("+t+", 0)"))};WDPieChartAnimationSelectionLegende.prototype=new WDChartAnimation;WDPieChartAnimationSelectionLegende.prototype.constructor=WDPieChartAnimationSelectionLegende;WDPieChartAnimationSelectionLegende.prototype.tweenValue=function(n,t,i){return this.m_nIndiceValeurDansSerie==i?(this.m_bAffiche?this.m_dNow:1-this.m_dNow)*t:t};WDPieChartAnimationSelectionLegende.prototype.done=function(){};WDPieChartAnimationSelectionLegende.prototype.run=function(){for(var n,t=this.m_oAnimator.m_tabAnimations.length-1;t>-1;--t)(n=this.m_oAnimator.m_tabAnimations[t],n!==this)&&n.constructor==this.constructor&&n.m_nIndiceValeurDansSerie===this.m_nIndiceValeurDansSerie&&WDChartAnimation.prototype.done.apply(n,arguments);WDChartAnimation.prototype.run.apply(this,arguments)};WDPieChartAnimationSelectionLegende.prototype.tweenLabelPaint=function(n,t){return this.m_nIndiceValeurDansSerie==n&&(t.m_oStyle.opacity=this.m_bAffiche?this.m_dNow:1-this.m_dNow),t};WDPieChartAnimationSelectionLegende.prototype.tweenPartPaint=function(n,t){return this.m_nIndiceValeurDansSerie==WDPieChartRenderer.nGetIndicePart(this.m_oPicture,n)&&(t.m_oStyle.opacity=this.m_bAffiche?this.m_dNow:1-this.m_dNow),t};WDPieChartAnimationSelectionLegende.prototype.tweenLegendPaint=function(n,t){return t};WDPieChartAnimationSelectionLegende.prototype.tweenHideLabel=function(n,t,i){if(this.m_dNow<=1/3){var r=this.m_oGraphe.m_oVue.bEstSerieMasquee(i);if(r)return!1}return WDChartAnimation.prototype.tweenHideLabel.apply(this,arguments)};WDPieChartAnimationSurbrillancePart.prototype=new WDChartAnimation;WDPieChartAnimationSurbrillancePart.prototype.constructor=WDPieChartAnimationSurbrillancePart;WDPieChartAnimationSurbrillancePart.prototype.tweenPartPaint=function(n,t){return this.m_oPicture.getId(this.m_domPartEnSurbrillance)===this.m_oPicture.getId(n)&&(t.m_oStyle.opacity=this.tween(this.m_bEtat?1:.8,this.m_bEtat?.8:1)),t};WDPieChartAnimation1erAffichageBase.prototype=new WDChartAnimation;WDPieChartAnimation1erAffichageBase.prototype.constructor=WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageBase.prototype.tweenLabelPaint=function(n,t){return t.m_oStyle.opacity=(t.m_oStyle.opacity===undefined?1:t.m_oStyle.opacity)*Math.max(0,Math.exp(this.m_dNow)*Math.log(this.m_dNow)+1),t};WDPieChartAnimation1erAffichageArretDuVinyle.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageArretDuVinyle.prototype.constructor=WDPieChartAnimation1erAffichageArretDuVinyle;WDPieChartAnimation1erAffichageArretDuVinyle.prototype.tweenInitialStartAngle=function(n,t){return this.m_dNow*t*this.m_dPourcentRotation+t*(1-this.m_dPourcentRotation)};WDPieChartAnimationSelectionPart.prototype=new WDChartAnimation;WDPieChartAnimationSelectionPart.prototype.constructor=WDPieChartAnimationSelectionPart;WDPieChartAnimationSelectionPart.prototype.tweenInitialStartAngle=function(){return this.tween(this.m_dAngleInitial,this.m_dAngleFinal)};WDPieChartAnimationSelectionPart.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_oGraphe.m_oVue.m_oRenderer.m_params.m_dAngle=Number(n.m_dAngleFinal-270).toRad(),WDChartAnimation.prototype.done.apply(this,arguments))};WDPieChartAnimation1erAffichageWindevLike.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageWindevLike.prototype.constructor=WDPieChartAnimation1erAffichageWindevLike;WDPieChartAnimation1erAffichageWindevLike.prototype.tweenInitialStartAngle=function(n,t){return this.m_dNow*t*this.m_dPourcentRotation+t*(1-this.m_dPourcentRotation)};WDPieChartAnimation1erAffichageWindevLike.prototype.tweenPart=function(n,t){return t.options.sweep*=this.m_dNow,t};WDPieChartAnimation1erAffichageWindevLike.prototype.tweenRectChart=function(n,t){this.m_dNow==0&&n.wbData("wbGrfWDPieChartAnimation1erAffichageWindevLikeRect",t);var i=n.wbData("wbGrfWDPieChartAnimation1erAffichageWindevLikeRect"),r=i.m_nTop+i.getHeight()/2,u=i.m_nLeft+i.getWidth()/2;return this.tweenRect(new WDRect(u,r,u,r),i)};WDPieChartAnimation1erAffichageClipPath.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageClipPath.prototype.constructor=WDPieChartAnimation1erAffichageClipPath;WDPieChartAnimation1erAffichageClipPath.prototype.tweenPart=function(n,t){var i=360*this.m_dNow,r;return t.options.startAngle-t.options.firstAngle>=i?t.options.sweep=0:(r=t.options.startAngle-t.options.firstAngle+t.options.sweep,i<r&&(t.options.sweep=i-(t.options.startAngle-t.options.firstAngle))),t};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype=new WDPieChartAnimation1erAffichageBase;WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.constructor=WDPieChartAnimation1erAffichageAngleFinCroissant;WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenInitialEndAngle=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenInitialEndAngle");return i||(i=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenInitialStartAngle=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenInitialStartAngle");return i||(i=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenHoleRadius=function(n,t){var r=this.m_oPicture.find(this.m_domEtatInitial,n),i=r.wbData("wbGrfAnimTweenHoleRadius");return i||(i=0),t||(t=0),this.tween(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.tweenRectChart=function(n,t){this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect")===undefined&&this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",t);var i=this.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect");return this.tweenRect(i,t)};WDPieChartAnimation1erAffichageAngleFinCroissant.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&(n.m_oPicture.m_domBaliseSVG.wbData("wbGrfChartRect",n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart),WDChartAnimation.prototype.done.apply(this,arguments))};WDChartListener.prototype.constructor=WDChartListener;WDChartListener.getListener=function(n,t){var i=n.nodeType?n.wbGrfBind:n[0].wbGrfBind;return!t&&i&&i.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?undefined:i};WDChartListener.bind=function(n,t,i,r,u,f,e){var o,s,h;if(t.m_oParametres.m_eEtat)switch(t.m_oParametres.m_eEtat){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:return undefined}if(o=WDChartListener.getListener(i,!0),o&&bCompareFonctions(o.constructor,n.prototype.constructor))return o;o=new n.prototype.constructor(t,i,r,u,f,e);for(s in o)h="on"+s,s!="constructor"&&(bIEAvec11||i[0][h]!==undefined)&&i.bind(s,o[s]);return o.setListener(i),o};WDChartListener.prototype.setListener=function(n){return n[0].wbGrfBind=this};WDChartMireListener.prototype=new WDChartListener;WDChartMireListener.prototype.constructor=WDChartMireListener;WDChartMireListener.prototype.click=WDChartMireListener.prototype.mouseenter=WDChartMireListener.prototype.mousemove=function(n){var t=WDChartListener.getListener(this);t&&(t.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap||this.tagName.toLowerCase()=="rect")&&t.UpdateMire(n)};WDChartMireListener.prototype.mouseleave=function(n){var t=WDChartListener.getListener(this);t&&(t.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap||this.tagName.toLowerCase()=="svg")&&t.UpdateMire(n)};WDChartMireListener.prototype.UpdateMire=function(n){this.m_oGraphe.m_oVue.m_oRenderer.drawMire(this.m_oGraphe.m_oVue.m_oPicture,this.m_oGraphe.m_oVue.m_oAnimator,$(this.m_oGraphe.m_oVue.m_oPicture.m_domBaliseSVG[0].getElementById(this.m_oGraphe.m_oVue.m_oPicture.getId(this.m_domBulle))),n)};WDXYChartLegendListener.prototype=new WDChartListener;WDXYChartLegendListener.prototype.constructor=WDXYChartLegendListener;WDXYChartLegendListener.prototype.click=function(){var n=WDChartListener.getListener(this);n&&n.SelectionneLegende()};WDXYChartLegendListener.prototype.mouseenter=function(n){var t=WDChartListener.getListener(this);t&&(t.event=n,$(this).css("cursor","pointer"),t.SurvolLegende(!0))};WDXYChartLegendListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor",""),n.SurvolLegende(!1))};WDXYChartLegendListener.prototype.SurvolLegende=function(n){var t=this.m_domGroupeSerie.find("path"),i;t.length===0?(t=this.m_domGroupeSerie.find("rect"),i=this.m_oGraphe,i.m_oVue.m_oRenderer.surbrillanceSerieDepuisMire(i.m_oVue.m_oPicture,this.m_nIndexSerie,n,this.m_nIndexSerie)):t.css("strokeWidth",parseInt10(t.attr("stroke-width")||1)+(n?1:0))};WDXYChartLegendListener.prototype.SelectionneLegende=function(){var r,u,f,t,n,i;for(this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie),r=[undefined,undefined],n=0;n<this.m_oGraphe.m_oModele.m_tabSeries.length-this.m_oGraphe.m_oModele.m_tabSeries.length%this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie;n+=this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie)u=this.m_oGraphe.m_oModele.m_tabSeries[n].isOnSecondaryAxis()?1:0,r[u]===undefined&&(r[u]=!1),!this.m_oGraphe.m_oVue.bEstSerieMasquee(n)&&this.m_oGraphe.m_oModele.m_tabSeries[n].m_tabValeur.length&&(r[u]=!0);if(r[0]===!1||r[1]===!1){this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie);return}for(f=1;f<this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie;++f)this.m_oGraphe.m_oVue.toggleSerieMasquee(this.m_nIndexSerie+f);if(t=this.m_oGraphe.m_oVue,this.m_oGraphe.m_oVue.m_oRenderer.m_params.m_nDureeAnimation!=0)for(t.updateModeleReference(this.m_oGraphe),n=0;n<this.m_oGraphe.m_oModele.m_tabSeries.length;++n)i=this.m_oGraphe.m_oModele.m_tabSeries[n],this.m_oGraphe.m_oVue.bEstSerieMasquee(n)?this.m_oGraphe.m_oModele.m_tabSeries[n]=new WDChartSeries(this.m_oGraphe,i,Array.apply(null,new Array(i.m_tabValeur.length+(i.m_nOffset-1))).map(Number.prototype.valueOf,t.m_oRenderer.m_params.getType()==WDChartParameters.kHistoEmpile||t.m_oRenderer.m_params.getType()==WDChartParameters.kHisto||t.m_oRenderer.m_params.getType()==WDChartParameters.kHistoEmpileHorizontal||t.m_oRenderer.m_params.getType()==WDChartParameters.kHistoHorizontal||t.m_oRenderer.m_params.getType()==WDChartParameters.kWaterfall||t.m_oRenderer.m_params.getType()==WDChartParameters.kRadar||t.m_oRenderer.m_params.getType()==WDChartParameters.kMinMax||t.m_oRenderer.m_params.getType()==WDChartParameters.kBarCharts||t.m_oRenderer.m_params.getType()==WDChartParameters.kChandelier?0:i.m_dMinValue+(i.m_dMaxValue-i.m_dMinValue)/2)):n>=this.m_nIndexSerie&&n<this.m_nIndexSerie+this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie&&(this.m_oGraphe.m_oModele.m_tabSeries[n]=new WDChartSeries(this.m_oGraphe,i,t.m_oModeleInitialSeries.m_tabSeries[n].m_tabValeur)),this.m_oGraphe.m_oModele.m_tabSeries[n].m_nOffset=1;this.m_oGraphe.m_oModele.createAxis();this.m_oGraphe.m_oVue.onDraw(this.m_oGraphe,WDChartView.ms_nDessinNouvellesDonnees)};WDPieChartSelectionnePartListenerBase.prototype=new WDChartListener;WDPieChartSelectionnePartListenerBase.prototype.constructor=WDPieChartSelectionnePartListenerBase;WDPieChartSelectionnePartListenerBase.prototype.SelectionnePart=function(n,t){this.m_oVue.m_oAnimator.playSelectionPart(this.m_oGraphe,this.m_oVue.m_oPicture,n,t)};WDPieChartSelectionnePartListenerBase.prototype.SurbrillancePart=function(n,t,i){this.m_oVue.m_oAnimator.playSurbrillancePart(this.m_oGraphe,this.m_oVue.m_oPicture,n,t,i)};WDPieChartSelectionnePartListenerBase.prototype.SurbrillanceLegende=function(n,t,i){var r=t.find("text"),u,f;r.css("font-weight")===undefined&&r.css("font-weight",0);u=new WDSvgAnimation(this.m_oGraphe,this.m_oGraphe.m_oVue.m_oPicture,r,{"font-weight":r.css("font-weight")},{"font-weight":n?900:0});u.duration=1;u.run();f=this.m_oVue.bEstSerieMasquee(WDPieChartRenderer.nGetIndicePart(this.m_oVue.m_oPicture,i));f||this.m_oVue.m_oAnimator.playSurbrillancePart(this.m_oGraphe,this.m_oVue.m_oPicture,n,i,t)};WDPieChartSelectionnePartListenerBase.prototype.SelectionneLegende=function(n,t){this.m_oVue.m_oAnimator.playSelectionLegende(this.m_oGraphe,this.m_oVue.m_oPicture,t,n)};WDPieChartSelectionnePartListenerBase.prototype.domGetLegendeAssociee=function(n,t){return t?t:undefined};WDPieChartSelectionnePartListenerBase.prototype.domGetPartAssociee=function(n,t){return t?t:undefined};WDPieChartAnimationTourneNoDraw.prototype=new WDChartAnimationNoDraw;WDPieChartAnimationTourneNoDraw.prototype.constructor=WDPieChartAnimationTourneNoDraw;WDPieChartAnimationTourneNoDraw.prototype.run=function(){this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinAnimation)};WDPieChartAnimationTourneNoDraw.prototype.tweenInitialStartAngle=function(n,t){return t+this.m_nAngle};WDPieChartPartListener.prototype=new WDPieChartSelectionnePartListenerBase;WDPieChartPartListener.prototype.constructor=WDPieChartPartListener;WDPieChartPartListener.prototype.click=function(){var n=WDChartListener.getListener(this);n&&n.SelectionnePart(n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartPartListener.prototype.mouseenter=function(){var n=WDChartListener.getListener(this);n&&n.SurbrillancePart(!0,n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartPartListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&n.SurbrillancePart(!1,n.m_domBalise,n.m_domLegende=n.domGetLegendeAssociee(n.m_domBalise,n.m_domLegende))};WDPieChartLegendListener.prototype=new WDPieChartSelectionnePartListenerBase;WDPieChartLegendListener.prototype.constructor=WDPieChartLegendListener;WDPieChartLegendListener.prototype.click=function(){var n=WDChartListener.getListener(this);n&&n.m_domPart&&n.SelectionneLegende(n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart))};WDPieChartLegendListener.prototype.mouseenter=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor","pointer"),n.m_domPart&&n.SurbrillanceLegende(!0,n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart)))};WDPieChartLegendListener.prototype.mouseleave=function(){var n=WDChartListener.getListener(this);n&&($(this).css("cursor",""),n.m_domPart&&n.SurbrillanceLegende(!1,n.m_domBalise,n.m_domPart=n.domGetPartAssociee(n.m_domBalise,n.m_domPart)))};WDChartParameters.__sCreeClasseDepuisPolice=function(n,t,i){var u="wbGrf"+n.m_sAliasChamp+"-police-"+i,r;return $("style."+u).remove(),r="",t.m_bBarre||t.m_bSouligne?(t.m_bBarre&&(r+=" line-through"),t.m_bSouligne&&(r+=" underline")):r="none",$("head").append($('<style class="'+u+'">.'+u+" { font-family:"+t.m_sNom+";font-weight:"+t.m_nGras+";font-style:"+(t.m_bItalique?"italic":"normal")+";text-decoration:"+r+";font-size:"+t.m_sTaille+";color:"+t.m_sCouleur+";}<\/style>")),u};WDChartParameters.prototype=new JSONPOO;WDChartParameters.prototype.constructor=WDChartParameters;WDChartParameters.prototype.isDisplayValuesLabel=function(){return!!this.m_bAfficheValeur&&this.m_eType!==WDChartParameters.kNuage};WDChartParameters.prototype.isDisplayCategoriesLabel=function(){return!!this.m_bAfficheLibelle};WDChartParameters.prototype.isDisplayPercentage=function(){return!!this.m_bAffichePourcentage};WDChartParameters.prototype.isBorderColorAuto=function(){return!!this.m_bCouleurBordureAuto};WDChartParameters.prototype.getGradientType=function(){return this.m_bDegrade?this.m_bDegradeHorizontal?this.m_bAxeXHorizontal?IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:IWDChartConstant.FLAG_VERTICAL_GRADIENT:this.m_bAxeXHorizontal?IWDChartConstant.FLAG_VERTICAL_GRADIENT:IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:IWDChartConstant.FLAG_NO_GRADIENT};WDChartParameters.prototype.getDonutHoleSize=function(){return this.m_nPourcentageTrou||0};WDChartParameters.prototype.getType=function(){return this.m_eType};WDChartParameters.prototype.getTitlePosition=function(){if(this.m_ePosTitre==WDChartParameters.kSans)return IWDChartConstant.FLAG_TITLE_POSITION_NONE;if(this.m_oPositionnementManuel!=undefined)return IWDChartConstant.FLAG_TITLE_POSITION_MANUAL;switch(this.m_ePosTitre){case WDChartParameters.kDroite:case WDChartParameters.kGauche:case WDChartParameters.kSans:return IWDChartConstant.FLAG_TITLE_POSITION_NONE;case WDChartParameters.kHaut:return IWDChartConstant.FLAG_TITLE_POSITION_TOP;case WDChartParameters.kBas:return IWDChartConstant.FLAG_TITLE_POSITION_BOTTOM}};WDChartParameters.prototype.getLegendPosition=function(){if(this.m_ePosLegende==WDChartParameters.kSans)return IWDChartConstant.FLAG_LEGEND_POSITION_NONE;if(this.m_oPositionnementManuel!=undefined)return IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL;switch(this.m_ePosLegende){case WDChartParameters.kDroite:return IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT;case WDChartParameters.kGauche:return IWDChartConstant.FLAG_LEGEND_POSITION_LEFT;case WDChartParameters.kSans:return IWDChartConstant.FLAG_LEGEND_POSITION_NONE;case WDChartParameters.kHaut:return IWDChartConstant.FLAG_LEGEND_POSITION_TOP;case WDChartParameters.kBas:return IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM}};WDChartParameters.prototype.isLegendLabelInRow=function(){return this.m_ePosLegende==WDChartParameters.kHaut};WDChartParameters.prototype.isLegendAdaptSizeToContent=function(){return this.getLegendPosition()!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL?!1:this.m_oPositionnementManuel.m_oLegende.m_nBottom==undefined?!0:!1};WDChartParameters.prototype.byGetAlpha=function(){if(this.m_bInterditAlpha)return 255;var n=this.m_byAlpha;return n===undefined?255:n};WDChartParameters.prototype.indiceWLangageToFmk=function(n){return n>=1?n-1:n};WDChartParameters.prototype.getXAxisMin=function(){return this.m_oAxeX.m_bOrigineMin?this.indiceWLangageToFmk(this.m_oAxeX.m_dOrigineMin):IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getXAxisMax=function(){return this.m_oAxeX.m_bOrigineMax?this.indiceWLangageToFmk(this.m_oAxeX.m_dOrigineMax):IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getYAxisMin=function(){return this.m_oAxeY.m_bOrigineMin?this.m_oAxeY.m_dOrigineMin:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getYAxisMax=function(){return this.m_oAxeY.m_bOrigineMax?this.m_oAxeY.m_dOrigineMax:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getY2AxisMin=function(){return this.m_oAxeYSecondaire.m_bOrigineMin?this.m_oAxeYSecondaire.m_dOrigineMin:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getY2AxisMax=function(){return this.m_oAxeYSecondaire.m_bOrigineMax?this.m_oAxeYSecondaire.m_dOrigineMax:IWDChartConstant.DEFAULT_VALUE};WDChartParameters.prototype.getAxisTitle=function(n){switch(n.m_type){default:case EAxisType.X:return this.m_sTitreAxeX;case EAxisType.X2:return"";case EAxisType.Y:return this.m_sTitreAxeY;case EAxisType.Y2:return this.m_sTitreAxeY2;case EAxisType.Z:return""}};WDChartParameters.prototype.getAxisLabelOrientation=function(n){var t;switch(n.m_type){default:case EAxisType.Z:t=WDChartParameters.eOrientationDefaut;break;case EAxisType.X:case EAxisType.X2:t=this.m_oAxeX.m_eOrientationGraduations;break;case EAxisType.Y:case EAxisType.Y2:t=this.m_oAxeY.m_eOrientationGraduations}return(t<WDChartParameters.eOrientationDefaut||t>WDChartParameters.eOrientationVerticale)&&(t=WDChartParameters.eOrientationDefaut),t};WDChartParameters.prototype.getAxisStep=function(n){var t;switch(n.m_type){case EAxisType.X:case EAxisType.X2:t=this.m_oAxeX.m_dPas;break;case EAxisType.Y:case EAxisType.Y2:t=this.m_oAxeY.m_dPas;break;default:t=0}return t<=0&&(t=IWDChartConstant.DEFAULT_VALUE),t};WDChartParameters.prototype.isAxisVisible=function(n){switch(n.m_type){case EAxisType.X:case EAxisType.X2:return this.m_oAxeX.m_bVisible;case EAxisType.Y:case EAxisType.Y2:return this.m_oAxeY.m_bVisible}return!1};WDChartParameters.prototype.isVerticalGridShown=function(){var n=this.m_bAxeXHorizontal?this.m_oAxeX:this.m_oAxeY;return n.m_bQuadrillage};WDChartParameters.prototype.isHorizontalGridShown=function(){var n=this.m_bAxeXHorizontal?this.m_oAxeY:this.m_oAxeX;return n.m_bQuadrillage};WDChartParameters.prototype.isStackedBarChart=function(){return this.getType()==WDChartParameters.kHistoEmpile||this.getType()==WDChartParameters.kHistoEmpileHorizontal};WDChartParameters.prototype.isBoursierChart=function(){return this.getType()==WDChartParameters.kBarCharts||this.getType()==WDChartParameters.kMinMax||this.getType()==WDChartParameters.kChandelier};WDChartParameters.kSecteur=0;WDChartParameters.kHisto=1;WDChartParameters.kCourbe=2;WDChartParameters.kNuage=5;WDChartParameters.kChandelier=6;WDChartParameters.kBarCharts=7;WDChartParameters.kMinMax=8;WDChartParameters.kHistoEmpile=9;WDChartParameters.kDonut=23;WDChartParameters.kAire=24;WDChartParameters.kRadar=25;WDChartParameters.kHemicycle=26;WDChartParameters.kHistoHorizontal=27;WDChartParameters.kHistoEmpileHorizontal=28;WDChartParameters.kBulle=32;WDChartParameters.kEntonnoir=33;WDChartParameters.kWaterfall=35;WDChartParameters.kSecteurMultiniveau=36;WDChartParameters.kHeatMap=37;WDChartParameters.kSans=0;WDChartParameters.kDroite=1;WDChartParameters.kGauche=2;WDChartParameters.kHaut=3;WDChartParameters.kBas=4;WDChartParameters.eOrientationDefaut=0;WDChartParameters.eOrientationHorizontale=1;WDChartParameters.eOrientationVerticale=2;WDChartParameters.sMasqueDateHeure="AAAAMMJJHHmmSSCCC";WDChartParameters.sMasqueHeure="HH:mm:SS:CCC";WDChartParameters.sMasqueDate="JJ/MM/AAAA";WDChartUtils.is_in_triangle=function(n,t,i,r,u,f,e,o){var s=[e-i,o-r],h=[u-i,f-r],c=[n-i,t-r],a=s[0]*s[0]+s[1]*s[1],l=s[0]*h[0]+s[1]*h[1],v=s[0]*c[0]+s[1]*c[1],y=h[0]*h[0]+h[1]*h[1],p=h[0]*c[0]+h[1]*c[1],w=1/(a*y-l*l),b=(y*v-l*p)*w,k=(a*p-l*v)*w;return b>=0&&k>=0&&b+k<1};WDChartUtils.formatValue=function(n,t,i,r){var u,f,e,o;if(r===undefined){for(u=t.length-1;u>=0&&isNaN(parseInt10(t[u]));)--u;++u;u<t.length&&(r=t.substr(u),t=t.substr(0,u))}if((t||"")==""&&(r||"")=="")return n;f=n||0;!0!==i&&(f=parseInt10(f));try{e=_WW_SEPDECIMAL_;_WW_SEPDECIMAL_=".";o=__reinitNombre(String(f),t.replace(".",sSepDecimalMasque),r!==undefined,r)}catch(s){}finally{_WW_SEPDECIMAL_=e}return o};WDChartUtils.getCouleurAutoFromIndex=function(n,t){t=!0;var i=0;switch(n%11){case 0:i=t?"#ffd440":"#48cfad";break;case 1:i=t?"#d79df8":"#ffce54";break;case 2:i=t?"#65c3e6":"#fc6e51";break;case 3:i=t?"#b0e433":"#3bafda";break;case 4:i=t?"#ffbf69":"#ab47bc";break;case 5:i=t?"#b2a3ff":"#78909c";break;case 6:i=t?"#5ed7cb":"#d4e157";break;case 7:i=t?"#d8eb2b":"#ffa726";break;case 8:i=t?"#ff9dc7":"#ffee58";break;case 9:i=t?"#67afe8":"#5c6bc0";break;case 10:i=t?"#88e371":"#ec407a"}return i};WDMathUtils.roundToMultiple=function(n,t){return t*Math.round(n/t)};WDRect.prototype.constructor=WDRect;WDRect.prototype.set=function(n,t,i,r){if(t===undefined&&n!==undefined&&n.m_nLeft!==undefined){this.set(n.m_nLeft,n.m_nTop,n.m_nRight,n.m_nBottom);return}this.setLeft(n);this.setTop(t);this.setRight(i);this.setBottom(r)};WDRect.prototype.setCorners=function(n,t,i,r){this.setLeft(Math.min(n,i));this.setTop(Math.min(t,r));this.setRight(Math.max(n,i));this.setBottom(Math.max(t,r))};WDRect.prototype.offset=function(n,t){this.setLeft(this.m_nLeft+n);this.setTop(this.m_nTop+t);this.setRight(this.m_nRight+n);this.setBottom(this.m_nBottom+t)};WDRect.prototype.setSize=function(n,t){this.setRight(this.m_nLeft+n);this.setBottom(this.m_nTop+t)};WDRect.prototype.setSizeAndLocation=function(n,t,i,r){this.setSize(i,r);this.setLocation(n,t,!0)};WDRect.prototype.setLocation=function(n,t,i){!i||(this.setRight(this.m_nRight+(n-this.m_nLeft)),this.setBottom(this.m_nBottom+(t-this.m_nTop)));this.setLeft(n);this.setTop(t)};WDRect.prototype.getLeft=function(){return this.m_nLeft};WDRect.prototype.getTop=function(){return this.m_nTop};WDRect.prototype.getRight=function(){return this.m_nRight};WDRect.prototype.getBottom=function(){return this.m_nBottom};WDRect.prototype.setTop=function(n){this.m_nTop=this.__toN(n)};WDRect.prototype.setRight=function(n){this.m_nRight=this.__toN(n)};WDRect.prototype.setBottom=function(n){this.m_nBottom=this.__toN(n)};WDRect.prototype.setLeft=function(n){this.m_nLeft=this.__toN(n)};WDRect.prototype.__toN=function(n){return Math.max(0,n||0)};WDRect.getWidth=WDRect.prototype.getWidth=function(n){return n||(n=this),n.m_nRight-n.m_nLeft};WDRect.getHeight=WDRect.prototype.getHeight=function(n){return n||(n=this),n.m_nBottom-n.m_nTop};WDRect.intersects=function(n,t){return n.m_nLeft<t.m_nRight&&t.m_nLeft<n.m_nRight&&n.m_nTop<t.m_nBottom&&t.m_nTop<n.m_nBottom};WDRect.getCenterX=function(n){return n.m_nLeft+n.m_nRight>>1};WDRect.prototype.getCenterX=function(){return WDRect.getCenterX(this)};WDRect.getCenterY=function(n){return n.m_nTop+n.m_nBottom>>1};WDRect.prototype.getCenterY=function(){return WDRect.getCenterY(this)};EAxisType.X=0;EAxisType.X2=1;EAxisType.Y=2;EAxisType.Y2=3;EAxisType.Z=4;EAxisOrientation.HORIZONTAL=0;EAxisOrientation.VERTICAL=1;WDChartAxis.prototype.constructor=WDChartAxis;WDChartAxis.prototype.setOriginValue=function(n){this.m_dOriginValue=n};WDChartAxis.prototype.getOriginValue=function(){return this.m_dOriginValue};WDChartAxis.prototype.isXAxis=function(){return this.m_type==EAxisType.X||this.m_type==EAxisType.X2};WDChartAxis.prototype.isYAxis=function(){return this.m_type==EAxisType.Y||this.m_type==EAxisType.Y2};WDChartAxis.prototype.isSecondaryAxis=function(){return this.m_type==EAxisType.X2||this.m_type==EAxisType.Y2};WDChartAxis.prototype.update=function(n){var u,f,v,r,y,h,a,e,o,c,l,t,i;if(this.m_lstData&&this.m_lstData.length!==0){u=0;f=0;switch(this.m_type){case EAxisType.X:case EAxisType.X2:u=n.getXAxisMin();f=n.getXAxisMax();break;case EAxisType.Y:u=n.getYAxisMin();f=n.getYAxisMax();break;case EAxisType.Y2:u=n.getY2AxisMin();f=n.getY2AxisMax()}if(this.m_dMinValue=u==IWDChartConstant.DEFAULT_VALUE?n.isBoursierChart()&&this.m_type==EAxisType.Y?Number.POSITIVE_INFINITY:0:u,this.m_dMaxValue=f==IWDChartConstant.DEFAULT_VALUE?Number.NEGATIVE_INFINITY:f,u==IWDChartConstant.DEFAULT_VALUE||f==IWDChartConstant.DEFAULT_VALUE)if(this.isYAxis()&&n.getType()==WDChartParameters.kWaterfall){var i=this.m_lstData[0],a=i.getNbValues(),s=i.getValueAt(0);for(t=1;t<a;++t)(v=this.m_oModele.getWaterfallTypeCategorie(t),v!=ETypeCategorieWaterfall.eWaterfallSousTotal&&v!=ETypeCategorieWaterfall.eWaterfallTotal)&&(e=i.getValueAt(t),s+=e,s>this.m_dMaxValue&&(this.m_dMaxValue=s),s<this.m_dMinValue&&(this.m_dMinValue=s))}else if(this.isYAxis()&&(n.getType()==WDChartParameters.kHistoEmpile||n.getType()==WDChartParameters.kHistoEmpileHorizontal)){for(r=[],y=0,h=0;h<this.m_lstData.length;++h){for(i=this.m_lstData[h],a=i.getNbValues(),t=0;t<a;++t)e=i.getValueAt(t),y>0&&t<r.length?(o=r[t],o>0?o+=Math.abs(e):o<0?o-=Math.abs(e):o=e,r[t]=o):r[t]=e;y++}if(u==IWDChartConstant.DEFAULT_VALUE){for(t=0;t<r.length;++t)(t===0||c>r[t])&&(c=r[t]);c<this.m_dMinValue&&(this.m_dMinValue=c)}if(f==IWDChartConstant.DEFAULT_VALUE){for(t=0;t<r.length;++t)(t===0||l<r[t])&&(l=r[t]);l>this.m_dMaxValue&&(this.m_dMaxValue=l)}}else for(t=0;t<this.m_lstData.length;++t)i=this.m_lstData[t],u==IWDChartConstant.DEFAULT_VALUE&&i.getMinValue()<this.m_dMinValue&&(this.m_dMinValue=i.getMinValue()),f==IWDChartConstant.DEFAULT_VALUE&&i.getMaxValue()>this.m_dMaxValue&&(this.m_dMaxValue=i.getMaxValue())}else this.m_dMinValue=0,this.m_dMaxValue=0};WDChartAxis.prototype.isDisplayCategories=function(){return this.m_lstData!=null&&this.m_lstData.length==1&&bCompareFonctions(this.m_lstData[0].constructor,WDChartCategories.prototype.constructor)};WDChartAxis.prototype.isDisplayDecimalValues=function(n){for(var u,r,t=!1,i=0;i<this.m_lstData.length;++i)if(u=this.m_lstData[i],u.isContainDecimalValues()){t=!0;break}return t&&this.isYAxis()&&(r=n.m_sMasqueAxes,r&&!r.indexOf(".")&&(t=!1)),t};WDChartAxis.prototype.hasMasqueAxeY=function(){return this.isYAxis()};WDChartAxisContinu.prototype=new WDChartAxis;WDChartAxisContinu.prototype.constructor=WDChartAxisContinu;WDChartAxisContinu.prototype.isDisplayCategories=function(){return!1};WDChartAxisContinu.prototype.hasMasqueAxeY=function(){return this.m_type!=EAxisType.Z};EAlgoGestionAltitude.eagaDegradeLineaire=0;EAlgoGestionAltitude.eagaPalierInferieur=1;EAlgoGestionAltitude.eagaPalierSuperieur=2;CCouleurAltitude.prototype=new JSONPOO;CCouleurAltitude.prototype.constructor=CCouleurAltitude;CCouleurAltitude.prototype.bUtiliseCouleurAltitude=function(){return this.m_tabKeysTriees.length>0};CCouleurAltitude.prototype.AddCouleurAltitude=function(n,t){this.m_tabCouleurAltitude[n]=t;this.Trie()};CCouleurAltitude.prototype.Trie=function(){this.m_tabKeysTriees=Object.getOwnPropertyNames(this.m_tabCouleurAltitude).sort(function(n,t){return parseFloat(n)<parseFloat(t)?-1:1})};CCouleurAltitude.prototype.nGetNbCouleurs=function(){return this.m_tabKeysTriees.length};CCouleurAltitude.prototype.stGetI=function(n){return{m_crCouleur:this.m_tabCouleurAltitude[this.m_tabKeysTriees[n]],m_dAltitude:parseFloat(this.m_tabKeysTriees[n])}};CCouleurAltitude.prototype.sGetCouleurAltitude=function(n){for(var f,i,t={},u={},r=0;r<this.nGetNbCouleurs();++r){if((t=this.stGetI(r),r==0&&n<t.m_dAltitude)||t.m_dAltitude==n)return t.m_crCouleur;if(r<this.m_tabKeysTriees.length-1&&(u={m_crCouleur:this.m_tabCouleurAltitude[this.m_tabKeysTriees[r+1]],m_dAltitude:parseFloat(this.m_tabKeysTriees[r+1])},n<u.m_dAltitude&&n>t.m_dAltitude))switch(this.m_eAlgoPalier){case EAlgoGestionAltitude.eagaPalierInferieur:return u.m_crCouleur;case EAlgoGestionAltitude.eagaPalierSuperieur:return t.m_crCouleur;case EAlgoGestionAltitude.eagaDegradeLineaire:default:f=u.m_dAltitude-t.m_dAltitude;i=0;f!=0&&(i=(n-t.m_dAltitude)/f);var e=clWDUtil.tabHTML2RVBA(t.m_crCouleur),o=clWDUtil.tabHTML2RVBA(u.m_crCouleur),s=i*o[0]+(1-i)*e[0],h=i*o[1]+(1-i)*e[1],c=i*o[2]+(1-i)*e[2];return clWDUtil.sRVBA2HTML([s,h,c,1])}}if(this.m_tabKeysTriees.length)return this.m_tabCouleurAltitude[this.m_tabKeysTriees[this.m_tabKeysTriees.length-1]]};WDChartCategories.bEstTypeHeure=function(n){return n==25||n==129};WDChartCategories.bEstTypeDate=function(n){return n==24||n==128};WDChartCategories.bEstTypeDateHeure=function(n){return n==26};WDChartCategories.prototype=new JSONPOO;WDChartCategories.prototype.constructor=WDChartCategories;WDChartCategories.prototype.sGetFormatDateDefaut=function(n,t){return(n||WDChartParameters.sMasqueDate).substr(0,(t||this.m_tabValeur[0]).length)};WDChartCategories.prototype.sGetFormatHeureDefaut=function(n,t){return(n||WDChartParameters.sMasqueHeure).substr(0,(t||this.m_tabValeur[0]).length)};WDChartCategories.prototype.sGetFormatDefaut=function(n){var t=WDChartCategories.bEstTypeDateHeure(this.m_eTypeWL)||WDChartCategories.bEstTypeDate(this.m_eTypeWL),i=WDChartCategories.bEstTypeDateHeure(this.m_eTypeWL)||WDChartCategories.bEstTypeHeure(this.m_eTypeWL);return t&&i?WDChartParameters.sMasqueDateHeure.substr(0,(n||this.m_tabValeur[0]).length):t?this.sGetFormatDateDefaut(undefined,n):this.sGetFormatHeureDefaut(undefined,n)};WDChartCategories.prototype.tabConvertionVersValeursTemporels=function(n){for(var o=WDChartCategories.bEstTypeDateHeure(this.m_eTypeWL)||WDChartCategories.bEstTypeDate(this.m_eTypeWL),s=WDChartCategories.bEstTypeDateHeure(this.m_eTypeWL)||WDChartCategories.bEstTypeHeure(this.m_eTypeWL),i=[],r=0;r<this.m_tabValeur.length;++r){var e=this.m_tabValeur[r],u=o?clWDUtil.sChaineVersDate(e,n):"19700102",t=s?clWDUtil.sChaineVersHeure(e,n):"000000000",f=new Date;f.setFullYear(parseInt10(u.substr(0,4)),parseInt10(u.substr(4,2))-1,parseInt10(u.substr(6,2)));f.setHours(parseInt10(t.substr(0,2)),parseInt10(t.substr(2,2)),parseInt10(t.substr(4,2)),parseInt10(t.substr(6,3)));i.push(f)}return i};WDChartCategories.prototype.bEchelleTemporelle=function(){return this.m_oModele.m_oParametres.m_bEchelleTemporelle&&(WDChartCategories.bEstTypeDateHeure(this.m_eTypeWL)||WDChartCategories.bEstTypeDate(this.m_eTypeWL)||WDChartCategories.bEstTypeHeure(this.m_eTypeWL))};WDChartCategories.prototype.isOnSecondaryAxis=function(){return!1};WDChartCategories.prototype.getMinValue=function(){return 0};WDChartCategories.prototype.getMaxValue=function(){return this.m_oModele.getMaxNbValuesSeries()-1};WDChartCategories.prototype.getNbValues=function(){return this.m_tabValeur?this.m_tabValeur.length+Math.max(this.m_nOffset-1,0):0};WDChartCategories.prototype.getValueAt=function(n){return this.m_tabValeur.length==0?"":n<this.m_nOffset-1?"":this.m_tabValeur[n-(this.m_nOffset-1)]};WDChartCategories.prototype.getTimeInMillisAt=function(n){return!this.m_tabValeurMS||this.m_tabValeurMS.length<n?0:this.m_tabValeurMS[n].getTime()};WDChartCategories.prototype.getMinValueInMillis=function(){var n,t,i;if(!this.m_tabValeurMS||this.m_tabValeurMS.length==0)return 0;for(n=Number.POSITIVE_INFINITY,t=0;t<this.m_tabValeurMS.length;++t)i=this.m_tabValeurMS[t].getTime(),i<n&&(n=i);return n};WDChartCategories.prototype.getMaxValueInMillis=function(){var n,t,i;if(!this.m_tabValeurMS||this.m_tabValeurMS.length==0)return 0;for(n=Number.NEGATIVE_INFINITY,t=0;t<this.m_tabValeurMS.length;++t)i=this.m_tabValeurMS[t].getTime(),i>n&&(n=i);return n};WDChartCategories.prototype.isContainDecimalValues=function(){return!1};WDChartModel.prototype=new JSONPOO;WDChartModel.prototype.constructor=WDChartModel;WDChartModel.prototype.FLAG_DEJA_DESSINEES=1;WDChartModel.prototype.bDonneesDejaDessinnees=function(){return this.m_oGraphe.m_oDonnees.m_bFlag&&this.m_oGraphe.m_oDonnees.m_bFlag&this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.SetDonneesDessinnees=function(){this.m_oGraphe.m_oDonnees.m_bFlag=(this.m_oGraphe.m_oDonnees.m_bFlag||0)|this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.bParametresDejaDessinnes=function(){return this.m_oGraphe.m_oParametres.m_bFlag&&this.m_oGraphe.m_oParametres.m_bFlag&this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.SetParametresDejaDessinnes=function(){this.m_oGraphe.m_oParametres.m_bFlag=(this.m_oGraphe.m_oParametres.m_bFlag||0)|this.FLAG_DEJA_DESSINEES};WDChartModel.prototype.getSeriesAt=function(n,t){return this.m_tabSeries===undefined||this.m_tabSeries[n]===undefined?t?{}:undefined:this.m_tabSeries[n]};WDChartModel.prototype.getPartOffset=function(n,t){var i;return this.m_tabExcentrage!==undefined&&(n=n-(this.m_nOffsetExcentrage-1),n>=0&&this.m_tabExcentrage!==undefined&&n<this.m_tabExcentrage.length&&(i=this.m_tabExcentrage[n])),(i===undefined?t:i)||0};WDChartModel.prototype.hasPremiereSerieNonVide=function(){return this.m_tabSeries.length>0&&this.m_tabSeries[0].getNbValues()>0};WDChartModel.prototype.hasAuMoinsUneSerieNonVide=function(){for(var n=0;n<this.m_tabSeries.length;++n)if(this.m_tabSeries[n].getNbValues()>0)return!0;return!1};WDChartModel.prototype.getCategoryLabelAt=function(n){var t=this.m_oCategories.getValueAt(n);return t===undefined?"":t};WDChartModel.prototype.getFromSerieValueAt=function(n,t){return this.m_tabSeries[n].getValueAt(t)};WDChartModel.prototype.getCategoryColor=function(n,t){var i=undefined;return this.m_oCategories!==undefined&&this.m_oCategories.m_tabCouleur!==undefined&&(i=this.m_oCategories.m_tabCouleur[n]),t!==!0&&i===undefined&&(i=this.getSeriesColor(n)),i};WDChartModel.prototype.getWaterfallTypeCategorie=function(n){return n==0?ETypeCategorieWaterfall.eWaterfallTotal:this.m_oCategories===undefined||this.m_oCategories.m_tabTypeCategorieWaterfall===undefined?undefined:(n-=this.getMaxNbValuesSeries()-this.m_oCategories.m_tabTypeCategorieWaterfall.length,this.m_oCategories.m_tabTypeCategorieWaterfall[n]===undefined)?undefined:this.m_oCategories.m_tabTypeCategorieWaterfall[n]};WDChartModel.prototype.getSeriesColor=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_sCouleur),t===undefined&&(t=WDChartUtils.getCouleurAutoFromIndex(n+1)),t};WDChartModel.prototype.getSeriesAlpha=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_nOpacite),(t===undefined||t===-1)&&(t=this.m_oParametres.byGetAlpha()),t};WDChartModel.prototype.getSeriesSpline=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_eLissage),(t===undefined||t===-1)&&(t=this.m_oParametres.m_bSpline),t};WDChartModel.prototype.getSeriesDessinValeursNulles=function(n){var i=this.m_tabSeries[n],t;return i&&(t=i.m_eDessinValeursNulles),(t===undefined||t===-1)&&(t=this.m_oParametres.m_eDessinValeurNulle),t};WDChartModel.prototype.createAxis=function(){this.m_lstAxis&&(this.m_lstAxis=null,delete this.m_lstAxis);this.m_lstAxis=[];var u=[],r=[],t=undefined,f=undefined,n=0,i=undefined,e=this.m_oParametres.getType();switch(e){default:case WDChartParameters.kCourbe:case WDChartParameters.kAire:case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:case WDChartParameters.kHistoEmpileHorizontal:case WDChartParameters.kHistoHorizontal:case WDChartParameters.kWaterfall:case WDChartParameters.kRadar:case WDChartParameters.kChandelier:case WDChartParameters.kBarCharts:case WDChartParameters.kMinMax:if(u.push(this.m_oCategories),this.m_lstAxis.push(new WDChartAxis(EAxisType.X,u,this)),this.m_tabSeries)for(n=0;n<this.m_tabSeries.length;++n)(i=this.m_tabSeries[n],this.m_oGraphe.m_oVue.m_oRenderer&&this.m_oGraphe.m_oVue.m_oRenderer.bEstLegendeMasquee(n))||(i.isOnSecondaryAxis()&&e!=WDChartParameters.kHistoEmpile&&e!=WDChartParameters.kHistoEmpileHorizontal?(t||(t=[]),t.push(i)):r.push(i));r!=null&&this.m_lstAxis.push(new WDChartAxis(EAxisType.Y,r,this));t!=null&&this.m_lstAxis.push(new WDChartAxis(EAxisType.Y2,t,this));break;case WDChartParameters.kBulle:case WDChartParameters.kNuage:case WDChartParameters.kHeatMap:if(this.m_tabSeries)for(n=0;n<this.m_tabSeries.length;++n)(i=this.m_tabSeries[n],this.m_oGraphe.m_oVue.m_oRenderer&&this.m_oGraphe.m_oVue.m_oRenderer.bEstLegendeMasquee(n))||(n%this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie==0?u.push(i):n%this.m_oGraphe.m_oVue.m_oRenderer.m_nPasSerie==1?i.isOnSecondaryAxis()?(t||(t=[]),t.push(i)):r.push(i):(f||(f=[]),f.push(i)));u!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.X,u,this));r!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Y,r,this));t!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Y2,t,this));f!=null&&this.m_lstAxis.push(new WDChartAxisContinu(EAxisType.Z,f,this));break;case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:case WDChartParameters.kEntonnoir:}};WDChartModel.prototype.getCategoryIndexForTime=function(n){for(var u,i=0,r=0,t=0;t<this.m_oCategories.getNbValues();++t){if(u=this.m_oCategories.getTimeInMillisAt(t),u<=n)i=r;else break;r++}return i};WDChartModel.prototype.getMaxNbValuesSeries=function(){var t=0,n,r,i;if(this.m_tabSeries)for(n=0;n<this.m_tabSeries.length;++n)r=this.m_tabSeries[n],i=r.getNbValues(),i>t&&(t=i);return t};WDChartModel.prototype.getAxisByType=function(n){var r,t,i;if(this.m_lstAxis)for(r=this.m_lstAxis.length,t=0;t<r;++t)if(i=this.m_lstAxis[t],i.m_type==n)return i;return undefined};WDChartRenderer.prototype.drawMire=function(n,t,i,r,u,f){var o=this,a,e,ar,vr,li,ht,pr,wu,bu,ku,du,gu,ui,fi,vt,tu,nf,tr,iu,ei,ut,rt,h,l,rr,dt,uu,fu,ur,st,eu,ou,sf,hr,cr,hf,su,cf,hu,yt,ci,lr,cu,at;if(o.m_oPaint.raz(),a=o.m_params,e=a.getType(),a.m_bBulleActive){if(o.m_oGraphe.m_oParametres.m_eType==WDChartParameters.kHeatMap){if(!r){for(vr=o.m_domGroupeSeries.find("rect"),li=0;li<vr.length;++li)ar=WDChartListener.bind(WDChartMireListener,o.m_oGraphe,$(vr[li]),i);ar=WDChartListener.bind(WDChartMireListener,o.m_oGraphe,n.m_domBaliseSVG,i)}}else ar=WDChartListener.bind(WDChartMireListener,o.m_oGraphe,n.m_domBaliseSVG,i);if(o.m_domGroupeSeries&&o.m_domGroupeSeries.length!==0&&o.m_domGroupeSeries.children().length!==0&&!o.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()){n.m_domBaliseSVG.css("cursor","");var c=u,p=f,yr=r===undefined||isNaN(r.pageX)||isNaN(r.pageY);if((!yr||u!==undefined)&&(ht=n.m_domBaliseSVG.wbData("wbGrfOnScrollResize"),ht&&ht.height||$(window).on("scroll.wb.grf.mire resize.wb.grf.mire trigger.wb.grf.mire",function(){n.m_domBaliseSVG.wbData("wbGrfOnScrollResize",ht={offset:n.m_domBaliseSVG.offset(),width:n.m_domBaliseSVG.width(),height:n.m_domBaliseSVG.height()})}).trigger("trigger.wb.grf.mire"),yr||(pr=ht.offset,c=r.pageX-pr.left,p=r.pageY-pr.top),c!==undefined&&p!==undefined)){var wr=2,lu=3;WDChartRenderer.prototype.s_m_nProfileMireForce=WDXYChartRenderer.prototype.s_m_nProfileMireForce;var au=e==WDChartParameters.kCourbe||e==WDChartParameters.kRadar||e==WDChartParameters.kAire||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHistoEmpileHorizontal,lf=e==WDChartParameters.kBulle||e==WDChartParameters.kNuage||e==WDChartParameters.kCourbe||e==WDChartParameters.kAire||e==WDChartParameters.kHeatMap,br=WDChartRenderer.prototype.s_m_nProfileMireForce||(a.m_bMire?a.m_bMireMultiple&&au?wr:1:lu),wt=!(e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle)&&br!==lu,ct=wt&&au&&br===wr||!1,lt=br===wr&&!(e==WDChartParameters.kRadar)||e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||WDChartRenderer.prototype.s_m_bSuivreCurseurForce===!0||!1,it=ct&&!0,ai=0,af=!0,ft=1,et=ft,bt=100,ot=!0,vi=!ct&&lf&&!0,vu=wt&&!(e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHisto||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kWaterfall||e==WDChartParameters.kRadar)&&!0,yi=!vi&&it,yu=it||!1,vf=!0,pu=ct||e==WDChartParameters.kRadar||e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||WDChartRenderer.prototype.s_m_bDeplacementForce===!0||!1,yf=e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap||e==WDChartParameters.kNuage||e==WDChartParameters.kCourbe||e==WDChartParameters.kAire||e==WDChartParameters.kRadar,kr=yf&&!0?3:0,pi=!lt&&(e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHisto||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kWaterfall)||!1,ni=!pi&&!1,pf=!1,wf=!1,dr=!0,bf=!1,ti=!wt&&(e==WDChartParameters.kNuage||e==WDChartParameters.kCourbe||e==WDChartParameters.kAire||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHisto||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kWaterfall||e==WDChartParameters.kRadar),kt=!it&&!lt&&(!1||ti||!wt&&(e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHisto||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kWaterfall)||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||e==WDChartParameters.kEntonnoir),ii=!(e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||e==WDChartParameters.kEntonnoir),kf=undefined,wi=undefined,ri=undefined,te=undefined,w=o.m_rectChartInitial;if(o.m_rectAxis!==undefined&&(w.m_nLeft=o.m_rectAxis.m_nLeft,w.m_nBottom=o.m_rectAxis.m_nBottom,wu=n.findFromId(n.m_domBaliseSVG,"axe-vert-2").length>0,(wu||vi)&&(w.m_nRight=o.m_rectAxis.m_nRight),bu=n.findFromId(n.m_domBaliseSVG,"axe-horiz-2").length>0,(bu||wt)&&(w.m_nTop=o.m_rectAxis.m_nTop)),ku=n.m_domBaliseSVG[0].getAttribute("preserveAspectRatio")==="none",ku)c=c/ht.width*$(o.m_oGraphe.m_oHoteImage).data("width"),p=p/ht.height*$(o.m_oGraphe.m_oHoteImage).data("height");else{var gr=ht.width,nu=ht.height,bi=$(o.m_oGraphe.m_oHoteImage).data("width"),ki=$(o.m_oGraphe.m_oHoteImage).data("height"),di,gi;bi>ki?(di=gr,gi=gr*(ki/bi)):(gi=nu,di=nu*(bi/ki));du=(gr-di)/2;gu=(nu-gi)/2;c=(c-du)/di*bi;p=(p-gu)/gi*ki}var nt=!0,s=0,d=undefined,k=0;if(e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle)nt=o.m_domGroupeSeries.find("path:hover").length===0,nt&&(ui=o.m_domGroupeSeries.find("path").first().wbData("wbGrfDrawPath"),ui&&(nt=ui.width<Math.sqrt(Math.pow(Math.abs(c-ui.x),2)+Math.pow(Math.abs(p-ui.y),2))));else if(e==WDChartParameters.kEntonnoir)nt=o.m_domGroupeSeries.find("path:hover").length===0;else if(e==WDChartParameters.kHisto||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kWaterfall)nt=o.m_domGroupeSeries.find("rect:hover").length===0,nt&&i.wbData("wbGrfMireSerie")!==undefined&&i.wbData("wbGrfMireX")!==undefined&&(fi=n.findFromId(o.m_domGroupeSeries,"groupe-serie-"+i.wbData("wbGrfMireSerie")),fi.length>0&&(vt=n.findFromId(fi,"series-barre-"+i.wbData("wbGrfMireX")),vt.length>0&&(nt=p<vt.attr("y"),nt||(nt=p>parseInt10(vt.attr("y"))+parseInt10(vt.attr("height"))),nt||(tu=n.findFromId(fi,"series-barre-"+(parseInt10(i.wbData("wbGrfMireX"))+1)),nt=tu.length>0?c>tu.attr("x"):c>parseInt10(vt.attr("x"))+parseInt10(vt.attr("width")),nt||(nf=n.findFromId(fi,"series-barre-"+(parseInt10(i.wbData("wbGrfMireX"))-1)),nf.length==0&&(nt=c<vt.attr("x")))))));else if(e==WDChartParameters.kHeatMap&&r&&r.target&&r.target.nodeType==1&&r.target.tagName.toLowerCase()=="rect")h=$(r.target),nt=!1;else{if(e==WDChartParameters.kNuage||e==WDChartParameters.kRadar||e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap){var tf=n.m_domBaliseSVG.find("*:hover").last(),nr=undefined;for(s=0;s<o.m_oGraphe.m_oModele.m_tabSeries.length;s+=o.m_nPasSerie)if((d=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+s),d&&d.length!==0&&(o.m_oGraphe.m_oVue.bEstSerieMasquee(s)!==!0||!ii))&&(h=n.findFromId(d,"serie-line-"+s),h.length!==0))for(l=h.wbData("wbGrfSeriePoints"),k=0;k<l.length;++k)tr=Math.abs(Math.abs(c)-Math.abs(parseInt10(l[k].x)))+Math.abs(Math.abs(p)-Math.abs(parseInt10(l[k].y))),iu=!1,nr!=tr||!1||(iu=e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap?tf.is(n.findFromId(h,"series-"+s+"-point-"+k)):h.is(tf)),(nr===undefined||nr>tr||iu)&&(nr=tr,wi=k,ri=s);kf=l[wi]}ei=o.m_rectAxis||w;nt=c<ei.m_nLeft||p<ei.m_nTop||c>ei.m_nRight||p>ei.m_nBottom}if(nt){i.wbData("wbGrfMireFade")===1&&(i.stop("wbGrfMireFade",!0).wbData("wbGrfMireFade",0).animate({opacity:0},{duration:1e3,queue:"wbGrfMireFade"}).dequeue("wbGrfMireFade"),o.surbrillanceSerieDepuisMire(n,i.wbData("wbGrfMireSerie"),!1,!0,c,p));return}n.m_domBaliseSVG.css("cursor","");var df=lt&&pu,gf=!0,tt=a.m_sCouleurAxe;tt=clWDUtil.sGetCouleurHTMLAssocie(tt);var y=w.m_nTop,oi=a.m_sClasseBulle,si=[],rf=[],hi=[],v,g,ir,b={},ru=c,uf=0,pt=undefined;for(s=0;v===undefined&&s<o.m_oGraphe.m_oModele.m_tabSeries.length;s+=o.m_nPasSerie)if(ut=!1,d=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+s),d&&d.length!==0&&(o.m_oGraphe.m_oVue.bEstSerieMasquee(s)!==!0||!ii)){if(l=undefined,e==WDChartParameters.kCourbe||e==WDChartParameters.kAire){if(h=n.findFromId(d,"serie-line-"+s),h.length===0)continue;l=h.wbData("wbGrfSeriePoints")}else if(e==WDChartParameters.kNuage||e==WDChartParameters.kRadar){if(ri!==undefined&&ri!=s&&!ct)continue;if(h=n.findFromId(d,"serie-line-"+s),h.length===0)continue;if(l=h.wbData("wbGrfSeriePoints"),wi!==undefined)pt=wi;else if(e==WDChartParameters.kNuage||pt===undefined)for(rr=undefined,dt=0;dt<l.length;++dt)uu=Math.abs(Math.abs(c)-Math.abs(parseInt10(l[dt].x)))+Math.abs(Math.abs(p)-Math.abs(parseInt10(l[dt].y))),(rr===undefined||rr>uu)&&(rr=uu,pt=dt);ut=!0;rt=pt;dr=o.m_rectAxis.getCenterX()>l[pt].x;l=[{x:l[pt].x,y:l[pt].y}]}else if(e==WDChartParameters.kBulle){if(ri!==undefined&&ri!=s&&!ct)continue;if(h=n.findFromId(d,"serie-line-"+s),h.length===0)continue;fu=h.find("circle");fu.length>0?(ur=undefined,fu.each(function(){var n=$(this),t=Math.abs(Math.abs(c)-Math.abs(parseInt10(n.attr("cx"))))+Math.abs(Math.abs(p)-Math.abs(parseInt10(n.attr("cy"))));(ur===undefined||ur>t)&&(ur=t,h=n)}),ut=!0,rt=parseInt10(n.getId(h).substr(n.getId(h).lastIndexOf("-")+1)),l=[{x:h.attr("cx"),y:h.attr("cy")}]):l=h.wbData("wbGrfSeriePoints")}else if(e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle){if(h=o.m_domGroupeSeries.find("path:hover"),h.length===0)continue;if(ut=!0,rt=WDPieChartRenderer.nGetIndicePart(n,h),st=h.wbData("wbGrfDrawPath"),st){var fr=st.x,er=st.y,gt=st.width,or=c,sr=p;if(!lt)if(1)eu=Number(st.options.startAngle+st.options.sweep/2).toRad(),or=fr+gt*Math.cos(eu),sr=er+gt*Math.sin(eu);else{var ff=Number(st.options.startAngle).toRad(),ef=Number(st.options.startAngle+st.options.sweep).toRad(),of=fr+gt*Math.cos(ff),ne=fr+gt*Math.cos(ef);or=of+(ne-of)/2;ou=er+gt*Math.sin(ff);sf=er+gt*Math.sin(ef);sr=ou+(sf-ou)/2}sr>er?(ni=!0,pi=!ni):(ni=!1,pi=!ni);dr=or<fr?!0:!1;l=[{x:or,y:sr}]}else l=[{x:c,y:p}]}else if(e==WDChartParameters.kHisto||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kDonut||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kWaterfall||e==WDChartParameters.kHeatMap){if(h=r&&r.target&&r.target.nodeType==1&&r.target.tagName.toLowerCase()=="rect"?$(r.target):d.find("rect:hover"),h.length===0)continue;if(e!=WDChartParameters.kHeatMap&&(hr=h.wbData(),!(hr&&hr.wbGrfGrInfoXY&&hr.wbGrfGrInfoXY[0]==s)))continue;ut=!0;rt=parseInt10(n.getId(h).substr(n.getId(h).lastIndexOf("-")+1));l=[{x:parseInt10(h.attr("x"))+parseInt10(h.attr("width"))/2,y:h.attr("y")}];e==WDChartParameters.kHeatMap&&(a.m_nMireOpacite=a.m_nMireEpaisseur=a.m_sMireCouleur=undefined,ft=o.m_dXPixelsPerUnit,et=o.m_dYPixelsPerUnit,bt=0,tt=o.m_oGraphe.m_oModele.getSeriesColor(s))}else if(e==WDChartParameters.kMinMax||e==WDChartParameters.kChandelier||e==WDChartParameters.kBarCharts){if(h=d.find("g:hover"),cr=!1,h.length===0){if(hf=o.m_oModele.getAxisByType(EAxisType.X),su=o.m_oGraphe.m_oModele.m_tabSeries[s],!su)continue;if(cf=su.getNbValues(),hu=o.getDrawnValuesCount(cf,hf),hu==0)continue;for(yt=0;yt<=hu;++yt)if(ci=o.getCategoryDrawingPositionX(yt,cr),ci+=o.m_nBarSpacing+o.m_nBarWidth/2,ci>c)break;if(lr=o.getCategoryDrawingPositionX(Math.max(yt-1,0),cr),lr+=o.m_nBarSpacing+o.m_nBarWidth/2,yt>0&&c-lr<ci-c?(--yt,c=lr):c=ci,rt=yt,h=n.findFromId(d,"groupe-chandelier-0-barre-"+rt),!h||!h.length)return}else rt=parseInt10(n.getId(h).substr(n.getId(h).lastIndexOf("-")+1)),c=o.getCategoryDrawingPositionX(rt,cr)+(o.m_nBarSpacing+o.m_nBarWidth/2);a.m_nMireOpacite=a.m_nMireEpaisseur=a.m_sMireCouleur=undefined;et=ft=o.m_nBarWidth;bt=10;tt=o.m_oGraphe.m_oModele.getSeriesColor(s);ut=!0;l=[{x:c,y:p}]}else return;if(l)for(o.m_nPasSerie>1&&(l=[].concat(l),l.map(function(n,t){var i=n;return i.index=t,i}),l.sort(function(n,t){return n.x<t.x?-1:n.x>t.x?1:0})),k=0;k<l.length;++k)if(clWDUtil.isObject(l[k])?b=l[k]:b.x=l[k].x,b.x=parseInt10(b.x),cu=ut,ut||(cu=k<l.length-1?Math.abs((parseInt10(l[k+1].x)-b.x)/2)>Math.abs(c-b.x):l.length>1?Math.abs((b.x-parseInt10(l[k-1].x))/2)>Math.abs(b.x-c):Math.abs(c-b.x)<20),cu){si.length===0&&(uf=s);ru=e==WDChartParameters.kRadar&&uf!=s?ru:b.x;g=ut?rt:b.index!==undefined?b.index:k;b.y=parseInt10(l[k].y);at=b.y;ir!==!0&&(ir=ut?!0:Math.abs(p-at)<20);lt&&(at=p);!ct&&ir?(v=s,y=at):y=e==WDChartParameters.kRadar?si.length===0?at:y:si.length===0?at:Math.min(y,at);si[s]=at;rf[s]=b.x;hi[s]=b.y;break}else if(b.x>c)break}if(c=ru,!ct&&v===undefined){if(v=i.wbData("wbGrfMireSerie"),v==undefined)return;if(d=n.g("groupe-serie-"+v),o.m_oGraphe.m_oVue.bEstSerieMasquee(v)===!0&&ii){i.wbData("wbGrfMireSerie",undefined);return}y=si[v];s=v;e==WDChartParameters.kNuage||e==WDChartParameters.kCourbe||e==WDChartParameters.kAire||e==WDChartParameters.kRadar?h=n.findFromId(d,"serie-line-"+s):e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap?h=n.findFromId(d,"serie-line-"+s).find("circle:hover").first():e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle?h=o.m_domGroupeSeries.find("path:hover"):(e==WDChartParameters.kHisto||e==WDChartParameters.kHistoHorizontal||e==WDChartParameters.kDonut||e==WDChartParameters.kHistoEmpile||e==WDChartParameters.kHistoEmpileHorizontal||e==WDChartParameters.kWaterfall)&&(h=d.find("rect:hover"))}if(y!==undefined&&ir!==undefined){if(yr)return[v,g,v!==undefined&&g!==undefined?o.m_oGraphe.m_oModele.m_tabSeries[v+(o.m_nPasSerie>1?1:0)].getValueAtWithNull(g):undefined,v!==undefined&&g!==undefined?o.m_oGraphe.m_oModele.m_tabSeries[v+(o.m_nPasSerie>2?2:0)].getValueAtWithNull(g):undefined,v!==undefined&&g!==undefined?o.m_oGraphe.m_oModele.m_tabSeries[v+(o.m_nPasSerie>3?3:0)].getValueAtWithNull(g):undefined,v!==undefined&&g!==undefined?o.m_oGraphe.m_oModele.m_tabSeries[v+(o.m_nPasSerie>4?4:0)].getValueAtWithNull(g):undefined];o.rAF!==undefined&&cancelAnimationFrame(o.rAF);o.rAF=requestAnimationFrame(function(){var lr=!(!pu&&g===i.wbData("wbGrfMireX")&&(it||v==i.wbData("wbGrfMireSerie")))||af&&i.css("opacity")==0,yt,gt,gi,pt,nr,tr,ir,rr,ur,ht,f,k,er,dt,yr,d,ei,si,ui,or,ci,at,u,wi,bi,vt,eu,ki,di,ou,hr,cr;if(lr&&i.wbData("wbGrfMireFade")!==1&&i.stop("wbGrfMireFade",!0).wbData("wbGrfMireFade",1).animate({opacity:1},{duration:400,queue:"wbGrfMireFade"}).dequeue("wbGrfMireFade"),!lr){v!==undefined&&o.surbrillanceSerieDepuisMire(n,e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||e==WDChartParameters.kHeatMap?rt:v,!0,undefined,c,p,h);return}if(i.wbData("wbGrfMireSerie",v),i.wbData("wbGrfMireX",g),yt=n.g(i,"mire-axes-groupe"),gt=n.g(i,"mire-point-groupe"),gt.css("pointerEvents","none"),gi=n.g(i,"mire-bulle-groupe"),gt.empty(),yt.empty(),pt=hi[v],wt&&(vu&&(nr=n.line(yt,"mire-vert-haut"),ft=a.m_nMireEpaisseur||ft,tt=a.m_sMireCouleur||tt,o.m_oPaint.setStroke(tt,ft,(a.m_nMireOpacite||bt)/100),o.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,nr),n.drawLine(nr,c,y+ai+(vi?et:0),c,w.m_nBottom,o.m_oPaint),tr=n.line(yt,"mire-vert-bas"),ft=a.m_nMireEpaisseur||ft,tt=a.m_sMireCouleur||tt,o.m_oPaint.setStroke(tt,ft,(a.m_nMireOpacite||bt)/100),o.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,tr),n.drawLine(tr,c,w.m_nTop,c,y-ai,o.m_oPaint)),vi&&(ir=n.line(yt,"mire-horiz-gauche"),et=a.m_nMireEpaisseur||et,tt=a.m_sMireCouleur||tt,o.m_oPaint.setStroke(tt,et,(a.m_nMireOpacite||bt)/100),o.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,ir),rr=o.getAxisRendererForType(EAxisType.Y),rr&&rr.isDrawLabelsBetweenGraduations()&&(pt+=o.m_dYPixelsPerUnit/2),n.drawLine(ir,w.m_nLeft,pt,c-ai-(vu?ft/2:0),pt,o.m_oPaint),ur=n.line(yt,"mire-horiz-droit"),et=a.m_nMireEpaisseur||et,tt=a.m_sMireCouleur||tt,o.m_oPaint.setStroke(tt,et,(a.m_nMireOpacite||bt)/100),o.m_oPaint.DesactivePointerEvents(),n.SetAntiAliasing(!1,ur),n.drawLine(ur,c+ai+et,pt,w.m_nRight,pt,o.m_oPaint))),vf){var st=[],l=[],fr=!0;for(s=0;s<o.m_oGraphe.m_oModele.m_tabSeries.length;s+=o.m_nPasSerie)if((ht=undefined,g!==undefined&&(ht=o.m_oGraphe.m_oModele.getCategoryColor(g,!0)),ht||(ht=e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle?o.m_oGraphe.m_oModele.getCategoryColor(rt):e==WDChartParameters.kWaterfall||e==WDChartParameters.kNuage?h.attr("stroke"):e==WDChartParameters.kHeatMap?h.attr("fill"):o.m_oGraphe.m_oModele.getSeriesColor(s)),o.surbrillanceSerieDepuisMire(n,e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle||e==WDChartParameters.kHeatMap?rt:s,v===s,undefined,c,p,h),v===undefined||v==s)&&(o.m_oGraphe.m_oVue.bEstSerieMasquee(s)!==!0||!ii)&&g!==undefined){if(f=o.m_oGraphe.m_oModele.m_tabSeries[s].m_nEpaisseur,k=g,ut||o.m_params.getXAxisMin()==IWDChartConstant.DEFAULT_VALUE||(k+=o.m_params.getXAxisMin()),er=o.m_oGraphe.m_oModele.getCategoryLabelAt(k),dt=o.m_oGraphe.m_oModele.m_tabSeries[s].getValueAtWithNull(k),h.wbData("wbGrfDrawMire")&&h.wbData("wbGrfDrawMire").valeur&&(dt=h.wbData("wbGrfDrawMire").valeur),dt===IWDChartConstant.NULL_VALUE)continue;if(kr>0){var ar="series-"+s+"-point-"+g,vr=n.findFromId(o.m_domGroupeSeries,ar),nt=undefined;vr.length>0?(nt=vr.clone().off(),nt.css("strokeWidth",parseInt10(nt.attr("stroke-width"))+kr),e==WDChartParameters.kBulle?nt.attr("fill","transparent"):e==WDChartParameters.kHeatMap&&nt.attr("fill","rgba(255,255,255,0.3)"),n.setId(nt,ar+"-clone"),gt.append(nt)):c<w.m_nRight&&hi[s]>w.m_nTop&&c>w.m_nLeft&&hi[s]<w.m_nBottom&&(nt=n.circle(gt,"mire-point-"+s),yr=clWDUtil.sCouleurHTMLPlusBrillante(ht),o.m_oPaint.setFill(e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap?"transparent":yr),o.m_oPaint.setStroke(ht,f),n.drawCircle(nt,rf[s],hi[s],f+kr,o.m_oPaint))}var t=e==WDChartParameters.kMinMax||e==WDChartParameters.kBarCharts||e==WDChartParameters.kChandelier?o.m_params.m_sBulleBoursier||GRF.BULLE.BOURSIER:e==WDChartParameters.kEntonnoir||e==WDChartParameters.kSecteur||e==WDChartParameters.kDonut||e==WDChartParameters.kHemicycle?o.m_params.m_sBulleSecteur||"[%CATEGORIE%]\n[%VALEUR%]\n[%%%]":e==WDChartParameters.kNuage?o.m_params.m_sBulleNuage||"[%X%]\n[%Y%]\n[%SERIE%]\n[%CATEGORIE%]":e==WDChartParameters.kBulle?o.m_params.m_sBulleBulle||"([%X%];[%Y%]): [%Z%]\n[%CATEGORIE%]":e==WDChartParameters.kHeatMap?o.m_params.m_sBulleHeatmap||"([%X%];[%Y%]): [%Z%]\n[%SERIE%]\n[%CATEGORIE%]":a.m_sBulle||undefined,pr="",wr="",br="",gr="",nu="",tu="",iu="",fi=it?"":er||"",ri=o.m_oGraphe.m_oModele.m_tabSeries[s].m_sLibelle||"",su=(it?"[%VALEUR%]":"")+WDChartUtils.formatValue(dt,a.m_sMasqueValeur,!0)+(it?"[%VALEUR%]":""),hu=h.wbData("wbGrfPieLabelRenderer")?h.wbData("wbGrfPieLabelRenderer").m_strPercentLabel||"":"";if(e==WDChartParameters.kNuage||e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap?((e==WDChartParameters.kBulle||e==WDChartParameters.kHeatMap)&&(br=o.m_oGraphe.m_oModele.m_tabSeries[s+2].getValueAtWithNull(k)),wr=o.m_oGraphe.m_oModele.m_tabSeries[s+1].getValueAtWithNull(k),pr=dt,ri=o.m_oGraphe.m_oModele.m_tabSeries[s].m_sLibelle||""):(e==WDChartParameters.kMinMax||e==WDChartParameters.kBarCharts||e==WDChartParameters.kChandelier)&&(gr=dt,nu=o.m_oGraphe.m_oModele.m_tabSeries[s+1].getValueAtWithNull(k),tu=o.m_oGraphe.m_oModele.m_tabSeries[s+2].getValueAtWithNull(k),iu=o.m_oGraphe.m_oModele.m_tabSeries[s+3].getValueAtWithNull(k)),t===undefined&&(t="",isNaN(parseInt10(fi))&&!clWDUtil.bEstChaineNonVide(fi)||(t+=fi+"\n"),isNaN(parseInt10(ri))&&!clWDUtil.bEstChaineNonVide(ri)||(t+=ri+" = "),t+="[%VALEUR%]"),t=t.replace("[%CATEGORIE%]",fi).replace("[%SERIE%]",ri).replace("[%VALEUR%]",su).replace("[%X%]",pr).replace("[%Y%]",wr).replace("[%Z%]",br).replace("[%%%]",hu).replace("[%MIN%]",gr).replace("[%MAX%]",nu).replace("[%DEBUT%]",tu).replace("[%FIN%]",iu).replace(/\n\n/g,"\n"),d=undefined,it){for(l.length===0&&(st[0]=(o.m_params.m_sBulleEnteteMire||"[%CATEGORIE%]").replace("[%CATEGORIE%]",er),d=new WDPaintCSS,d.addClasse(oi),d.DesactivePointerEvents(),l[0]=d),ei=t.split("[%VALEUR%]"),st.push([$("<span/>").html("&#8226; ").text()].concat(ei.slice(0,ei.length-1))),si=new WDPaintCSS,si.setFill(ht),d=new WDPaintCSS,d.addClasse(oi),d.DesactivePointerEvents(),si.DesactivePointerEvents(),l.push([si,d]),ei.length==3&&(ui=new WDPaintCSS,ui.addClasse(oi),ui.css("font-weight","bold"),ui.DesactivePointerEvents(),l[l.length-1]=l[l.length-1].concat([ui,d]));s+1<o.m_oGraphe.m_oModele.m_tabSeries.length;){if(!1==o.m_oGraphe.m_oVue.bEstSerieMasquee(s+1)&&ii&&o.m_oGraphe.m_oModele.m_tabSeries[s+1].getValueAtWithNull(k)!==IWDChartConstant.NULL_VALUE)break;++s}if(s+1<o.m_oGraphe.m_oModele.m_tabSeries.length)continue;for(or=1,t=st[0],t==""&&(st=st.slice(1),l=l.slice(1),or=0),ci=or;ci<st.length;++ci)t!=""&&(t+="\n"),t+=st[ci].join("")}var li=WDPaintCSS.oGetInfoCSS(oi,t.replace(/\n/g,"<br>"),["width","height","lineHeight","fontSize"]),cu=Math.ceil(parseInt10(li.width)),lu=Math.ceil(parseInt10(li.height)),ru=parseInt10(li.lineHeight);f=1;at=cu+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2+f*2+IWDChartConstant.MARGIN_LEGEND_BORDER;u=lu+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2+f*2+IWDChartConstant.MARGIN_LEGEND_BORDER;ot?(y-=u,(yi&&fr||kt&&lt&&ot)&&(y+=u/2)):(yi&&fr||kt&&lt&&!ot)&&(y-=u/2);wi=y>=w.m_nTop;bi=y+u<=w.m_nBottom;wi&&bi||((ni?bi:!wi)?bf||(yu?y=w.m_nTop:y+=(yi?u/2:u)+(ot?IWDChartConstant.MARGIN_LEGEND_BORDER:0)):(kt&&lt||(pi?wi:!bi))&&(yu?y=w.m_nBottom-u:y-=(yi?u/2:u)+(ot?IWDChartConstant.MARGIN_LEGEND_BORDER:0)));var r,uu=c-w.m_nLeft>=at/(kt?2:1),fu=c+at/(kt?2:1)<=w.m_nRight,sr=!1;!wf&&((dr?!uu:fu)||pf)?r=new WDRect(c+IWDChartConstant.MARGIN_LEGEND_BORDER,y+(ot?0:IWDChartConstant.MARGIN_LEGEND_BORDER),c+at,y+u-(ot?IWDChartConstant.MARGIN_LEGEND_BORDER:0)):(sr=!0,r=new WDRect(c-at,y+(ot?0:IWDChartConstant.MARGIN_LEGEND_BORDER),c-IWDChartConstant.MARGIN_LEGEND_BORDER,y+u-(ot?IWDChartConstant.MARGIN_LEGEND_BORDER:0)));kt&&(sr&&fu?r.setLocation(r.m_nLeft+(at-IWDChartConstant.MARGIN_LEGEND_BORDER)/2+IWDChartConstant.MARGIN_LEGEND_BORDER,r.m_nTop,!0):!sr&&uu&&r.setLocation(r.m_nLeft-(at-IWDChartConstant.MARGIN_LEGEND_BORDER)/2-IWDChartConstant.MARGIN_LEGEND_BORDER,r.m_nTop,!0),lt);vt=df?!1:WDSvgAnimationBulle;eu=new WDRect(r.m_nLeft-f,r.m_nTop-f-(ti?IWDChartConstant.MARGIN_LEGEND_BORDER:0),r.m_nRight+f,r.m_nBottom+f+(ti?IWDChartConstant.MARGIN_LEGEND_BORDER:0));gf&&(ki=n.clipRect(eu,"clip-bulle",vt));di=undefined;!a.m_bLegendeBordArrondi||(di=5);o.m_oPaint.setStroke(it?a.m_sCouleurLegende:ht,f);o.m_oPaint.setFillOpacity255(204);o.m_oPaint.setFill(a.m_sCouleurLegendeFond||"#FFFFFF");o.m_oPaint.DesactivePointerEvents();ou=it||!ct?"mire-bulle":"mire-bulle-"+s;hr=o.__bDessineBulle(n,gi,ou,r,o.m_oPaint,di,di,ti?b.x:undefined,ti?b.y:undefined,vt);o.m_oPaint.addClasse(oi);o.m_oPaint.DesactivePointerEvents();cr=n.text(gi,it||!ct?"legende-texte":"legende-texte-"+s);!hr&&vt&&(vt.prototype.ArreteEtVideAnimations(cr),ki&&vt.prototype.ArreteEtVideAnimations(ki));n.drawText(cr,it?st:t.split("\n"),ru-(ru-parseInt10(li.fontSize))/2,r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*.5,IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,it?[o.m_oPaint].concat(l):o.m_oPaint,hr?vt:!1);fr=!1;ot||(y+=u);ki&&n.restoreClip()}}})}}}}};WDPaintCSS.imgNormal=1;WDPaintCSS.imgCentre=2;WDPaintCSS.imgEtire=3;WDPaintCSS.imgRepete=4;WDPaintCSS.imgHomothetique=5;WDPaintCSS.imgHomothetiqueCentre=6;WDPaintCSS.imgHomothetiqueLarge=7;WDPaintCSS.imgHomothetiqueCentreLarge=8;WDPaintCSS.imgAdapte=9;WDPaintCSS.imgAdapteCentre=10;WDPaintCSS.prototype=new JSONPOO;WDPaintCSS.prototype.constructor=WDPaintCSS;WDPaintCSS.prototype.setStyle=function(n){this.m_nStyle=n};WDPaintCSS.prototype.raz=function(){this.m_oStyle={};this.m_sClasse=undefined;this.m_stRadialGradient=undefined;this.m_stLinearGradient=undefined};WDPaintCSS.prototype.setStroke=function(n,t,i){this.m_oStyle.stroke=n;t!==undefined&&(this.m_oStyle.strokeWidth=t);i!==undefined&&(this.m_oStyle.strokeOpacity=i)};WDPaintCSS.prototype.setStrokeOption=function(n,t){this.m_oStyle["stroke"+n]=t};WDPaintCSS.prototype.setStrokeLineJoin=function(n){this.m_oStyle.strokeLinejoin=n};WDPaintCSS.prototype.setFill=function(n){this.m_oStyle.fill=n};WDPaintCSS.prototype.setFillOpacity255=function(n){this.m_oStyle.fillOpacity=n/255};WDPaintCSS.prototype.addClasse=function(n){this.m_sClasse===undefined?this.m_sClasse="":this.m_sClasse+=" ";this.m_sClasse+=n};WDPaintCSS.prototype.setCouleurFond=function(n){this.m_oStyle.backgroundColor=n};WDPaintCSS.prototype.DesactivePointerEvents=function(){this.m_oStyle.pointerEvents="none"};WDPaintCSS.prototype.setImageFond=function(n,t,i,r){this.m_oStyle.backgroundImage="url("+clWDUtil.sGetCheminImage(n)+")";this.m_oStyle.backgroundRepeat="no-repeat";switch(t){case WDPaintCSS.imgCentre:this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgEtire:this.m_oStyle.backgroundSize="100% 100%";break;case WDPaintCSS.imgRepete:this.m_oStyle.backgroundRepeat="repeat";break;case WDPaintCSS.imgHomothetique:this.m_oStyle.backgroundSize="contain";break;case WDPaintCSS.imgHomothetiqueCentre:this.m_oStyle.backgroundSize="contain";this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgHomothetiqueLarge:this.m_oStyle.backgroundSize="cover";break;case WDPaintCSS.imgHomothetiqueCentreLarge:this.m_oStyle.backgroundSize="cover";this.m_oStyle.backgroundPosition="center center";break;case WDPaintCSS.imgAdapte:case WDPaintCSS.imgAdapteCentre:var u=$("<img>").attr("src",clWDUtil.sGetCheminImage(n));u[0].width>i||u[0].height>r?this.setImageFond(n,t==WDPaintCSS.imgAdapteCentre?WDPaintCSS.imgHomothetiqueCentre:WDPaintCSS.imgHomothetique,i,r):this.setImageFond(n,WDPaintCSS.imgNormal,i,r)}};WDPaintCSS.prototype.css=function(n,t){if(clWDUtil.isObject(n))for(var i in n)this.css(i,n[i]);else this.m_oStyle[n]=t};WDPaintCSS.prototype.css3=function(n,t){var i=this,r=n,u=t;return["-webkit-","-moz-","-ms-",""].forEach(function(n){i.css(n+r,u)}),this};WDPaintCSS.css3=function(n,t,i){n[0]===undefined&&(n=$(n));var r=n,u=t,f=i;return["-webkit-","-moz-","-ms-",""].forEach(function(n){r.css(n+u,f)}),n};WDPaintCSS.__gnGradientUniqueId=0;WDPaintCSS.getGradientUniqueId=function(){return++WDPaintCSS.__gnGradientUniqueId};WDPaintCSS.prototype._ajouteElementGradient=function(n,t,i,r){var c="wb-"+i+"-gradient-"+t.attr("id"),u=n.tag(n.m_domDefsSVG,c,i+"Gradient"),l=u.wbData("wbGrfGradientData"),h,e,f,o,s;if(l&&JSON.stringify(l)==JSON.stringify(r))return this.setGradientExistant(n,t,u),u;for(u.wbData("wbGrfGradientData",r),u.empty(),r.gradientUnits!==undefined&&n.attrNS(u,null,"gradientUnits",r.gradientUnits),r.spreadMethod!==undefined&&n.attrNS(u,null,"spreadMethod",r.spreadMethod),h=Object.getOwnPropertyNames(r.stop).sort(function(n,t){return parseFloat(n)<parseFloat(t)?-1:1}),e=0;e<h.length;++e)f=h[e],o=n.tag(u,c+"stop"+u.children().length,"stop"),n.attrNS(o,null,"offset",f+"%"),n.attrNS(o,null,"stop-color",r.stop[f].color),n.attrNS(o,null,"stop-opacity",r.stop[f].opacity);this.setGradientExistant(n,t,u);for(s in r)s!="stop"&&n.attrNS(u,null,s,r[s]);return u};WDPaintCSS.prototype.ecritDegrade=function(n,t){return this.m_stRadialGradient!==undefined?this._ajouteElementGradient(n,t,"radial",this.m_stRadialGradient):this.m_stLinearGradient!==undefined?this._ajouteElementGradient(n,t,"linear",this.m_stLinearGradient):void 0};WDPaintCSS.prototype.applyStyle=function(n,t){var r;this.ecritDegrade(n,t);this.m_sClasse!==undefined&&n.addClass(t,this.m_sClasse);var u={},f=!1,i=this;["stroke","fill","fillOpacity","strokeWidth","strokeOpacity","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit"].forEach(function(n,t){if(typeof i.m_oStyle[n]!="undefined"){var r=n;t>1&&(r=t<3?"fill-"+r.substr(4,1).toLowerCase()+r.substr(5):"stroke-"+r.substr(6,1).toLowerCase()+r.substr(7));f=!0;u[r]=i.m_oStyle[n];i.m_oStyle[n]=undefined}});f&&t.attr(u);t.css(this.m_oStyle);r="background-image";i.m_oStyle[r]!==undefined&&(t.attr("style",t.attr("style")+r+":"+i.m_oStyle[r]+";"),i.m_oStyle[r]=undefined);n.m_tabClipActif.length>0&&t.attr("clip-path","url(#"+n.getId(n.m_tabClipActif[n.m_tabClipActif.length-1])+")");this.raz()};WDPaintCSS.prototype.setGradientExistant=function(n,t,i){if(this.m_oStyle.fill="url(#"+i.attr("id")+")",t){if(t.wbData("wbGrfGradientId")){var r=n.findFromId(n.m_domDefsSVG,t.wbData("wbGrfGradientId"));r&&r.length>0&&(r.unbind().removeData().remove(),r=undefined)}t.wbData("wbGrfGradientId",i.attr("id"))}};WDPaintCSS.prototype.setRadialGradient=function(n,t,i,r,u,f,e,o,s){e===undefined&&(e=1);o===undefined&&(o=1);this.m_stRadialGradient={r:"100%",cx:s?"50%":"0%",cy:s?"50%":"0%",spreadMethod:f,stop:{0:{color:r,opacity:e},100:{color:u,opacity:o}}}};WDPaintCSS.prototype.setLinearGradient=function(n,t,i,r,u,f,e){u===undefined&&(u=1);f===undefined&&(f=1);this.m_stLinearGradient={x1:0,y1:0,x2:r===!0?0:1,y2:r===!0?1:0,spreadMethod:i,stop:{}};this.m_stLinearGradient.stop=e===!0?{0:{color:t,opacity:f},50:{color:n,opacity:u},100:{color:t,opacity:f}}:{0:{color:n,opacity:u},100:{color:t,opacity:f}}};WDPaintCSS.nGetLineHeight=function(n){return n<24?n+4:Math.round(n*1.2)};WDPaintCSS.jqTrouveCSS={};WDPaintCSS.oCacheFontSize={};WDPaintCSS.oGetInfoCSS=function(n,t,i,r,u){var e,a,o,c,s,h,f,l,v;if(r===undefined&&(r=""),e=clWDUtil.isObject(n)?n.m_sClasse:n,e=e||"aucuneClasse",WDPaintCSS.oCache||(WDPaintCSS.oCache={}),n&&(h=WDPaintCSS.oCacheFontSize[e])){if(i==="fontSize")return{fontSize:h+"px"};if(i==="lineHeight")return{lineHeight:WDPaintCSS.nGetLineHeight(h)+"px"}}if(a=JSON.stringify(arguments),WDPaintCSS.oCache[a])return WDPaintCSS.oCache[a];if(o=WDPaintCSS.jqTrouveCSS[e],o||(o=WDPaintCSS.jqTrouveCSS[e]=$("<span class='grfWDPaintCSSoGetInfoCSS "+e+"'/>"),$(document.body).append(o)),c=o[0],r&&(c.innerHTML="<span style='"+r+"'><\/span>",c=c.firstChild),u?c.innerText=t:c.innerHTML=t,s=window.getComputedStyle?window.getComputedStyle(o[0]):o[0].currentStyle,!n||r||WDPaintCSS.oCacheFontSize[e]||(h=s.fontSize,/px/.test(h)&&(WDPaintCSS.oCacheFontSize[e]=parseInt10(h))),f={},i===!0)f=_clone(s,f);else if(clWDUtil.isObject(i))clWDUtil.bForEachIn(i,function(n){return f[n]=s[n],!0});else if(clWDUtil.isArray(i))for(l=0;l<i.length;++l)f[i[l]]=s[i[l]];else i!==undefined&&(f[i]=s[i]);return(i===!0||f.hasOwnProperty("width")||f.hasOwnProperty("height"))&&(v=o[0].getBoundingClientRect(),f.height=v.height,f.width=v.width),(i===!0||f.hasOwnProperty("lineHeight"))&&f.lineHeight&&f.lineHeight.indexOf("px")==-1&&(f.lineHeight=WDPaintCSS.nGetLineHeight(parseInt10(s.fontSize)),f.hasOwnProperty("height")&&(f.height=Math.max(f.height,f.lineHeight))),WDPaintCSS.oCache[a]=f,f};WDPictureSVG.prototype.constructor=WDPictureSVG;WDPictureSVG.prototype.svgns="http://www.w3.org/2000/svg";WDPictureSVG.prototype.smilanimns="http://www.w3.org/2001/smil-animation";WDPictureSVG.prototype.smil2ns="http://www.w3.org/2001/SMIL20";WDPictureSVG.prototype.smil21ns="http://www.w3.org/2005/SMIL21";WDPictureSVG.prototype.smil3ns="http://www.w3.org/ns/SMIL30";WDPictureSVG.prototype.timesheetns="http://www.w3.org/2007/07/SMIL30/Timesheets";WDPictureSVG.prototype.xlinkns="http://www.w3.org/1999/xlink";WDPictureSVG.prototype.PlaceDansLaPage=function(n){var t=$(n.m_oHoteImage);t.css("display","none");t[0].nextSibling!==undefined?t[0].parentNode.insertBefore(this.m_domBaliseSVG[0],t[0].nextSibling):t[0].appendChild(this.m_domBaliseSVG[0]);t.parent().is("a")&&t.parent().css("text-decoration","none")};WDPictureSVG.prototype.Raz=function(){this.m_domBaliseSVG!==undefined?(this.m_domBaliseSVG.empty(),this.m_domBaliseSVG.wbData("wbGrfNbDessins",0),this.m_domDefsSVG=this.tag(this.m_domBaliseSVG,"defs","defs")):this.m_domBaliseSVG=this.tag("svg");this.m_tabId={}};WDPictureSVG.prototype.OnRecalculAncrageIE=function(){this.m_bAncrageLargeur&&this.m_domBaliseSVG.css("width","100%");this.m_bAncrageHauteur&&this.m_domBaliseSVG.css("height","100%")};WDPictureSVG.prototype.Init=function(n){var t,o,f,r,e,u,i;return(this.Raz(),t=$(n.m_oHoteImage),o=n.m_oHoteImage&&n.m_oHoteImage.parentNode&&clWDUtil.bEstDisplay(n.m_oHoteImage.parentNode,document),!o)?(t.css("opacity",0),!1):(t.css("opacity",""),this.m_oGraphe=n,f=n.m_oHoteImage.width,r=n.m_oHoteImage.height,t.css("display","block"),t.data("width")&&(f=t.data("width"),r=t.data("height")),t.hasClass("h100")&&t.css("height","100%"),e=(t.attr("style")||"").replace(/ /g,""),this.m_bAncrageLargeur=e.indexOf("width:100%")>-1||t.attr("width")=="100%",this.m_bAncrageHauteur=e.indexOf("height:100%")>-1||t.attr("height")=="100%",(this.m_bAncrageLargeur||this.m_bAncrageHauteur)&&(this.m_bAncrageLargeur&&(t.add(this.m_domBaliseSVG).css("position","absolute"),t.data("width",f=t.parent().width()),t.add(this.m_domBaliseSVG).css("position","")),this.m_bAncrageHauteur&&(t.add(this.m_domBaliseSVG).css("position","absolute"),u=t.parent().height(),t.add(this.m_domBaliseSVG).css("position",""),u==0?(u=parseInt10(t.attr("data-height"))/parseInt10(t.attr("data-width"))*parseInt10(t.data("width")),this.m_bAncrageHauteur=!1,r=u==0?r:u,t.css("height",r)):r=u,t.data("height",r)),this.m_nTimerRedim=null,this.m_bRedimEnCours=!1,i=this,clWDUtil.AttacheOnScrollResize(function(n,r){if(!r&&!i.m_bRedimEnCours&&(i.m_oGraphe.m_oParametres.m_bInteractif||i.m_oGraphe.m_tabEtat.INT)){if(i.m_nTimerRedim==null){if(!clWDUtil.bEstDisplay(i.m_domBaliseSVG[0],document))return}else clearTimeout(i.m_nTimerRedim);i.m_nTimerRedim=setTimeout(function(){var f,r,n,u;try{if(i.m_bRedimEnCours=!0,f=i.m_bAncrageHauteur&&t.data("height")<10,r={width:t.data("width"),height:t.data("height")},i.m_bAncrageLargeur&&(t.add(i.m_domBaliseSVG).css("position","absolute"),t.data("width",t.parent().width()),t.add(i.m_domBaliseSVG).css("position","")),i.m_bAncrageHauteur&&(t.add(i.m_domBaliseSVG).css("position","absolute"),n=t.parent().height(),n==0&&(n=parseInt10(t.attr("data-height"))/parseInt10(t.attr("data-width"))*parseInt10(t.data("width")),i.m_bAncrageHauteur=!1,t.css("height",n)),t.data("height",n),t.add(i.m_domBaliseSVG).css("position","")),u={width:t.data("width"),height:t.data("height")},r.width==u.width&&r.height==u.height)return;if(i.Init(i.m_oGraphe),i.m_oGraphe.relanceInitialisation(),f)try{i.m_oGraphe.m_tabEtat.INT=!1;i.m_oGraphe.m_oVue.ExecuteCommande(i.m_oGraphe);i.m_oGraphe.m_tabEtat.INT=!0;i.m_oGraphe.m_oVue.ExecuteCommande(i.m_oGraphe)}catch(e){}finally{i.m_oGraphe.m_tabEtat.INT=!0}}catch(e){}finally{i.m_oGraphe.m_tabEtat.INT=!0;i.m_bRedimEnCours=!1;i.m_nTimerRedim=null}},50)}})),this.m_domBaliseSVG.attr("version","1.1").attr("xmlns",this.svgns).attr("title",t.attr("title")||"").css({width:this.m_bAncrageLargeur?"100%":t.css("width"),height:this.m_bAncrageHauteur?"100%":t.css("height"),lineHeight:"normal"}).wbData("wbGrfAnimDuree",n.m_oModele.m_oParametres.m_nDureeAnimation),bIEAvec11&&this.m_bAncrageLargeur&&this.m_domBaliseSVG.css({width:f,height:r}),this.attrNS(this.m_domBaliseSVG,null,"viewBox","0 0 "+f+" "+r),!0)};WDPictureSVG.prototype.SetImageFond=function(n){n.applyStyle(this,this.m_domBaliseSVG)};WDPictureSVG.prototype.insert=function(n,t){n===undefined&&(n=this.m_domBaliseSVG);var i=n.children().first();return i.length>0?n[0].insertBefore(t[0],i[0]):this.append(n,t)};WDPictureSVG.prototype.insertAfter=function(n,t,i){return n===undefined&&(n=this.m_domBaliseSVG),i!==undefined&&i[0]!==undefined&&i[0].nextSibling!==undefined?n[0].insertBefore(t[0],i[0].nextSibling):this.append(n,t)};WDPictureSVG.prototype.append=function(n,t){if(n!==undefined||(n=this.m_domBaliseSVG,n!==undefined))return n[0].appendChild(t[0])};WDPictureSVG.prototype.SetAntiAliasing=function(n,t){t===undefined&&(t=this.m_domBaliseSVG);t.attr("shape-rendering",n?"auto":"crispEdges")};WDPictureSVG.prototype.path=function(n,t){return this.tag(n,t,"path")};WDPictureSVG.prototype.drawPath=function(n,t,i,r){var u=clWDUtil.isArray(t)||clWDUtil.bEstChaineNonVide(t)?{d:t}:t;return clWDUtil.isArray(u.d)&&(u.d=u.d.join(" ")),r===undefined&&(r=WDSvgAnimation),this.bDrawAvecAnimation(r,n,u)||(n.attr("d",u.d),r&&r.afffiche(n),n.wbData("wbGrfDrawInfos",u)),n.attr("fill")===undefined&&n.attr("fill","none"),i&&i.applyStyle(this,n),n};WDPictureSVG.prototype.drawPathFactory=function(n,t,i,r){var u=this.drawPath(n,i,r);return $.extend(u,t),n.wbData("wbGrfDrawPath",t),u};WDPictureSVG.prototype.tag=function(n,t,i){var r=n,f=t,e=i,u;return(arguments.length===2?(e=f,r=undefined,f=undefined):arguments.length===1?(e=r,r=undefined,f=undefined):arguments.length!==3||clWDUtil.isObject(r)||f||!e||(f=r,r=undefined),r===undefined&&(r=this.m_domBaliseSVG),u=r?this.findFromId(r,f):undefined,u&&u.length===1)?u:(u=$(document.createElementNS(this.svgns,e)),this.setId(u,f),this.append(r,u),u)};WDPictureSVG.prototype.getId=function(n){return n.attr("id")};WDPictureSVG.prototype.setId=function(n,t){var i=this.sConstruitId(t),r;n.attr("id",i);this.m_tabId[i]=n;r=this;n.bind("remove",function(){var n=this.closest?this.closest("svg"):$(this).closest("svg")[0];n&&!n.wbGrfClone&&(r.m_tabId[i]=undefined)})};WDPictureSVG.prototype.sConstruitId=function(n){return this.m_Id+"-"+(n||"svg")};WDPictureSVG.prototype.find=function(n,t){var i=this.m_tabId[this.getId(t)]||[];return i};WDPictureSVG.prototype.findFromId=function(n,t,i){var r=this.m_tabId[i?t:this.sConstruitId(t)]||[];return r};WDPictureSVG.prototype.drawContenu=function(n,t){var i=n.contents(),r;return i&&i[0]&&i[0].nodeType==3?(i[0].nodeValue=t,i):(r=$(document.createTextNode(t)),n.append(r),r)};WDPictureSVG.prototype.attrNS=function(n,t,i,r){return n[0]!==undefined&&(n=n[0]),n.setAttributeNS(t,i,r)};WDPictureSVG.bDessinPossible=function(){return!!document.createElementNS&&!!document.createElementNS(WDPictureSVG.prototype.svgns,"svg").createSVGRect};WDPictureSVG.prototype.g=function(n,t){return this.tag(n,t,"g").attr("role","presentation")};WDPictureSVG.prototype.arc=function(n,t){return this.path(n,t)};WDPictureSVG.prototype.line=function(n,t){return this.tag(n,t,"line")};WDPictureSVG.prototype.bDrawAvecAnimation=function(n,t,i,r,u){if(n===!1)return!1;var f=this.m_domBaliseSVG.wbData("wbGrfAnimDuree")===0&&this.m_domBaliseSVG.wbData("wbGrfModeAffichage")===WDChartView.ms_nDessin1erAffichage;return!f&&(n.bIgnorePendantAnimation()||!this.bPendantAnimation())&&t.wbData("wbGrfDrawInfos")!==undefined?(new n.prototype.constructor(this.m_oGraphe,this,t,t.wbData("wbGrfDrawInfos"),i,r,u).run(),!0):!1};WDPictureSVG.prototype.drawLine=function(n,t,i,r,u,f,e){var o={x1:t,y1:i,x2:r,y2:u};return e===undefined&&(e=WDSvgAnimation),this.bDrawAvecAnimation(e,n,o)||(this.attrNS(n,null,"x1",t),this.attrNS(n,null,"y1",i),this.attrNS(n,null,"x2",r),this.attrNS(n,null,"y2",u),e&&e.afffiche(n),n.wbData("wbGrfDrawInfos",o)),f.applyStyle(this,n),n};WDPictureSVG.prototype.rect=function(n,t){return this.tag(n,t,"rect")};WDSvgAnimation.prototype=new WDChartAnimation;WDSvgAnimation.prototype.constructor=WDSvgAnimation;WDSvgAnimation.prototype.ArreteEtVideAnimations=function(n){n||(n=this.m_domBaliseAnim);n.stop(this.queue,!0);var t=this;n.children().each(function(){t.ArreteEtVideAnimations($(this))})};WDSvgAnimation.prototype.start=function(){var n=WDChartAnimation.getAnim(this);clWDUtil.bForEachIn(n.m_oAttributs,function(t,i){return i!==undefined&&n.m_oAttributsAvant[t]===undefined&&(n.m_oAttributsAvant[t]=n.m_domBalise.attr(t)),!0})};WDSvgAnimation.prototype.step=function(n){var t=WDChartAnimation.getAnim(this),i;t&&(t.m_dNow=n,t.m_dNow!==0)&&(i={},clWDUtil.bForEachIn(t.m_oAttributs,function(r,u){var f,s,h;if(u!==undefined){if(r.indexOf("data-")===0)return i[r]||(i[r]=u),!0;if(t.m_dNow!==1||clWDUtil.isObject(u))if(r.indexOf("color")>-1||r=="fill"||r=="stroke"){var e=clWDUtil.tabHTML2TSLA(t.m_oAttributsAvant[r]||u),o=clWDUtil.tabHTML2TSLA(u),a=[t.tween(e[0],o[0]),t.tween(e[1],o[1]),t.tween(e[2],o[2]),t.tween(e[3],o[3])];i[r]=clWDUtil.sTSLA2HTML(a)}else if(r==="d")oPath=t.tweenPath(t.m_oAttributsAvant[r],u,n),clWDUtil.isObject(oPath)?clWDUtil.bForEachIn(oPath,function(n){return i[n]=oPath[n],!0}):i[r]=(oPath||"")+"";else if(r==="dx"||r==="x"||r==="width")i[r]=t.tweenX(t.m_oAttributsAvant[r],u,n);else if(r==="dy"||r==="y"||r==="height")i[r]=t.tweenY(t.m_oAttributsAvant[r],u,n);else if(r==="points"){var c="",l=u.trim().split(" "),v=t.m_oAttributsAvant[r].trim().split(" ");for(f=0;f<l.length;++f)s=l[f].split(","),h=v[f].split(","),c+=" "+t.tweenX(h[0],s[0],n)+","+t.tweenY(h[1],s[1],n);i[r]=c.trim()}else i[r]=t.tween(t.m_oAttributsAvant[r],u,n);else i[r]=u;t.m_oPicture.attrNS(t.m_domBalise,null,r,i[r])}return!0}),t.m_domBalise.wbData("wbGrfDrawInfos",i))};WDSvgAnimation.prototype.tweenPath=function(n,t,i){var u=clWDUtil.isArray(n)?n:n.split(" "),e=clWDUtil.isArray(t)?t:t.split(" "),r,s,h;if(u.length!==e.length)return u.join(" ");var f=[],c=!1,o=0;for(r=0;r<u.length;++r)s=parseInt10(u[r]),h=parseInt10(e[r]),isNaN(s)||isNaN(h)?(f[r]=u[r],c=f[r]=="M"||f[r]=="L",o=0):(f[r]=o%2==0?this.tweenX(u[r],e[r],i):this.tweenY(u[r],e[r],i),++o);return{d:f.join(" ")}};WDSvgAnimation.prototype.done=function(){var n=WDChartAnimation.getAnim(this);n&&n.m_fFinAnimation&&n.m_fFinAnimation.apply(arguments)};WDSvgAnimation.afffiche=function(){};WDSvgAnimation.bIgnorePendantAnimation=function(){return!1};WDSvgAnimationGridLine.prototype=new WDSvgAnimation;WDSvgAnimationGridLine.prototype.constructor=WDSvgAnimationGridLine;WDSvgAnimationGridLine.prototype.step=function(n){WDSvgAnimation.prototype.step.apply(this,arguments);$(this).css("opacity",n)};WDSvgAnimationGridLine.afffiche=function(n){n.css("opacity",0).fadeTo(800,1)};WDSvgAnimationGridLine.bIgnorePendantAnimation=function(){return!0};WDSvgAnimationBulle.prototype=new WDSvgAnimation;WDSvgAnimationBulle.prototype.constructor=WDSvgAnimationBulle;WDSvgAnimationBulle.prototype.step=function(){WDSvgAnimation.prototype.step.apply(this,arguments)};WDSvgAnimationBulle.prototype.ArreteEtVideAnimations=function(){WDSvgAnimation.prototype.ArreteEtVideAnimations.apply(this,arguments)};WDSvgAnimationBulle.prototype.bAnimationBullePathPossible=function(n,t){var i=t.wbData("wbGrfDrawInfos"),r;return i?(r=clWDUtil.isArray(i.d)?i.d:i.d.split(" "),!r||r.length!=n.d.length)?!1:!0:!1};WDSvgAnimationBulle.prototype.tweenX=function(n,t,i){if(WDSvgAnimationBulle.gbEase===!0)return WDSvgAnimation.prototype.tweenX.apply(this,arguments);var r=new clWDUtil.WDBezier(.25,.25,.225,.855);return this.tween(n,t,r.dCalcule(i,this.duration))};WDSvgAnimationBulle.prototype.tweenY=function(){return WDSvgAnimation.prototype.tweenY.apply(this,arguments)};WDSvgAnimationBulle.prototype.tweenPath=function(n,t,i){var u=this.m_oAttributsAvant["data-arguments"],f,o;if(!u||!clWDUtil.isArray(u))return WDSvgAnimation.prototype.tweenPath.apply(this,arguments);if(f=clWDUtil.isArray(n)?n:n.split(" "),o=clWDUtil.isArray(t)?t:t.split(" "),f.length!==o.length)return f.join(" ");var r=this.m_oAttributs["data-arguments"],s=this.tweenRect(u[0],r[0]),e=WDChartRenderer.prototype.__oPathBulle(s,this.tween(u[1],r[1]),this.tween(u[2],r[2]),this.tween(u[3],r[3]),this.tweenX(u[0].m_nRight,r[0].m_nRight,i)-(r[0].m_nRight-r[4]),this.tweenY(u[0].m_nBottom,r[0].m_nBottom,i)-(r[5]-r[0].m_nBottom));return e.d=e.d.join(" "),e};WDSvgAnimationBulle.afffiche=function(n){return WDSvgAnimation.afffiche(n)};WDSvgAnimationBulle.bIgnorePendantAnimation=function(){return WDSvgAnimation.bIgnorePendantAnimation()};WDSvgAnimationLegende.prototype=new WDSvgAnimation;WDSvgAnimationLegende.prototype.constructor=WDSvgAnimationLegende;WDSvgAnimationLegende.afffiche=function(n){return WDSvgAnimationGridLine.afffiche(n)};WDSvgAnimationLegende.bIgnorePendantAnimation=function(){return WDSvgAnimationGridLine.bIgnorePendantAnimation()};WDPictureSVG.prototype.drawRect=function(n,t,i,r,u,f){var e={x:t.m_nLeft,y:t.m_nTop,width:WDRect.getWidth(t),height:WDRect.getHeight(t),rx:r,ry:u};return f===undefined&&(f=WDSvgAnimation),this.bDrawAvecAnimation(f,n,e)||(this.attrNS(n,null,"x",e.x),this.attrNS(n,null,"y",e.y),this.attrNS(n,null,"width",e.width),this.attrNS(n,null,"height",e.height),r!==undefined&&this.attrNS(n,null,"rx",r),u!==undefined&&this.attrNS(n,null,"ry",u),f&&f.afffiche(n),n.wbData("wbGrfDrawInfos",e)),i&&(i.m_oStyle.fill===undefined&&i.setFill("none"),i.applyStyle(this,n)),n};WDPictureSVG.prototype.text=function(n,t){return this.tag(n,t,"text")};WDPictureSVG.prototype.tspan=function(n,t){return this.tag(n,t,"tspan")};WDPictureSVG.prototype.circle=function(n,t){return this.tag(n,t,"circle")};WDPictureSVG.prototype.polygon=function(n,t){return this.tag(n,t,"polygon")};WDPictureSVG.prototype.drawPolygon=function(n,t,i,r){var u={points:t.join(" ")};return r===undefined&&(r=WDSvgAnimation),this.bDrawAvecAnimation(r,n,u)||(this.attrNS(n,null,"points",t.join(" ")),r&&r.afffiche(n),n.wbData("wbGrfDrawInfos",u)),i&&i.applyStyle(this,n),n};WDPictureSVG.prototype.drawCircle=function(n,t,i,r,u){return this.attrNS(n,null,"cx",t),this.attrNS(n,null,"cy",i),this.attrNS(n,null,"r",r),u.applyStyle(this,n),n};WDPictureSVG.prototype.drawTextVertically=function(n,t,i,r,u,f,e,o){return this.rotate(n,270,r,u,!0,!1),this.drawText(n,t,i,r,u,f,e,o)};WDPictureSVG.prototype.applyStyleAvecHackColor=function(n,t){var i,r;t!=undefined&&t.m_oStyle.fill==undefined&&(this.m_tabCache[t.m_sClasse]||(WDPictureSVG.applyStyleAvecHackColorDejaAppele?i=$(document.getElementById("wbGrfWDPictureSVG")):(i=$('<span style="position:absolute;visibility:hidden" id="wbGrfWDPictureSVG"><\/span>'),$("body").append(i)),i.attr("class",t.m_sClasse),r=window.getComputedStyle(i[0]),this.m_tabCache[t.m_sClasse]=r.color,WDPictureSVG.applyStyleAvecHackColorDejaAppele=!0),t.setFill(this.m_tabCache[t.m_sClasse]));t.applyStyle(this,n)};WDPictureSVG.prototype.bPendantAnimation=function(){return this.m_domBaliseSVG.wbData("wbGrfModeAffichage")==WDChartView.ms_nDessinAnimation};WDPictureSVG.prototype.addClass=function(n,t){this.removeClass(n,t);n.attr("class",((n.attr("class")||"").trim()+" "+t).trim())};WDPictureSVG.prototype.removeClass=function(n,t){n.attr("class",(n.attr("class")||"").replace(t,"").trim())};WDPictureSVG.prototype.drawText=function(n,t,i,r,u,f,e,o){var h={x:r,y:u+i},v=clWDUtil.isArray(t)?t:[t],a=[t,r,u],s,c,l;return n.wbData("wbGrfCacheDrawText")==a?n:(n.wbData("wbGrfCacheDrawText",a),s=this,n.find("*").each(function(){this.wbGrfGC=!0}),this.attrNS(n,null,"text-anchor",f==IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE?"middle":f==IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE?"start":"end"),o===undefined&&(o=WDSvgAnimation),clWDUtil.isArray(e)?(c=e[0],e=e.slice(1)):c=e,this.bDrawAvecAnimation(o,n,h)||(this.attrNS(n,null,"x",h.x),this.attrNS(n,null,"y",h.y),o&&o.afffiche(n),n.wbData("wbGrfDrawInfos",h)),l=0,clWDUtil.bForEachIn(v,function(t,r){var c=undefined,f,a,u,v;for(!clWDUtil.isArray(r)&&clWDUtil.bEstChaineNonVide(r)&&r.indexOf("\n")&&(c=r.split("\n")),f=r,a=0;a<(c?c.length:1);++a)c&&(f=c[a]),u=s.tspan(n,s.getId(n)+"-texte-ligne-"+ ++l),u[0].wbGrfGC=undefined,(t>0||a>0)&&(s.attrNS(u,null,"dy",i),u.wbData("wbGrfDrawInfos",n.wbData("wbGrfDrawInfos"))),v={x:h.x},s.bDrawAvecAnimation(o,u,v)||(s.attrNS(u,null,"x",h.x),u.wbData("wbGrfDrawInfos",v),o&&o.afffiche(u)),clWDUtil.isArray(f)&&f.length>1?clWDUtil.bForEachIn(f,function(i,r){var f,o;return i>0?(o=s.tspan(n,"texte-ligne-"+l+"-sous-"+i),s.attrNS(o,null,"dx",0),f=o):f=u,f[0].wbGrfGC=undefined,s.drawContenu(f,r),clWDUtil.isArray(e)&&clWDUtil.isArray(e[t])&&clWDUtil.isObject(e[t][i])&&s.applyStyleAvecHackColor(f,e[t][i]),!0}):(s.drawContenu(u,f),clWDUtil.isArray(e)&&clWDUtil.isObject(e[t])?s.applyStyleAvecHackColor(u,e[t]):s.applyStyleAvecHackColor(u,new WDPaintCSS(e)));return!0}),c&&this.applyStyleAvecHackColor(n,c),n.find("*").filter(function(){return this.wbGrfGC}).empty(),n)};WDPictureSVG.prototype.translate=function(n,t,i,r,u){var f=(""+(t||"")).split(",");return f.length==2&&(t=f[0],i=f[1]),r||bIEAvec11?n.attr("transform",(!u?"":(n.attr("transform")||"")+" ")+"translate("+t+","+i+")"):n.css("transform",(!u?"":(n.css("transform")||"")+" ")+"translateX("+t+") translateY("+i+")"),n.wbData("wbGrfDrawTranslate",arguments),n};WDPictureSVG.prototype.scale=function(n,t,i,r,u){var f=(""+(t||"")).split(",");return f.length==2&&(t=f[0],i=f[1]),r||bIEAvec11?n.attr("transform",(!u?"":(n.attr("transform")||"")+" ")+"scale("+t+","+i+")"):n.css("transform",(!u?"":(n.css("transform")||"")+" ")+"scale("+t+","+i+")"),n.wbData("wbGrfDrawScale",arguments),n};WDPictureSVG.prototype.rotate=function(n,t,i,r,u,f){var e=(""+(t||"")).split(","),o;return e.length==3&&(t=e[0],i=e[1],r=e[2]),u||bIEAvec11?(o="rotate("+t,i!==undefined&&r!=undefined&&(o+=","+i+","+r),o+=")",n.attr("transform",(!f?"":(n.attr("transform")||"")+" ")+o)):(n.css("transform",(!f?"":(n.css("transform")||"")+" ")+"rotateZ("+(""+t).replace("deg","")+"deg)"),n.css("transform-origin",(typeof i=="string"?i:i+"px")+" "+(typeof r=="string"?r:r+"px"))),n.wbData("wbGrfDrawRotate",arguments),n};WDPictureSVG.prototype.bulle=function(n,t){return this.tag(n,t,"title")};WDPictureSVG.prototype.drawBulle=function(n,t,i){return this.drawContenu(n,t),i.applyStyle(this,n),n};WDPictureSVG.prototype.__tabPathVersArc=function(n,t,i,r,u){var s=Number(u.start).toRad(),f=u.rx||i||r,e=u.ry||f,h=Number(Math.abs(u.start+u.sweep)%360).toRad()-.001,o=u.rDonut||0,l=u.open,a=Math.cos(s),v=Math.sin(s),y=Math.cos(h),p=Math.sin(h),w=h-s<Math.PI?0:1,c=o*(e/f);return["M",n+f*a,t+e*v,"A",f,e,0,w,1,n+f*y,t+e*p,l?"M":"L",n+o*y,t+c*p,"A",o,c,0,w,0,n+o*a,t+c*v,l?"":"Z"]};WDPictureSVG.prototype.drawArc=function(n,t,i){var r=this.__tabPathVersArc(Math.round(t.x),Math.round(t.y),t.width,t.height,t.options);return this.drawPathFactory(n,t,r,i),n};WDPictureSVG.prototype.draw=function(n){this.m_bDessinDirectementDansLaPage||this.PlaceDansLaPage(n);this.removeGradient()};WDPictureSVG.prototype.removeGradient=function(){this._removeGradient(this.m_domDefsSVG[0].querySelectorAll("linearGradient"));this._removeGradient(this.m_domDefsSVG[0].querySelectorAll("radialGradient"))};WDPictureSVG.prototype._removeGradient=function(n){for(var t,r,u=this.m_domDefsSVG[0].attributes.id.value.split("-")[0],i=0;i<n.length;++i)t=n[i],r=t.id.substr(this.m_Id.length+1+t.tagName.length+5),this.m_tabId[r]||$(t).remove()};WDPictureSVG.prototype.clipRect=function(n,t,i){var r=this.tag(this.m_domDefsSVG,t,"clipPath"),u=this.rect(r,t+"-rect");return this.drawRect(u,n,undefined,undefined,undefined,i===undefined?!1:i),this.m_tabClipActif.push(r),u};WDPictureSVG.prototype.restoreClip=function(){this.m_tabClipActif.pop()};WDChartRenderer.prototype.constructor=WDChartRenderer;WDChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i){var r=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+t),u,f;r&&r.length&&(u=r.find("text"),u.length)&&(f=new WDSvgAnimation(this.m_oGraphe,n,u,{"font-weight":i?0:900},{"font-weight":i?900:0}),f.duration=1,f.run())};WDChartRenderer.crPlusFonce=WDChartRenderer.prototype.crPlusFonce=function(n){var t=clWDUtil.tabHTML2RVBA(n);return t[0]=Math.max(t[0]-64,0),t[1]=Math.max(t[1]-64,0),t[2]=Math.max(t[2]-64,0),clWDUtil.sRVBA2HTML(t)};WDChartRenderer.bParametresSupportes=function(n,t){var i=t.m_oParametres;return i.m_bInteractif===!1?!1:parseInt10(i.m_nProfondeur)>0&&!i.m_bInterdit3D&&!n.m_b3DActive?!1:i.m_bLogarithmique?!1:i.m_bPossedeFils?!1:!i.m_bAxeHDroite||!i.m_bAxeVHaut?!1:!0};WDChartRenderer.prototype.Init=function(n){this.m_oGraphe=n;this.m_oModele=n.m_oModele;this.m_params=n.m_oModele.m_oParametres;this.m_oPaint=new WDPaintCSS};WDChartRenderer.prototype.bEstLegendeMasquee=function(n){return this.m_oGraphe.m_oVue.bEstSerieMasquee(n)===!0};WDChartRenderer.prototype.getNbLegendLabels=function(){var n=this.m_oModele.getSeriesAt(0,!1);return n!==undefined?n.getNbValues():0};WDChartRenderer.prototype.getLegendColorAt=function(n){return this.m_oModele.getCategoryColor(n)};WDChartRenderer.prototype.getSeriesAlphaAt=function(n){return this.m_oModele.getSeriesAlpha(n)};WDChartRenderer.prototype.getSeriesSplineAt=function(n){return this.m_oModele.getSeriesSpline(n)};WDChartRenderer.prototype.getSeriesDessinValeursNullesAt=function(n){return this.m_oModele.getSeriesDessinValeursNulles(n)};WDChartRenderer.prototype.getLegendLabelAt=function(n){var t=this.m_oModele.getCategoryLabelAt(n);return t===undefined?"":t};WDChartRenderer.prototype.drawAnimation=function(n,t){t.bDessinComplet()?(this.m_domBulle&&this.m_domBulle.empty(),t.NotifDessinComplet(),this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinParDefaut)):this.drawChart(n,t,this.m_domGroupeSeries)};WDChartRenderer.prototype.draw=function(n,t,i){var u=this.m_oModele.m_oParametres.m_oPositionnementManuel!=undefined?new WDRect(this.m_params.m_oPositionnementManuel.m_oGraphe):new WDRect(IWDChartConstant.MARGIN_BORDER,IWDChartConstant.MARGIN_BORDER,IWDChartConstant.MARGIN_BORDER*2,IWDChartConstant.MARGIN_BORDER*2);var f=this.m_oGraphe.m_oHoteImage.width,e=this.m_oGraphe.m_oHoteImage.height,r=$(this.m_oGraphe.m_oHoteImage);r.data("width")?(f=r.data("width"),e=r.data("height")):(r.data("width",f),r.data("height",e));this.m_rectChart=new WDRect(u.m_nLeft,u.m_nTop,f-u.m_nRight,e-u.m_nBottom);this.m_rectChartInitial=new WDRect(0,0,f,e);n.m_bDessinDirectementDansLaPage?n.PlaceDansLaPage(this.m_oGraphe):n.m_domBaliseSVG=n.m_domBaliseSVG.detach();((this.m_params.m_sImageFond||"")!==""||(this.m_params.m_sCouleurFond||"")!=="")&&((this.m_params.m_sImageFond||"")!==""&&this.m_oPaint.setImageFond(this.m_params.m_sImageFond,this.m_params.m_eImageFondMode,WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)),(this.m_params.m_sCouleurFond||"")!==""&&this.m_oPaint.setCouleurFond(this.m_params.m_sCouleurFond),n.SetImageFond(this.m_oPaint));n.SetAntiAliasing(this.m_params.m_bAntiAliasing);this.m_domGroupeSeries=n.g("series-axis-grids-groupe");this.m_domGroupeLegendeEtTitre=n.g("legende-titre-groupe");this.drawTitle(n,t,this.m_domGroupeLegendeEtTitre);this.drawLegend(n,t,this.m_domGroupeLegendeEtTitre);i!==!1&&this.drawChart(n,t,this.m_domGroupeSeries);this.m_domBulle=n.g("bulle-groupe");this.drawMire(n,t,this.m_domBulle);n.draw(this.m_oGraphe);n.m_domBaliseSVG.wbData("wbGrfNbDessins",1+(n.m_domBaliseSVG.wbData("wbGrfNbDessins")||0));t.NotifDessinComplet();this.m_oGraphe.m_oVue.updateModeleReference(this.m_oGraphe,!0)};WDChartRenderer.prototype.liaisonLegendePart=function(n,t,i){var u=WDChartListener.bind(WDPieChartPartListener,this.m_oGraphe,t),r;u&&(r=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+i),r&&r.length!==0)&&(r[0].wbGrfBind.m_domPart=t,u.m_domLegende=r)};WDChartRenderer.prototype.drawTitle=function(n,t,i){var f,e,r,s;if(this.m_oPaint.raz(),f=this.m_params.getTitlePosition(),e=n.g(i,"title-group"),f===IWDChartConstant.FLAG_TITLE_POSITION_NONE||f===IWDChartConstant.FLAG_TITLE_POSITION_MANUAL&&!(this.m_params.m_oPositionnementManuel&&this.m_params.m_oPositionnementManuel.m_oTitre)){e.empty();return}if(r=this.m_params.m_sTitre,r!=""){t.tweenGroupeTitre(e);this.m_oPaint.addClasse(this.m_params.m_sClasseTitre);var h=WDPaintCSS.oGetInfoCSS(this.m_oPaint,r,"lineHeight"),u=parseInt10(h.lineHeight),o=n.text(e,"titre");f===IWDChartConstant.FLAG_TITLE_POSITION_MANUAL?(s=this.m_params.m_oPositionnementManuel.m_oTitre,n.drawText(o,r,u,WDRect.getCenterX(s),s.m_nTop,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1)):f===IWDChartConstant.FLAG_TITLE_POSITION_TOP?(n.drawText(o,r,u,WDRect.getCenterX(this.m_rectChart),this.m_rectChart.m_nTop,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1),this.m_rectChart.setLocation(this.m_rectChart.m_nLeft,this.m_rectChart.m_nTop+u+IWDChartConstant.MARGIN_TITLE_GRAPH)):(n.drawText(o,r,u,WDRect.getCenterX(this.m_rectChart),this.m_rectChart.m_nBottom-u,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1),this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)-u-IWDChartConstant.MARGIN_TITLE_GRAPH))}};WDChartRenderer.prototype.ecouteLegende=function(){return undefined};WDChartRenderer.prototype.drawChart=function(){this.m_oPaint.raz()};WDChartRenderer.prototype.RecreerRenderer=function(n){n.Raz()};WDChartRenderer.prototype.TermRenderer=function(n,t){var i=this.m_oGraphe.m_oVue;t!==WDChartView.ms_nDessinModifTypeGraphe&&(i.m_oModeleInitialSeries=undefined,i.m_tabSeriesMasquees=[],i.m_oAnimator.m_tabAnimations=[])};WDChartRenderer.prototype.__oPathBulle=function(n,t,i,r,u,f){var p=6,l=6,o=n.m_nLeft,e=n.m_nTop,c=n.getWidth(),s=n.getHeight(),h=i,a=h+l,w=Math.round(t||0)%2/2,v,y;return o+=w,e+=w,f&&(f-=e),v=["M",o+h,e,"L",o+c-h,e,"C",o+c,e,o+c,e,o+c,e+h,"L",o+c,e+s-h,"C",o+c,e+s,o+c,e+s,o+c-h,e+s,"L",o+h,e+s,"C",o,e+s,o,e+s,o,e+s-h,"L",o,e+h,"C",o,e,o,e,o+h,e],y=!1,f&&f>s&&u>o+a&&u<o+c-a?v.splice(23,3,"L",u+l,e+s,u,e+s+p,u-l,e+s,o+h,e+s):f&&f<0&&u>o+a&&u<o+c-a?v.splice(3,3,"L",u-l,e,u,e-p,u+l,e,o+c-h,e):y=u&&u>c&&f>e+a&&f<e+s-a?!0:u&&u<0&&f>e+a&&f<e+s-a?!0:!0,y&&f&&u&&v.splice(23,3,"L",o+l,e+s,o+l,e+s,o+l,e+s,o+h,e+s),{d:v,"data-arguments":Array.prototype.slice.call(arguments,0)}};WDChartRenderer.prototype.__bDessineBulle=function(n,t,i,r,u,f,e,o,s,h){for(var p=u.m_oStyle.strokeWidth,w=this.__oPathBulle(r,p,f,e,o,s),v=[{width:5,opacity:.05},{width:3,opacity:.1},{width:1,opacity:.15}],c=0,l=undefined,y,c=0;c<v.length;++c)l=n.path(t,i+"-ombre-"+c);var y=n.path(t,i),a=h&&h.prototype.bAnimationBullePathPossible(w,y,o&&s),b=new WDPaintCSS;for(c=0;c<v.length;++c)l=n.path(t,i+"-ombre-"+c),!a&&h&&h.prototype.ArreteEtVideAnimations(l),n.translate(l,p,p,!0),b.setStroke("black",v[c].width,v[c].opacity),b.DesactivePointerEvents(),n.drawPath(l,w,b,a?h:!1);return y=n.path(t,i),!a&&h&&h.prototype.ArreteEtVideAnimations(y),n.drawPath(y,w,u,a?h:!1),a};WDChartRenderer.prototype._vbLegendevaleur=function(){return!1};WDXYChartRenderer.bParametresSupportes=function(n,t){var r,i,u;if(!WDChartRenderer.bParametresSupportes(n,t))return!1;for(r=t.m_oParametres,i=0;i<t.m_tabSeries.length;++i)if(u=t.m_tabSeries[i],u.isOnSecondaryAxis()&&!r.m_oAxeYSecondaire)return!1;return!0};WDXYChartRenderer.prototype=new WDChartRenderer;WDXYChartRenderer.prototype.constructor=WDXYChartRenderer;WDXYChartRenderer.prototype.nGetYOrigin=function(n){return n?this.m_nYOrigin2:this.m_nYOrigin};WDXYChartRenderer.prototype.nGetXOrigin=function(n){return n?this.m_nXOrigin2:this.m_nXOrigin};WDXYChartRenderer.prototype.dGetXPixelsPerUnit=function(n){return n?this.m_dX2PixelsPerUnit:this.m_dXPixelsPerUnit};WDXYChartRenderer.prototype.dGetYPixelsPerUnit=function(n){return n?this.m_dY2PixelsPerUnit:this.m_dYPixelsPerUnit};WDXYChartRenderer.prototype.RecreerRenderer=function(){this.m_params.m_oAxeYSecondaire&&(nAffichage=WDChartView.ms_nDessin1erAffichage)};WDXYChartRenderer.prototype.getNbLegendLabels=function(){var n=parseInt10(this.m_oModele.m_tabSeries.length/this.m_nPasSerie);return this.m_nNbMaxSerieLegende&&this.m_nNbMaxSerieLegende<n?this.m_nNbMaxSerieLegende:n};WDXYChartRenderer.prototype.getLegendColorAt=function(n){return this.m_oModele.getSeriesColor(n)};WDXYChartRenderer.prototype.getLegendLabelAt=function(n){return this.m_oModele.getSeriesAt(n*this.m_nPasSerie,!1).m_sLibelle};WDXYChartRenderer.prototype.draw=function(){this.m_oModele.createAxis();WDChartRenderer.prototype.draw.apply(this,arguments)};WDXYChartRenderer.prototype.drawChartSeries=function(n,t,i){for(var e=this.m_oModele.m_tabSeries.length,r=0,u,f,o,r=0;r<e;r+=this.m_nPasSerie)u=n.g(t,"groupe-serie-"+r),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&this.m_params.m_nDureeAnimation==0||this.drawSeries(n,u,r,this.m_oModele.getSeriesAt(r,!1),i),f=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+r),f.length&&(o=WDChartListener.bind(this.m_ProtoLegendListener,this.m_oGraphe,f,u,r))};WDXYChartRenderer.prototype.drawChart=function(n,t,i){var u,f,e,h,r,o,s;if(WDChartRenderer.prototype.drawChart.apply(this,arguments),u=this.m_oModele.m_tabSeries.length,u<this.m_nPasSerie){i.empty();return}if(this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),t.tweenRedessineAxes(i,!0)){if(!this.prepareRendering(n,t,i,this.m_params))return;if(this.drawGrids(n,this.m_params,this.m_rectAxis,i)===!1)return}for(f=this.isClipOnAxisRectBeforeDrawingChart(),f&&n.clipRect(this.m_rectAxis,"clip-axes"),e=n.g(i,"groupe-series"),this.drawChartSeries(n,e,this.m_params),r=u;(h=n.findFromId(e,"groupe-serie-"+r)).length>0;++r)h.remove(),o=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+r),o.length&&o.remove(),s=n.findFromId(n.m_domBaliseSVG,"barre-texte-"+r),s.length&&s.remove();f&&n.restoreClip();t.tweenRedessineAxes(i,!0)&&this.drawAxis(n,t,i,this.m_params)};WDXYChartRenderer.prototype.getDrawnValuesCount=function(n,t){var i=Math.floor(t.m_dMinValue),r=Math.ceil(t.m_dMaxValue);return Math.min(n,r-i+1)};WDXYChartRenderer.prototype.getYOriginValue=function(n){var t=this.getAxisRendererForType(n?EAxisType.Y2:EAxisType.Y);return t?t.m_axis.m_dOriginValue:0};WDXYChartRenderer.prototype.getXOriginValue=function(n){var t=this.getAxisRendererForType(n?EAxisType.X2:EAxisType.X);return t?t.m_axis.m_dOriginValue:0};WDXYChartRenderer.prototype.getFirstDrawnCategoryIndex=function(n){var t=n.m_dOriginValue;return this.m_timeScale!=ETimeScale.NONE?this.m_oModele.getCategoryIndexForTime(Math.floor(t)):Math.floor(t)};WDXYChartRenderer.prototype.getCategoryDrawingPositionX=function(n,t){if(n-=this.getFirstDrawnCategoryIndex(this.m_oModele.getAxisByType(EAxisType.X)),this.m_timeScale!=ETimeScale.NONE){var i=this.m_oModele.m_oCategories,r=i.getTimeInMillisAt(n)-i.getMinValueInMillis();return this.getDrawingPositionX(r,t)}return this.getDrawingPositionX(n,t)};WDXYChartRenderer.prototype.getDrawingPositionX=function(n,t){return this.nGetXOrigin(t)+Math.ceil(n*this.dGetXPixelsPerUnit(t))};WDXYChartRenderer.prototype.getDrawingPositionY=function(n,t){return this.nGetYOrigin(t)-Math.ceil(n*this.dGetYPixelsPerUnit(t))};WDXYChartRenderer.prototype.getCategoryDrawingPositionY=function(n,t,i){if(n-=this.getFirstDrawnCategoryIndex(this.m_oModele.getAxisByType(EAxisType.X)),this.m_timeScale!=ETimeScale.NONE){var r=this.m_oModele.m_oCategories,u=r.getTimeInMillisAt(n)-r.getMinValueInMillis();return i?this.getDrawingPositionY(u,t):this.nGetYOrigin(t)-Math.ceil(u*this.dGetYPixelsPerUnit(t))}return i?this.getDrawingPositionY(n,t):this.nGetYOrigin(t)-Math.ceil(n*this.dGetXPixelsPerUnit(t))};WDXYChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i){if(WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments),t!==undefined){var u=n.g("groupe-serie-"+t),r=u.find("path");r.length&&r.css("strokeWidth",parseInt10(r.attr("stroke-width"))+(i?1:0))}};WDXYChartRenderer.prototype.drawAxis=function(n,t,i,r){var e=n.g(i,"groupe-axes"),o,u,f,s;if(e.empty(),this.m_oModele.hasAuMoinsUneSerieNonVide())for(o=this.m_oModele.m_lstAxis.length,u=0;u<o;++u)f=this.m_tabAxisRenderer[u],r.isAxisVisible(f.m_axis)&&(s=n.g(e,"groupe-axe-"+u),f.draw(n,s,r,this.m_rectChart,this.m_rectAxis,this.m_nXOrigin,this.m_nYOrigin,this.m_oPaint))};WDXYChartRenderer.prototype.drawGrids=function(n,t,i,r){var u=0,f=n.g(r,"groupe-grids"),g,nt,e,v,it,rt;if(n.SetAntiAliasing(!1,f),this.m_oModele.hasAuMoinsUneSerieNonVide()){var ut=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,"0","lineHeight"),k=parseInt10(ut.lineHeight),o=undefined,h=undefined,p=undefined,y=undefined,l=undefined,a=t.m_bAxeXHorizontal?this.getAxisRendererForType(EAxisType.X):this.getAxisRendererForType(EAxisType.Y);if(a){h=a.getNbGraduations();p=a.getAxisSize(i);y=a.getGraduationSize(p);var s=i.getLeft(),ft=i.getTop(),et=i.getBottom(),d=s;for(u=0;u<h;++u){if(this.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap&&u>0&&Math.abs(s-d)<=5+k){s+=y;continue}d=s;l=s!=this.nGetXOrigin(a.m_axis.isSecondaryAxis())||!t.isAxisVisible(a.m_axis);o=n.line(f,"grid-vert-"+u);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,l&&t.isVerticalGridShown()?1:0);n.drawLine(o,s,ft,s,et,this.m_oPaint,!1);s+=y}for(v=h;(o=n.findFromId(f,"grid-vert-"+v)).length>0;++v)o.remove();g=n.line(f,"grid-horiz-haut");nt=n.line(f,"grid-horiz-bas");this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(g,i.getLeft(),i.getTop(),i.getRight(),i.getTop(),this.m_oPaint,!1);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(nt,i.getLeft(),i.getBottom(),i.getRight(),i.getBottom(),this.m_oPaint,!1)}if(e=t.m_bAxeXHorizontal?this.getAxisRendererForType(EAxisType.Y):this.getAxisRendererForType(EAxisType.X),e){h=e.getNbGraduations();p=e.getAxisSize(i);y=e.getGraduationSize(p);var c=i.getBottom(),ot=i.getLeft(),st=i.getRight(),tt=c,w=0,b=!1;for(u=0;u<h;++u){if(l=c!=this.nGetYOrigin(e.m_axis.isSecondaryAxis())||!t.isAxisVisible(e.m_axis),this.m_oGraphe.m_oParametres.m_eType!=WDChartParameters.kHeatMap&&u>0&&Math.abs(c-tt)<=5+k?(l=!1,b||++w):(tt=c,!b&&w>0&&(b=!0)),u>0&&u==h-1&&!l&&(this.m_params.m_oAxeY.m_dPasMin||0)<this.m_params.m_oAxeY.m_dPas&&(this.m_params.m_oAxeY.m_dPasMin=this.m_params.m_oAxeY.m_dPas,this.m_params.m_oAxeY.m_dPas=e.m_dStep*(1+w),this.m_params.m_oAxeY.m_dPas>=e.m_dStep))return this.drawChart(n,this.m_oGraphe.m_oVue.m_oAnimator,this.m_domGroupeSeries),!1;o=n.line(f,"grid-horiz-"+u);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,l&&t.isHorizontalGridShown()?1:0);n.drawLine(o,ot,c,st,c,this.m_oPaint,!1);c-=y}for(v=h;(o=n.findFromId(f,"grid-horiz-"+v)).length>0;++v)o.remove();it=n.line(f,"grid-vert-gauche");rt=n.line(f,"grid-vert-droite");this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(it,i.getLeft(),i.getTop(),i.getLeft(),i.getBottom(),this.m_oPaint,!1);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage,undefined,t.isVerticalGridShown()||t.isHorizontalGridShown()?1:0);n.drawLine(rt,i.getRight(),i.getTop(),i.getRight(),i.getBottom(),this.m_oPaint,!1)}}};WDXYChartRenderer.prototype.adjustAxisSizeBeforePreparingRenderer=function(n){for(var t,u,f,i,r=0;r<this.m_oModele.m_lstAxis.length;++r)t=this.m_oModele.m_lstAxis[r],u=n.getAxisTitle(t),u&&(f=WDPaintCSS.oGetInfoCSS(n.m_sClasseAxe,u,"lineHeight"),i=parseInt10(f.lineHeight),t.m_orientation==EAxisOrientation.HORIZONTAL?t.isSecondaryAxis()?this.m_rectAxis.setLocation(this.m_rectAxis.getLeft(),this.m_rectAxis.getTop()+i+IWDChartConstant.MARGIN_AXIS_TITLE,!1):this.m_rectAxis.setSize(this.m_rectAxis.getWidth(),this.m_rectAxis.getHeight()-(i+IWDChartConstant.MARGIN_AXIS_TITLE)):t.m_orientation==EAxisOrientation.VERTICAL&&(t.isSecondaryAxis()?this.m_rectAxis.setSize(this.m_rectAxis.getWidth()-(i+IWDChartConstant.MARGIN_AXIS_TITLE),this.m_rectAxis.getHeight()):this.m_rectAxis.setLocation(this.m_rectAxis.getLeft()+IWDChartConstant.MARGIN_AXIS_TITLE+i,this.m_rectAxis.getTop(),!1)))};WDXYChartRenderer.prototype.prepareRendering=function(n,t,i,r){var s=0,w,k,f,y,a,u,l,d,b,p,g;this.m_rectAxis.set(this.m_rectChart);this.m_timeScale=this.m_oGraphe.m_oModele.m_oCategories.bEchelleTemporelle()&&this.m_oGraphe.m_oModele.m_oCategories.m_tabValeurMS.length?!WDChartCategories.bEstTypeDate(this.m_oGraphe.m_oModele.m_oCategories.m_eTypeWL)||(r.m_sMasqueAxeTemporel||r.m_sMasqueValeur).indexOf(":")>0?ETimeScale.TIME:ETimeScale.DATE:ETimeScale.NONE;this.adjustAxisSizeBeforePreparingRenderer(r,this.m_oPaint);var e=0,v=0,h=0,o=0,c=this.m_oModele.m_lstAxis.length;if(!this.m_tabAxisRenderer||this.m_tabAxisRenderer.length!=c)for(this.m_tabAxisRenderer=undefined,delete this.m_tabAxisRenderer,this.m_tabAxisRenderer=[],s=0;s<c;++s)this.m_tabAxisRenderer[s]=this.createAxisRenderer();for(f=0;f<c;++f)l=this.m_oModele.m_lstAxis[f],u=this.m_tabAxisRenderer[f],u.prepare(l,r,this.m_rectAxis,this.m_oPaint,l.isDisplayCategories()?this.m_timeScale:ETimeScale.NONE);for(f=0;f<c;++f)if(u=this.m_tabAxisRenderer[f],u.m_axis.m_orientation==EAxisOrientation.HORIZONTAL&&!u.m_axis.isSecondaryAxis()){if(u.m_tabGraduationLabels.join("").length==0)for(w=0;w<c;++w)k=this.m_tabAxisRenderer[w],k.m_axis.m_orientation==EAxisOrientation.VERTICAL&&(k.m_dBottomOverflow=0);break}for(f=0;f<c;++f)u=this.m_tabAxisRenderer[f],u.m_dLeftOverflow>e&&(e=u.m_dLeftOverflow),u.m_dRightOverflow>v&&(v=u.m_dRightOverflow),u.m_dTopOverflow>h&&(h=u.m_dTopOverflow),u.m_dBottomOverflow>o&&(o=u.m_dBottomOverflow);for(e=Math.ceil(e),v=Math.ceil(v),h=Math.ceil(h),o=Math.ceil(o),y=this.m_rectAxis.getLeft(),a=this.m_rectAxis.getBottom(),s=0;s<c;++s)(u=this.m_tabAxisRenderer[s],l=u.m_axis,l.m_type!==EAxisType.Z)&&(l.isSecondaryAxis()||(d=u.m_nNbNegativeGraduations,l.m_orientation==EAxisOrientation.HORIZONTAL?d==0?y+=e:(b=u.getGraduationSize(this.m_rectAxis.getWidth()-u.m_dLeftOverflow-u.m_dRightOverflow)*u.m_nNbNegativeGraduations+u.m_dLeftOverflow,b<=e?(y+=e,e-=b-u.m_dLeftOverflow):(y+=b,e=u.m_dLeftOverflow)):d==0?a-=o:(p=u.getGraduationSize(this.m_rectAxis.getHeight()-u.m_dTopOverflow-u.m_dBottomOverflow)*u.m_nNbNegativeGraduations+u.m_dBottomOverflow,p<=o?(g=p-u.m_dBottomOverflow,g>h?(a-=p,o=u.m_dBottomOverflow):(a-=h,h-=g)):(a-=p,o=u.m_dBottomOverflow))));this.m_rectAxis.set(this.m_rectAxis.getLeft()+e,this.m_rectAxis.getTop()+h,this.m_rectAxis.getRight()-v,this.m_rectAxis.getBottom()-o);this.adjustAxisSizeBeforeDrawing();this.m_nXOrigin=Math.ceil(y);this.m_nYOrigin=Math.ceil(a);var tt=this.getAxisRendererForType(EAxisType.X),it=this.getAxisRendererForType(EAxisType.Y),nt=this.getAxisRendererForType(EAxisType.Y2);return!tt||!it?!1:(this.m_dXPixelsPerUnit=tt.getPixelsPerUnit(this.m_rectAxis),this.m_dYPixelsPerUnit=it.getPixelsPerUnit(this.m_rectAxis),nt&&(this.m_dY2PixelsPerUnit=nt.getPixelsPerUnit(this.m_rectAxis),this.m_nYOrigin2=this.m_rectAxis.getBottom()+Math.min(0,nt.m_axis.m_dMinValue)*this.m_dY2PixelsPerUnit),this.m_nXOrigin2=this.m_nXOrigin,this.m_dX2PixelsPerUnit=this.m_dXPixelsPerUnit,!0)};WDXYChartRenderer.prototype.adjustAxisSizeBeforeDrawing=function(){for(var t,i,n,f,r,e=this.m_tabAxisRenderer.length,u=0;u<e;++u)(t=this.m_tabAxisRenderer[u],i=t.m_axis,i.m_type!==EAxisType.Z)&&(n=i.m_orientation==EAxisOrientation.HORIZONTAL?this.m_rectAxis.getWidth():this.m_rectAxis.getHeight(),f=n,n=t.getGraduationSize(n)*(Math.max(1,t.getNbGraduations())-1),n!==0)&&(r=f-n,r!=0&&(i.m_orientation==EAxisOrientation.HORIZONTAL?this.m_rectAxis.setRight(this.m_rectAxis.getRight()-r):this.m_rectAxis.setTop(this.m_rectAxis.getTop()+r)))};WDXYChartRenderer.prototype.getAxisRendererForType=function(n){var r,t,i;if(this.m_tabAxisRenderer!=null)for(r=this.m_tabAxisRenderer.length,t=0;t<r;++t)if(i=this.m_tabAxisRenderer[t],i.m_axis.m_type==n)return i;return undefined};WDChartView.prototype.constructor=WDChartView;WDChartView.ms_nDessinImpossible=-1;WDChartView.ms_nDessinParDefaut=0;WDChartView.ms_nDessin1erAffichage=1;WDChartView.ms_nDessinModifTypeGraphe=2;WDChartView.ms_nDessinAnimation=4;WDChartView.ms_nDessinNouvellesDonnees=5;WDChartView.DELAI_1ERAFFICHAGE=400;WDChartView.prototype.updateModeleReference=function(n,t){this.m_oModelePrecedent=this._updateModele(n);t&&!this.m_oModeleInitialSeries&&(this.m_oModeleInitialSeries=this._updateModele(n))};WDChartView.prototype._updateModele=function(n){for(var u,f,r,i={m_tabSeries:[]},t=0;t<n.m_oModele.m_tabSeries.length;++t){for(u=n.m_oModele.m_tabSeries[t],i.m_tabSeries[t]={m_tabValeur:[]},f=1;f<u.m_nOffset;++f)i.m_tabSeries[t].m_tabValeur.push(0);i.m_tabSeries[t].m_tabValeur=i.m_tabSeries[t].m_tabValeur.concat([].concat(u.m_tabValeur));r=n.m_oModele.getAxisByType(u.isOnSecondaryAxis()?EAxisType.Y2:EAxisType.Y);r&&(i.m_tabSeries[t].m_oAxis={m_dMinValue:r.m_dMinValue,m_dMaxValue:r.m_dMaxValue,m_dOriginValue:r.m_dOriginValue})}return i};WDChartView.prototype.toggleSerieMasquee=function(n){return this.setSerieMasquee(n,!this.bEstSerieMasquee(n))};WDChartView.prototype.setSerieMasquee=function(n,t){return this.m_tabSeriesMasquees[n]=t,this.m_tabSeriesMasquees[n]};WDChartView.prototype.bEstSerieMasquee=function(n){return this.m_tabSeriesMasquees[n]===undefined||this.m_tabSeriesMasquees[n]===!1?!1:!0};WDChartView.prototype.RecreerRenderer=function(n,t){var i=WDChartView.ms_nDessinImpossible;if(this.m_bInteractif&&WDPictureSVG.bDessinPossible()){if(i=WDChartView.ms_nDessinParDefaut,this.m_oPicture===undefined){if(this.m_oPicture=new WDPictureSVG(n),!this.m_oPicture.Init(n))return!1;i=WDChartView.ms_nDessin1erAffichage}else this.m_oRenderer&&n.m_oModele.bDonneesDejaDessinnees()?i=this.nGetTypeAffichage(n,this.m_oRenderer):(this.m_oRenderer||this.m_oPicture.Raz(),i=WDChartView.ms_nDessinNouvellesDonnees);i=t&&i===WDChartView.ms_nDessinParDefaut?t:i;switch(n.m_oModele.m_oParametres.getType()){case WDChartParameters.kHistoHorizontal:case WDChartParameters.kHistoEmpileHorizontal:n.m_oModele.m_oParametres.m_bAxeXHorizontal=!1;case WDChartParameters.kHisto:case WDChartParameters.kHistoEmpile:WDBarChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDBarChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDBarChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kWaterfall:WDWaterfallChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDWaterfallChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDWaterfallChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kChandelier:case WDChartParameters.kBarCharts:case WDChartParameters.kMinMax:WDCandleStickChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDCandleStickChartRenderer.prototype.constructor&&this.m_oRenderer.m_params.getType()==n.m_oModele.m_oParametres.getType()?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDCandleStickChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kSecteur:case WDChartParameters.kDonut:case WDChartParameters.kHemicycle:WDPieChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDPieChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDPieChartRenderer(n),this.m_oAnimator=new WDPieChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kEntonnoir:WDFunnelChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDFunnelChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDFunnelChartRenderer(n),this.m_oAnimator=new WDFunnelChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kBulle:WDBubbleChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDBubbleChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDBubbleChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kNuage:WDScatterChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDScatterChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDScatterChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kCourbe:case WDChartParameters.kAire:WDLineChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDLineChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDLineChartRenderer(n),this.m_oAnimator=new WDXYChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kRadar:WDRadarChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDRadarChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDRadarChartRenderer(n),this.m_oAnimator=new WDRadarChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;case WDChartParameters.kHeatMap:WDHeatmapChartRenderer.bParametresSupportes(this.m_oPicture,n.m_oModele)?this.m_oRenderer&&this.m_oRenderer.constructor==WDHeatmapChartRenderer.prototype.constructor?(this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer.RecreerRenderer(this.m_oPicture,i)):(this.m_oPicture.Raz(),i=WDChartView.ms_nDessin1erAffichage,this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oAnimator&&this.m_oAnimator.TermAnimator(this.m_oPicture,i),this.m_oRenderer=new WDHeatmapChartRenderer(n),this.m_oAnimator=new WDHeatmapChartAnimator(n)):(this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i),this.m_oRenderer=undefined);break;default:this.m_oRenderer&&this.m_oRenderer.TermRenderer(this.m_oPicture,i);this.m_oRenderer=undefined}}return this.m_oRenderer!==undefined?(this.m_oPicture.m_domBaliseSVG.attr("id",this.m_sIdHoteImageOrig),$(n.m_oHoteImage).attr("name",this.m_sIdHoteImageOrig).attr("id",""),n.m_oHote=this.m_oPicture.m_domBaliseSVG.parent()[0]):(this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&this.m_oPicture.m_domBaliseSVG.attr("id",""),$(n.m_oHoteImage).attr("id",this.m_sIdHoteImageOrig),n.m_oHote=n.m_oHoteImage),i};WDChartView.prototype.bEstInteractif=function(){return this.m_bInteractif&&this.m_oRenderer!==undefined};WDChartView.prototype.Redessine=function(n,t){var i=$(n.m_oHoteImage),r;if(this.m_oRenderer===undefined)this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&this.m_oPicture.m_domBaliseSVG.css("display","none"),i.css("display","block"),r=i.attr("src")||"",(r==""||r.indexOf("vide.gif")==r.length-8)&&i.attr("data-src")!==undefined&&(i.attr("src",i.attr("data-src")),i.attr("data-src",undefined));else{i.css("display","none");this.m_oPicture&&this.m_oPicture.m_domBaliseSVG&&this.m_oPicture.m_domBaliseSVG.css("display","block");this.onDraw(n,t)}};WDChartView.prototype.Init=function(n){if(this.m_sIdHoteImageOrig=$(n.m_oHoteImage).attr("id"),this.m_bInteractif=n.m_bInteractif,n.m_oBarreAutomatique.m_oBarre!==undefined&&this.m_bInteractif&&$(n.m_oBarreAutomatique.m_oBarre).css("opacity",0),this.m_bInteractif){if(n.relanceInitialisation(),this.m_oPicture!==undefined&&this.m_oPicture.m_domBaliseSVG){clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mouseover",n.m_fRafBarreTrue);clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mouseout",n.m_fRafBarreFalse);clWDUtil.AttacheDetacheEvent(!0,this.m_oPicture.m_domBaliseSVG[0],"mousemove",n.m_fRafBarreTrueMMove);var t=$(n.m_oHoteImage),i=t.prop("attributes");$(i).each(function(){var t=this.name.toLowerCase();t.substr(0,2)=="on"&&t!="onload"&&n.m_oVue.m_oPicture.m_domBaliseSVG.attr(this.name,(this.value||"").replace("event","arguments[0]"))});n.m_oHoteImage&&n.m_oHoteImage.onload&&n.m_oHoteImage.onload()}}else this.Redessine(n);n.m_oBarreAutomatique.m_oBarre!==undefined&&this.m_bInteractif&&$(n.m_oBarreAutomatique.m_oBarre).find("[data-src]").each(function(){$(this).attr("src",$(this).attr("data-src")).bind("load",function(){$(this).removeAttr("data-src");var n=$(this).closest("table");n.find("[data-src]").length===0&&n.css("opacity",1)})})};WDChartView.prototype.nGetTypeAffichage=function(n,t){var r=n.m_oParametres,u=t.m_params,i=WDChartView.ms_nDessinParDefaut;return r.m_eType!=u.m_eType&&(i=WDChartView.ms_nDessinModifTypeGraphe),i};WDChartView.prototype.updateDepuisBarreOutils=function(n){var t=n.m_oParametres,i=n.m_tabEtat,e=WDChartView.ms_nDessinParDefaut,r,u,f;return t.m_eType!=i.TYP&&(e=WDChartView.ms_nDessinModifTypeGraphe,t.m_eType=parseInt10(i.TYP)),t.m_ePosLegende=parseInt10(i.LEG),r=t.m_bAxeXHorizontal?t.m_oAxeX:t.m_oAxeY,r&&(r.m_bQuadrillage=i.GDV),u=t.m_bAxeXHorizontal?t.m_oAxeY:t.m_oAxeX,u&&(u.m_bQuadrillage=i.GDH),t.m_bSpline=i.SMO,t.m_bDegrade=i.GRA,t.m_bDegrade&&(t.m_bDegradeHorizontal=t.m_eType!=WDChartParameters.kAire),t.m_bInterdit3D=!i.RAI,t.m_bInterdit3D||(t.m_nProfondeur=10,t.m_nPourcentageBiseau=10),t.m_bAntiAliasing=i.ANT,f=parseInt10(i.TRA),isNaN(f)||f<2?(t.m_bInterditAlpha=!i.TRA,t.m_byAlpha=t.m_bInterditAlpha?255:127):(t.m_byAlpha=255*(i.TRA/100),t.m_bInterditAlpha=t.m_byAlpha==255),t.m_nDureeAnimation=i.ANI?600:0,t.m_bInteractif=i.INT==0?!1:!0,t.m_bMireMultiple=i.MIR==0,t.m_bMire=t.m_bMireMultiple||i.MIR==1,t.m_bBulleActive=i.MIR!=-1,e};WDChartView.prototype.OnSave=function(n){var u,f,e;if(this.m_oRenderer&&this.m_oPicture){if(bIEAvec11){document.location=n.sGetRequete(!0);return}try{var r=this.m_oPicture.m_domBaliseSVG.clone(),i=document.createElement("canvas"),o=i.getContext("2d"),t=new Image;r.find("text,tspan").each(function(){this.style.cssText=getComputedStyle(document.getElementById(this.id)).cssText});u=this.m_oPicture.m_domBaliseSVG[0].clientHeight;f=this.m_oPicture.m_domBaliseSVG[0].clientWidth;t.width=i.width=f;t.height=i.height=u;t.onload=function(){o.drawImage(t,0,0,t.width,t.height);var n=document.createElement("a");n.href=i.toDataURL();n.download="image.png";n.click()};e=(new XMLSerializer).serializeToString(r[0]);t.src="data:image/svg+xml,"+encodeURIComponent(e)}catch(s){document.location=n.sGetRequete(!0)}}else document.location=n.sGetRequete(!0)};WDChartView.prototype.OnPrint=function(n){var t,i,u,r;if(this.m_oRenderer&&this.m_oPicture)t=this.m_oPicture.getId(this.m_oPicture.m_domBaliseSVG),i=$('<style class="wbGrfprint">#'+t+" { display:none;position:absolute;left:-9999px; }@media print {form{ display:none; }#"+t+" { display:block;position:static; }}<\/style>"),$("head").append(i),u=this.m_oPicture.m_domBaliseSVG.parent(),r=this.m_oPicture.m_domBaliseSVG.detach(),$("body").append(r),window.print(),r.appendTo(u),i.remove();else{var f=(n.m_oHoteImage.offsetHeight||n.m_oHoteImage.clientHeight)+30,e=(n.m_oHoteImage.offsetWidth||n.m_oHoteImage.clientWidth)+30,o=window.open(n.sGetRequete(!1),"WDG_"+(new Date).getTime(),"resizable=yes,height="+f+",width="+e);o.print()}};WDChartView.prototype.ExecuteCommande=function(n){if($(n.m_oHoteImage).removeAttr("src").attr("src",n.sGetRequete(!1)),this.m_bInteractif){var t=this.updateDepuisBarreOutils(n);n.relanceInitialisation(t)}};WDChartView.prototype.OnOption=function(n){this.ExecuteCommande(n)};WDChartView.prototype.onDraw=function(n,t){this.m_oRenderer.Init(n,this.m_oPicture);this.m_oPicture.m_domBaliseSVG.wbData("wbGrfModeAffichage",t);switch(t){case WDChartView.ms_nDessin1erAffichage:var i=this;setTimeout(function(){i.m_oAnimator.play1erAffichage(n,i.m_oPicture)},this.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait")?1:WDChartView.DELAI_1ERAFFICHAGE);this.m_oPicture.m_domBaliseSVG.wbData("wbGrf1erDrawFait",!0);break;case WDChartView.ms_nDessinModifTypeGraphe:this.m_oAnimator.playModifTypeGraphe(n,this.m_oPicture);break;default:case WDChartView.ms_nDessinParDefaut:this.m_oRenderer.draw(this.m_oPicture,this.m_oAnimator);break;case WDChartView.ms_nDessinNouvellesDonnees:this.m_oAnimator.playMajDonnees(n,this.m_oPicture);break;case WDChartView.ms_nDessinAnimation:this.m_oRenderer.drawAnimation(this.m_oPicture,this.m_oAnimator)}n.m_oModele.SetDonneesDessinnees();n.m_oModele.SetParametresDejaDessinnes();this.m_oPicture.m_domBaliseSVG.wbRemoveData("wbGrfModeAffichage")};WDBarreBoutonOnOffGraphe.prototype=new WDBarreBoutonOnOff;WDBarreBoutonOnOffGraphe.prototype.constructor=WDBarreBoutonOnOffGraphe;WDBarreBoutonOnOffGraphe.prototype.bActif=function(){return this.m_oObjetParent.bActif(this.m_oParamCommande)};WDBarreBoutonGraphe.prototype=new WDBarreBouton;WDBarreBoutonGraphe.prototype.constructor=WDBarreBoutonGraphe;WDBarreBoutonGraphe.prototype.ExecuteCommande=function(n){this.m_oObjetParent.m_oGraphe[this.m_oParamCommande](n)};WDBarreOutilsGraphe.prototype=new WDBarre;WDBarreOutilsGraphe.prototype.constructor=WDBarreOutilsGraphe;WDBarreOutilsGraphe.s_pclCreate=function(n,t){return n.m_bInteractif?new WDBurger(n,t):new WDBarreOutilsGraphe(n,t)};WDBarreOutilsGraphe.prototype.ExecuteCommande=function(n,t){this.m_oGraphe.ExecuteCommande(n,t)};WDBarreOutilsGraphe.prototype.OnOption=function(n,t){this.m_oGraphe.OnOption(n,t)};WDBarreOutilsGraphe.prototype.Init=function(){WDBarre.prototype.Init.apply(this,[])};WDBarreOutilsGraphe.prototype._InitBarreAutomatique=function(){var n=this;this.m_fRafBarreTrue=function(t){return n.RafBarre(t||event,!0)};this.m_fRafBarreFalse=function(t){return n.RafBarre(t||event)};this.m_fRafBarreTrueMMove=function(t){return n.RafBarreMMove(t||event)};this.m_oGraphe.m_oHote&&(clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mouseover",this.m_fRafBarreTrue),clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mouseout",this.m_fRafBarreFalse),clWDUtil.AttacheDetacheEvent(!0,this.m_oBarre,"mouseout",this.m_fRafBarreFalse),clWDUtil.AttacheDetacheEvent(!0,this.m_oGraphe.m_oHote,"mousemove",this.m_fRafBarreTrueMMove))};WDBarreOutilsGraphe.prototype.RafBarre=function(n,t){var r=this.m_oGraphe,i;switch(r.m_oParametres?r.m_oParametres.m_eEtat||WDChamp.prototype.ms_eEtatActif:WDChamp.prototype.ms_eEtatActif){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:t=!1;break;default:case WDChamp.prototype.ms_eEtatActif:this.m_eModeBarre==this.ms_eModeBarreAutomatique&&t===undefined&&(t=!1,n&&(i=null,bIE||(i=n.relatedTarget),i||(i=n.toElement),(clWDUtil.bEstFils(i,this.m_oBarre,document)||clWDUtil.bEstFils(i,this.m_oHote,document))&&(t=!0)))}WDBarre.prototype.RafBarre.apply(this,[n,t])};WDBarreOutilsGraphe.prototype.bActif=function(n){return this.m_oGraphe.bActif(n)};WDBarreOutilsGraphe.prototype.RafBarreMMove=function(n){clWDUtil.AttacheDetacheEvent(!1,this.m_oGraphe.m_oHote,"mousemove",this.m_fRafBarreTrueMMove);delete this.m_fRafBarreTrueMMove;this.RafBarre(n,!0)};WDBarreOutilsGraphe.prototype._vLiaisonHTML=function(n,t){n="";t="";WDBarre.prototype._vLiaisonHTML.apply(this,[n,t]);
//! arguments car les params ont \u00e9t\u00e9 modifi\u00e9s   
};WDBarreOutilsGraphe.prototype.bActifOption=function(n,t){return this.m_oGraphe.bActifOption(n,t)};WDBarreOutilsGraphe.prototype._voNewBoutonMenu=function(n,t){for(var r=new Array(t.tabP.length),u=t.tabP.length,i=0;i<u;i++)r[i]={oTD:this.oGetElementByIdBarre(document,t.sSuf+"_"+t.tabP[i]),oParamCommande:[this.m_tabConversionCom[t.sSuf],this.m_tabConversionVal[t.sSuf][i]],sTexte:CHART_TOOLBAR[t.sSuf][i]};return t.nType==this.ms_nBoutonPopupMenu?new WDBarreBoutonPopupMenu(this,n,t.sCom,this.oGetElementByIdBarre(document,t.sSuf+"P"),r):new WDBarreBoutonPopupMenuS(this,n,t.sCom,this.oGetElementByIdBarre(document,t.sSuf+"P"),r)};WDBarreOutilsGraphe.prototype._voNewBoutonMenuS=function(n,t){return this._voNewBoutonMenu(n,t)};WDBarreOutilsGraphe.prototype._voNewBoutonOnOff=function(n,t){return new WDBarreBoutonOnOffGraphe(this,n,t.sCom,t.sSty,t.tabP)};WDBarreOutilsGraphe.prototype._voNewBoutonAction=function(n,t){return new WDBarreBoutonGraphe(this,n,t.sCom,t.tabP)};WDBurger.prototype=new WDBarreOutilsGraphe;WDBurger.prototype.constructor=WDBurger;WDBurger.prototype.Init=function(n){this.m_jqUlMenu||(WDBarreOutilsGraphe.prototype.Init.apply(this,arguments),$("#"+n.m_sAliasChamp+"_COM").hide(),this._CreerMenu(),this.m_jqUlMenu.attr("class")!="grfBurgerMenuPosition")&&($("form").append(this.m_jqDivPositionBurger),this._CreerBouton(),this._InitJS())};WDBurger.prototype._InitJS=function(){var n=this,t;this.m_jqBurger.find("input").change(function(t){var r=$(this).parent(),i;$(this).is(":checked")?(n.m_jqUlMenu.find("[data-grfCommande]").each(function(){var t=$(this),u=this.value,i=t.attr("type"),r;i=="radio"||i=="checkbox"?(t.prop("checked",!1),u==n.m_oGraphe.bActif([t.attr("data-grfCommande")])&&t.prop("checked",!0)):i=="number"||i=="range"?(r=n.m_oGraphe.bActif([t.attr("data-grfCommande")]),r<2?t.attr("value",!r?t.attr("max"):t.attr("min")):t.attr("value",n.m_oGraphe.bActif([t.attr("data-grfCommande")]))):t.attr("value",n.m_oGraphe.bActif([t.attr("data-grfCommande")]))}),i={marginLeft:"0.5rem",left:r.offset().left+r.width()/2-n.m_jqDivPositionBurger.width()/2-$(window).scrollLeft(),top:r.offset().top+r.height()-$(window).scrollTop()},i.left+n.m_jqDivPositionBurger.width()>$(window).width()&&(i.left=$(window).width()-n.m_jqDivPositionBurger.width()-17),i.left<0&&(i.left=0),i.top+n.m_jqDivPositionBurger.height()>$(window).height()&&(i.top=$(window).height()-n.m_jqDivPositionBurger.height()-17),i.top<0&&(i.top=0),n.m_jqDivPositionBurger.css(i).css({marginTop:-10,opacity:0,display:"block"}).removeClass("grfMenuMasque").animate({marginTop:0,opacity:1},{queue:"fx"})):(n.m_jqDivPositionBurger.addClass("grfMenuMasque").css("transform-origin",-1*(n.m_jqDivPositionBurger.offset().left-r.offset().left)+"px "+-1*(n.m_jqDivPositionBurger.offset().top-r.offset().top)+"px").fadeOut(400),n.RafBarre(t,!1))});t=function(t){return n.m_jqDivPositionBurger.hasClass("grfMenuMasque")?!1:t.keyCode==27||!t.keyCode&&$(t.target).parents(".grfBurgerMenuPosition,.grfBurger").length==0?(n.m_jqBurger.find("input").prop("checked",!1).trigger("change"),!0):!1};$(document).add(n.m_jqUlMenu).add(n.m_jqUlMenu.find("input")).keyup(function(n){t(n)&&n.preventDefault()});$(document).click(function(n){t(n)&&n.preventDefault()});this.m_jqUlMenu.find(".grfTypeAutres>a").first().click(function(){$(this).next().css("height","").slideToggle()});this.m_jqUlMenu.find("input").keyup(function(){$(this).trigger("change")}).change(function(t){var i=$(this),r=this.value;this.idTimer&&clearTimeout(this.idTimer);this.idTimer=setTimeout(function(){i.attr("type")!="checkbox"?n.m_oGraphe.OnOption(t,[i.attr("data-grfCommande"),r]):n.m_oGraphe.ExecuteCommande(t,[i.attr("data-grfCommande")])},300)}).filter("[type=range]").keydown(function(){$(this).attr("type","number")}).focusout(function(){$(this).attr("type","range")}).mousemove(function(){$(this).attr("title",this.value<3?"Transparent":this.value+"%")});this.m_jqUlMenu.find("[data-grfExec]").click(function(i){var r=$(this);t(r);n.m_oGraphe[r.attr("data-grfExec")]();i.preventDefault()});$(n.m_oGraphe.m_oHoteImage).parent().bind("mouseenter",function(t){n.RafBarre(t,!0)}).bind("mousemove",function(){}).bind("mouseleave",function(t){n.RafBarre(t,!n.m_jqDivPositionBurger.hasClass("grfMenuMasque")||!1)});this.m_bAvecTitreDeplacable&&this.m_jqDivPositionBurger.draggable({handle:"li"})};WDBurger.prototype._CreerBouton=function(){this.m_jqBurger=$('<label class="grfBurger"><input type="checkbox"/><div><span><\/span><\/div><\/label>');this.m_jqBurger.insertBefore(this.m_oGraphe.m_oHoteImage)};WDBurger.prototype.RafBarre=function(n,t){var i=this.m_oGraphe;switch(i.m_oParametres?i.m_oParametres.m_eEtat||WDChamp.prototype.ms_eEtatActif:WDChamp.prototype.ms_eEtatActif){case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:t=!1;break;default:case WDChamp.prototype.ms_eEtatActif:this.m_eModeBarre==this.ms_eModeBarreAutomatique&&t===undefined&&($("html").hasClass("touch")?t=!0:t===undefined)}if(this.m_eModeBarre==this.ms_eModeBarreJamais?t=!1:this.m_eModeBarre==this.ms_eModeBarreToujours&&(t=!0),t)this.m_jqBurger&&this.m_jqBurger.wbData("grfBurgerFade")!==1&&this.m_jqBurger.wbData("grfBurgerFade",1).show();else{this.m_jqBurger&&this.m_jqBurger.wbData("grfBurgerFade")!==0&&this.m_jqBurger.wbData("grfBurgerFade",0).hide();return}};WDBurger.prototype.RafBarreMMove=function(){};WDBurger.prototype._voNewBoutonMenu=function(){return undefined};WDBurger.prototype._voNewBoutonOnOff=function(){return undefined};WDBurger.prototype._voNewBoutonAction=function(){return undefined};WDBurger.prototype._voNewBoutonMenuS=function(n,t){return this._voNewBoutonMenu(n,t)};WDBurger.prototype._bOptionVisible=function(n){return!(this.m_tabBoutonsInfo[n]&&this.m_tabBoutonsInfo[n].bVisible===!1)};WDBurger.prototype._CreerMenu=function(){this.m_jqDivPositionBurger=$('<div class="grfBurgerMenuPosition grfMenuMasque" style="display:none;z-index:999;"/>');this.m_bAvecTitreDeplacable&&this.m_jqDivPositionBurger.addClass("grfTitreDeplacable");this.m_jqUlMenu=$('<ul class="grfBurgerMenu"/>');bIEAvec11||bEdge||this.m_jqUlMenu.addClass("grfPlancheSVG");this.m_jqDivPositionBurger.append(this.m_jqUlMenu);this._CreerContenuMenu()};WDBurger.prototype._CreerContenuMenu=function(){this._AjouteTitre();this._AjouteFaaType();this._AjouteFaaQuadrillage();this._AjouteFaaOptions();this._AjouteFaaOpacite();this._AjouteFaaLegende();this._AjouteFaaBulle();this._AjouteFaaEnreg()};WDBurger.prototype._AjouteTitre=function(){if(this.m_bAvecTitreDeplacable){var n=this._CreerFaa("grfTitre"),t=$("<h1>"+CHART_TOOLBAR.PARAMS+"<\/h1>");n.append(t);n.css("cursor","move")}};WDBurger.prototype._CreerFaa=function(n){var t=$('<li class="'+n+'"/>');return this.m_jqUlMenu.append(t),t};WDBurger.prototype._ListeTypeGraphe=function(){var r=[{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeSecteur"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeHemicycle"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeDonut"},{nIndiceConversionVal:"PIE",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeEntonnoir"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeHistoGroupe"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeHistoEmpile"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeHistoGroupeHoriz"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeHistoEmpileHoriz"},{nIndiceConversionVal:"COL",nSousIndiceConversionVal:4,sClassesCSS:"grfTypeWaterfall"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeCourbe"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeNuage"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeAire"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:3,sClassesCSS:"grfTypeRadar"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:4,sClassesCSS:"grfTypeBulles"},{nIndiceConversionVal:"CUR",nSousIndiceConversionVal:5,sClassesCSS:"grfTypeHeatMap"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:0,sClassesCSS:"grfTypeChandelier"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:1,sClassesCSS:"grfTypeBarChart"},{nIndiceConversionVal:"STO",nSousIndiceConversionVal:2,sClassesCSS:"grfTypeMinMax"}],t,n=[],i=[];for(iGraphe=0;iGraphe<r.length;++iGraphe)oTypeGraphe=r[iGraphe],t||this.m_tabConversionVal[oTypeGraphe.nIndiceConversionVal][oTypeGraphe.nSousIndiceConversionVal]!=this.m_oGraphe.m_oParametres.m_eType?this._bOptionVisible(oTypeGraphe.nIndiceConversionVal)&&n.push(oTypeGraphe):(t=oTypeGraphe.nIndiceConversionVal,i.push(oTypeGraphe));for(iGraphe=0;iGraphe<n.length;++iGraphe)oTypeGraphe=n[iGraphe],t==oTypeGraphe.nIndiceConversionVal&&i.push(oTypeGraphe);for(iGraphe=0;iGraphe<n.length;++iGraphe)oTypeGraphe=n[iGraphe],t!=oTypeGraphe.nIndiceConversionVal&&i.push(oTypeGraphe);return i};WDBurger.prototype._AjouteFaaType=function(){var t=this._ListeTypeGraphe(),f,i,n,r,u;if(t.length!=0){for(f=this._CreerFaa("grfType"),i=$('<ul class="clearfix"/>'),f.append(i),n=0;n<3&&n<t.length;++n)this._CreerFaaTypeGraphe(i,t[n]);if(!(t.length<=3))for(r=$('<li class="grfTypeAutres clearfix"><a>...<\/a><\/li>'),i.append(r),u=$('<ul class="clearfix"/>'),r.append(u),n=3;n<t.length;++n)this._CreerFaaTypeGraphe(u,t[n])}};WDBurger.prototype._CreerFaaTypeGraphe=function(n,t){this.m_jqUlMenu.addClass("grfType"+t.nIndiceConversionVal);n.append($('<li class="'+t.sClassesCSS+" grfType"+t.nIndiceConversionVal+'"><label><input type="radio" name="grfType" value="'+this.m_tabConversionVal[t.nIndiceConversionVal][t.nSousIndiceConversionVal]+'" data-grfCommande="TYP"/><span>'+CHART_TOOLBAR[t.nIndiceConversionVal][t.nSousIndiceConversionVal]+"<\/span><\/label><\/li>"))};WDBurger.prototype._AjouteFaaQuadrillage=function(){if(this._bOptionVisible("GDV")||this._bOptionVisible("GDH")){var t=this._CreerFaa("grfQuadrillage"),n=$('<ul class="clearfix"/>');t.append(n);this._AjouteFaaUnQuadrillage(n,"grfQuadrillageVertical","GDV");this._AjouteFaaUnQuadrillage(n,"grfQuadrillageHorizontal","GDH")}};WDBurger.prototype._AjouteFaaUnQuadrillage=function(n,t,i){this._bOptionVisible(i)&&(this.m_jqUlMenu.addClass(t),n.append($('<li><label class="grfBouton '+t+'"><input type="checkbox" name="'+t+'" data-grfCommande="'+i+'" value="1"><span>'+CHART_TOOLBAR.ALTTEXT[i]+"<\/span><\/label><\/li>")))};WDBurger.prototype._AjouteFaaOpacite=function(){var t,n,i;this._bOptionVisible("TRA")&&(t=this._CreerFaa("grfOpacite"),n=$("<ul><li>"+CHART_TOOLBAR.ALTTEXT.TRA+"<\/li><\/ul>"),t.append(n),this.m_jqUlMenu.addClass("grfOpacite"),i=$('<li class="grfSaisie"><input type="'+((bIEAvec11||bEdge)?"number":"range")+'" min="2" max="100" name="grfSaisie" value="0" data-grfCommande="TRA"><span>%<\/span><\/li><\/li>'),n.append(i))};WDBurger.prototype._AjouteFaaOptions=function(){for(var t=[{sClassesCSS:"grfOptionDegrade",sAlt:"GRA"},{sClassesCSS:"grfOptionLissage",sAlt:"SMO"},{sClassesCSS:"grfOptionRelief",sAlt:"RAI"},{sClassesCSS:"grfOptionAntiAliasing",sAlt:"ANT"},{sClassesCSS:"grfOptionInteractif",sAlt:"INT"},{sClassesCSS:"grfOptionAnimation",sAlt:"ANI"}],n=0,r=!1,i,n=0;n<t.length;++n)if(this._bOptionVisible(t[n].sAlt)){r=!0;break}if(r)for(i=this._CreerFaa("grfOptions"),i.addClass("clearfix"),n=0;n<t.length;++n)this._AjouteFaaUneOption(i,t[n].sClassesCSS,t[n].sAlt)};WDBurger.prototype._AjouteFaaUneOption=function(n,t,i){this.m_jqUlMenu.addClass(t);n.append($('<label class="'+t+' grfBouton"><input type="checkbox" data-grfCommande="'+i+'" value="1"><span>'+CHART_TOOLBAR.ALTTEXT[i]+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaBulle=function(){var i,t,n;this._bOptionVisible("MIR")&&(i=this._CreerFaa("grfBulle"),t=$('<ul class="clearfix"><li>'+CHART_TOOLBAR.MIR[2]+"<\/li><\/ul>"),i.append(t),n=$("<li/>"),t.append(n),this.m_jqUlMenu.addClass("grfBulle"),this._AjouteFaaUneBulle(n,"grfSansBulle",CHART_TOOLBAR.LEG[0],-1),this._AjouteFaaUneBulle(n,"grfBulleSimple",CHART_TOOLBAR.MIR[2],2),this._AjouteFaaUneBulle(n,"grfMire",CHART_TOOLBAR.MIR[1],1),this._AjouteFaaUneBulle(n,"grfMireMultiple",CHART_TOOLBAR.MIR[0],0))};WDBurger.prototype._AjouteFaaUneBulle=function(n,t,i,r){n.append($('<label class="'+t+'" title="'+i+'"><input type="radio" name="grfBulle" data-grfCommande="MIR" value="'+r+'"><span>'+i+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaLegende=function(){var i,t,n;this._bOptionVisible("LEG")&&(i=this._CreerFaa("grfLegende"),t=$('<ul class="clearfix"><li>'+CHART_TOOLBAR.ALTTEXT.LEG+"<\/li><\/ul>"),i.append(t),n=$("<li/>"),t.append(n),this._AjouteFaaUneLegende(n,"grfLegendeAucune",CHART_TOOLBAR.LEG[0],0),this._AjouteFaaUneLegende(n,"grfLegendeDroite",CHART_TOOLBAR.LEG[1],1),this._AjouteFaaUneLegende(n,"grfLegendeGauche",CHART_TOOLBAR.LEG[2],2),this._AjouteFaaUneLegende(n,"grfLegendeHaut",CHART_TOOLBAR.LEG[3],3),this._AjouteFaaUneLegende(n,"grfLegendeBas",CHART_TOOLBAR.LEG[4],4))};WDBurger.prototype._AjouteFaaUneLegende=function(n,t,i,r){this.m_jqUlMenu.addClass(t);n.append($('<label class="'+t+'" title="'+i+'"><input type="radio" name="grfLegende" data-grfCommande="LEG" value="'+r+'"><span>'+i+"<\/span><\/label>"))};WDBurger.prototype._AjouteFaaEnreg=function(){var t,i,n;(this._bOptionVisible("SAV")||this._bOptionVisible("PRI"))&&(t=this._CreerFaa("grfEnreg"),i=$("<button>"+TDB_MENU.EDITION.sLibelle+"<\/button>"),t.append(i),n=this,i.click(function(t){var i=this,l,o,v;if($(this).toggleClass("wbActif"),this.bModeEdition=!this.bModeEdition,l=this.bModeEdition,!l)i.jqTous.fadeOut();else if(i.jqTous)i.jqTous.fadeIn();else{var y=$("#"+n.m_oGraphe.m_sAliasChamp+"-legende-groupe"),f=$("#"+n.m_oGraphe.m_sAliasChamp+"-titre"),p=$("#"+n.m_oGraphe.m_sAliasChamp+"-series-axis-grids-groupe"),e=$("#"+n.m_oGraphe.m_sAliasChamp+"-clip-legende-rect"),u=p.parents("svg"),r=u.offset(),c=u.parent();c.css("position","relative");o=function(){var t=i.jqTrackerLegende,f=i.jqTrackerTitre,e=i.jqTrackerGraphe;r=u.offset();n.m_oGraphe.m_oParametres.m_oPositionnementManuel={m_oLegende:new WDRect(t.offset().left,t.offset().top,t.offset().left+t.width(),t.offset().top+t.height()),m_oGraphe:new WDRect(e.offset().left,e.offset().top,e.offset().left+e.width(),e.offset().top+e.height()),m_oTitre:new WDRect(f.offset().left,f.offset().top,f.offset().left+f.width(),f.offset().top+f.height())};n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oLegende.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oTitre.offset(-r.left,-r.top);n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nRight=u.width()-n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nRight;n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nBottom=u.height()-n.m_oGraphe.m_oParametres.m_oPositionnementManuel.m_oGraphe.m_nBottom;n.m_oGraphe.m_oParametres.m_ePosLegende=t.children(".grfFermer").hasClass("grfMasque")?IWDChartConstant.FLAG_LEGEND_POSITION_NONE:IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL;n.m_oGraphe.m_oParametres.m_ePosTitre=f.children(".grfFermer").hasClass("grfMasque")?IWDChartConstant.FLAG_TITLE_POSITION_NONE:IWDChartConstant.FLAG_TITLE_POSITION_MANUAL;n.m_oGraphe.relanceInitialisation()};i.jqTrackerGraphe=$('<div class="grfTracker grfTrackerGraphe"><\/div>');i.jqTrackerGraphe.css({top:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.m_nTop,left:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.m_nLeft,width:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.getWidth(),height:n.m_oGraphe.m_oVue.m_oRenderer.m_rectChart.getHeight()});var s=n.m_oGraphe.m_oParametres.m_ePosLegende==IWDChartConstant.FLAG_LEGEND_POSITION_NONE,h=n.m_oGraphe.m_oParametres.m_ePosTitre==IWDChartConstant.FLAG_TITLE_POSITION_NONE,a=s||h;a&&(s&&(n.m_oGraphe.m_oParametres.m_ePosLegende=IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT),h&&(n.m_oGraphe.m_oParametres.m_ePosTitre=IWDChartConstant.FLAG_TITLE_POSITION_TOP),n.m_oGraphe.relanceInitialisation(),s&&(n.m_oGraphe.m_oParametres.m_ePosLegende=IWDChartConstant.FLAG_LEGEND_POSITION_NONE,y=$("#"+n.m_oGraphe.m_sAliasChamp+"-legende-groupe"),e=$("#"+n.m_oGraphe.m_sAliasChamp+"-clip-legende-rect")),h&&(n.m_oGraphe.m_oParametres.m_ePosTitre=IWDChartConstant.FLAG_TITLE_POSITION_NONE,f=$("#"+n.m_oGraphe.m_sAliasChamp+"-titre")));i.jqTrackerLegende=$('<div class="grfTracker grfTrackerLegende"><a class="grfFermer'+(s?" grfMasque":"")+'"><\/a><\/div>');i.jqTrackerTitre=$('<div class="grfTracker grfTrackerTitre"><a class="grfFermer'+(h?" grfMasque":"")+'"><\/a><\/div>');i.jqTrackerLegende.css({top:parseInt10(e.attr("y")),left:parseInt10(e.attr("x")),width:parseInt10(e.attr("width")),height:parseInt10(e.attr("height"))});v=f.wbData("wbGrfCacheDrawText");i.jqTrackerTitre.css({top:parseInt10(v[2]),left:parseInt10(f.offset().left-r.left),width:f[0].getBoundingClientRect().width,height:f[0].getBoundingClientRect().height});a&&n.m_oGraphe.relanceInitialisation();i.jqTous=i.jqTrackerGraphe.add(i.jqTrackerTitre).add(i.jqTrackerLegende);i.jqTous.children("a").click(function(){$(this).toggleClass("grfMasque");o()});i.jqTous.resizable({containment:c,stop:o,handles:"all"}).draggable({containment:c,stop:o}).css("position","absolute").insertAfter(u)}n.m_jqBurger.find("input").prop("checked",!1).trigger("change");t.preventDefault()}),this._bOptionVisible("SAV")&&(t.append($('<button class="grfEnregSAV" data-grfExec="OnSave">'+CHART_TOOLBAR.ALTTEXT.SAV+"<\/button>")),this.m_jqUlMenu.addClass("grfEnregSAV")),this._bOptionVisible("PRI")&&(t.append($('<button class="grfEnregPRI" data-grfExec="OnPrint">'+CHART_TOOLBAR.ALTTEXT.PRI+"<\/button>")),this.m_jqUlMenu.addClass("grfEnregPRI")))};WDChartAxisRenderer.prototype.constructor=WDChartAxisRenderer;WDChartAxisRenderer.prototype.getAxisSize=function(n){return this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL?n.getWidth():n.getHeight()};WDChartAxisRenderer.getAxisStep=WDChartAxisRenderer.prototype.getAxisStep=function(n,t,i,r){if(n==0)return 1;var f=Math.ceil(Math.log10(t/(5*n))),u=Math.pow(10,f);if(u*n<=t&&(u=2*u*n>t?2*u:5*u*n>t?5*u:10*u),i)switch(r){case ETimeScale.DATE:u=WDMathUtils.roundToMultiple(u,864e5);break;case ETimeScale.TIME:u=WDMathUtils.roundToMultiple(u,36e5);break;case ETimeScale.NONE:default:u=Math.ceil(u)}return u};WDChartAxisRenderer.prototype.getNbGraduations=function(){return this.m_nNbPositiveGraduations+this.m_nNbNegativeGraduations};WDChartAxisRenderer.prototype.getGraduationSize=function(n){var t=this.getNbGraduations();return t<=1?n:n/(t-1)};WDChartAxisRenderer.prototype.prepare=function(n,t,i,r,u){var k,ft,d,g,et,st,f,c,nt,at,tt,e,h,lt,yt,rt;if(this.m_axis=n,this.m_axis.m_type!==EAxisType.Z){var ut=this.getAxisSize(i),w=0,b=0;u!=ETimeScale.NONE?(k=n.m_oModele.m_oCategories,k.getNbValues()>0&&(w=k.getMinValueInMillis(),b=k.getMaxValueInMillis())):(w=this.m_axis.m_dMinValue,b=this.m_axis.m_dMaxValue);ft=0;ft=this.m_axis.isXAxis()?t.getAxisLabelOrientation(this.m_axis)==WDChartParameters.eOrientationVerticale?IWDChartConstant.GRADUATION_MIN_SIZE_X_VERTICAL:IWDChartConstant.GRADUATION_MIN_SIZE_X_HORIZONTAL:IWDChartConstant.GRADUATION_MIN_SIZE_Y;d=0;g=b-w;g>0&&(d=ut/g);this.m_dStep=t.getAxisStep(this.m_axis);et=this.m_axis.isDisplayDecimalValues(t);(this.m_dStep==IWDChartConstant.DEFAULT_VALUE||u!=ETimeScale.NONE)&&(this.m_dStep=this.getAxisStep(d,ft,!et,u));var o=0,s=0,v=0,ot=this.isDrawLabelsBetweenGraduations();if(this.m_dStep!=0?(s=Math.floor(w/this.m_dStep)*this.m_dStep,v=Math.ceil(b/this.m_dStep)*this.m_dStep,this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle>0&&(st=Math.ceil(this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle/d),v+=st),s<0?(this.m_axis.m_oModele.m_oGraphe.m_oVue.m_oRenderer.m_dRayonMaxBulle>0&&(s-=st),this.m_nNbNegativeGraduations=Math.abs(s)/this.m_dStep,this.m_nNbPositiveGraduations=v>=0?Math.ceil(v/this.m_dStep)+1:1,this.m_axis.m_dOriginValue=0):(this.m_nNbNegativeGraduations=0,this.m_nNbPositiveGraduations=Math.ceil((v-s)/this.m_dStep)+1,this.m_axis.m_dOriginValue=s),ot&&this.isDrawnZero()&&this.m_nNbPositiveGraduations++):(this.m_nNbNegativeGraduations=this.m_nNbPositiveGraduations=0,this.m_axis.m_dOriginValue=0),o=this.getNbGraduations(),this.m_tabGraduationLabels=[],f=0,this.m_axis.isDisplayCategories()){c=this.m_axis.m_oModele;switch(u){case ETimeScale.DATE:case ETimeScale.TIME:for(nt=c.getCategoryIndexForTime(Math.floor(this.m_axis.m_dOriginValue)),at=c.m_oCategories.getMinValueInMillis(),f=0;f<o;++f)tt=new Date,tt.setTime(at+(f*this.m_dStep+nt)),this.m_tabGraduationLabels[f]=u==ETimeScale.TIME?clWDUtil.sHeureVersChaine(clWDUtil.sGetDateHeureWL(tt,!1,!1,!0),t.m_sMasqueAxeTemporel||c.m_oCategories.sGetFormatHeureDefaut("HH:MM:SS:CC")):clWDUtil.sDateVersChaine(clWDUtil.sGetDateHeureWL(tt,!1,!0,!1),t.m_sMasqueAxeTemporel||c.m_oCategories.sGetFormatDateDefaut("DD/MM/YYYY"));break;default:case ETimeScale.NONE:for(nt=Math.floor(this.m_axis.m_dOriginValue),f=0;f<o;++f)this.m_tabGraduationLabels[f]=c.getCategoryLabelAt(f*this.m_dStep+nt)}}else{var vt=this.m_axis.hasMasqueAxeY()?t.m_sMasqueAxes:undefined,ht=s,y=this.m_axis.isXAxis()?t.m_tabHmLibelleX:t.m_tabHmLibelleY;for(f=0;f<o;++f)this.m_tabGraduationLabels[f]=y&&(y[f]||y[f+"."])?y[f]||y[f+"."]:vt?WDChartUtils.formatValue(ht,vt,et):ht,ht+=this.m_dStep}if(o<=0){this.m_dTopOverflow=this.m_dLeftOverflow=this.m_dRightOverflow=this.m_dBottomOverflow=0;return}var p=[],it=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,"0",["lineHeight","width"]),l=parseInt10(it.lineHeight),a=0,ct=0,pt=it.width;for(f=0;f<o;++f)e=this.m_tabGraduationLabels[f],e===undefined&&(e=""),h=0,(e||e===0)&&!isNaN(parseInt10(e))?h=pt*(""+e).length:clWDUtil.bEstChaineNonVide(e)&&(it=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,e,"width"),h=it.width),h>a&&(a=h),p[f]=h,f>0&&(ct+=IWDChartConstant.MARGIN_HORIZONTAL_GRADUATION_LABEL),ct+=h;lt=t.getAxisLabelOrientation(this.m_axis);lt==WDChartParameters.eOrientationDefaut?this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL?(yt=this.getGraduationSize(ut),this.m_bVerticalOrientationLabel=a+a/10>yt||ct>ut):this.m_bVerticalOrientationLabel=!1:this.m_bVerticalOrientationLabel=lt==WDChartParameters.eOrientationVerticale;t.isAxisVisible(this.m_axis)?this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL&&this.m_tabGraduationLabels.join("").length>0?(this.m_dLeftOverflow=this.m_bVerticalOrientationLabel?l/2:p[0]/2,this.m_dRightOverflow=this.m_bVerticalOrientationLabel?l/2:p[Math.max(0,o-(ot?2:1))]/2,this.m_dBottomOverflow=this.m_bVerticalOrientationLabel?a:l,this.m_dBottomOverflow+=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,this.m_dTopOverflow=0,this.m_axis.isSecondaryAxis()&&(rt=this.m_dBottomOverflow,this.m_dBottomOverflow=this.m_dTopOverflow,this.m_dTopOverflow=rt)):this.m_axis.m_orientation==EAxisOrientation.VERTICAL&&(this.m_dTopOverflow=this.m_bVerticalOrientationLabel?p[Math.max(0,o-(ot?2:1))]/2:l/2,this.m_dBottomOverflow=this.m_bVerticalOrientationLabel?p[0]/2:l/2,this.m_dLeftOverflow=this.m_bVerticalOrientationLabel?l:a,this.m_dBottomOverflow+=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,this.m_dRightOverflow=0,this.m_axis.isSecondaryAxis()&&(rt=this.m_dLeftOverflow,this.m_dLeftOverflow=this.m_dRightOverflow,this.m_dRightOverflow=rt)):this.m_dTopOverflow=this.m_dLeftOverflow=this.m_dRightOverflow=this.m_dBottomOverflow=0}};WDChartAxisRenderer.prototype.getPixelsPerUnit=function(n){return this.m_dStep==0?0:this.getGraduationSize(this.getAxisSize(n))/this.m_dStep};WDChartAxisRenderer.prototype.draw=function(n,t,i,r,u,f,e,o){var c=0,nt,tt,s,h,ft,it,vt,yt,k,lt,kt,w,b,d,l,rt,ht,v,at,p;if(this.m_axis){nt=Align.LEFT;tt=i.getAxisTitle(this.m_axis);tt&&(ft=WDPaintCSS.oGetInfoCSS(i.m_sClasseAxe,tt,"lineHeight"),it=parseInt10(ft.lineHeight),this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL?(s=u.getLeft()+u.getWidth()/2,nt=Align.CENTER,h=this.m_axis.isSecondaryAxis()?r.getTop():r.getBottom()-it,vt=n.text(t,"axe-titre-horiz"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.addClasse(i.m_sClasseAxe),n.drawText(vt,tt,it,s,h,nt,o,!1)):(h=u.getTop()+u.getHeight()/2,nt=Align.CENTER,s=this.m_axis.isSecondaryAxis()?r.getRight()-it:r.getLeft(),yt=n.text(t,"axe-titre-vert"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.addClasse(i.m_sClasseAxe),n.drawTextVertically(yt,tt,it,s,h,nt,o,!1)));var et=i.m_sCouleurAxe,ct=this.getNbGraduations(),ot=this.getAxisSize(u),pt=this.isDrawLabelsBetweenGraduations(),wt=ct,ft=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,"Ap","lineHeight"),a=parseInt10(ft.lineHeight);if(this.m_axis.m_orientation==EAxisOrientation.HORIZONTAL){var s=u.getLeft(),y=this.getGraduationSize(ot),h=this.m_axis.isSecondaryAxis()?u.getTop():i.isBoursierChart()?u.getBottom():e;for(this.isDrawnAxisLine()&&(b=n.line(t,"axe-horiz"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.setStroke(et),n.SetAntiAliasing(!1,b),n.drawLine(b,s,h,s+ot,h,o,!1)),k=s,c=0;c<ct;++c){if(c>0&&Math.abs(s-k)<=5+a){s+=y;continue}k=s;d=n.line(t,"axe-graduation-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c);o.setStroke(et);n.SetAntiAliasing(!1,d);n.drawLine(d,s,h,s,h-IWDChartConstant.GRADUATION_TICK_SIZE,o,!1);s+=y}s=u.getLeft();k=s;var bt=this.m_axis.m_dMinValue,g=bt-this.m_dStep,st=!1;for(c=0;c<wt;++c){if(g+=this.m_dStep,st&&Math.abs(s-k)<=5+a){s+=y;continue}if((g!=0||this.isDrawnZero())&&(k=s,st=!0,l=this.m_tabGraduationLabels[c],l=l===undefined?"":""+l,rt=a*l.split("\n").length,!(isNaN(parseInt10(l))&&!clWDUtil.bEstChaineNonVide(l)))){if(v=s,pt&&(v+=y/2),v>u.m_nRight)break;this.m_bVerticalOrientationLabel?(w=0,this.m_axis.isSecondaryAxis()?(lt=a,l.length>1&&(kt=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,l.replace(/\n/g,"<br>"),"width"),lt=parseInt10(kt.width)),w=-(IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL+lt)):w=IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-horiz-label-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawTextVertically(p,l,a,v-rt/2,h+w,Align.RIGHT,o,!1)):(w=0,w=this.m_axis.isSecondaryAxis()?-(IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL+a):IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-horiz-label-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawText(p,l,a,v,h+w,Align.CENTER,o,!1));p.wbData("wbGrfGraduationValeur",g);s+=y}}}else{var h=u.getBottom(),y=this.getGraduationSize(ot),s=this.m_axis.isSecondaryAxis()?u.getRight():f;this.isDrawnAxisLine()&&(b=n.line(t,"axe-vert"+(this.m_axis.isSecondaryAxis()?"-2":"")),o.setStroke(et),n.SetAntiAliasing(!1,b),n.drawLine(b,s,h,s,h-ot,o,!1));var ft=WDPaintCSS.oGetInfoCSS(i.m_sClasseLibelle,"0","lineHeight"),a=parseInt10(ft.lineHeight),ut=h;for(c=0;c<ct;++c){if(c>0&&Math.abs(h-ut)<=5+a){h-=y;continue}ut=h;d=n.line(t,"axe-graduation-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c);o.setStroke(et);n.SetAntiAliasing(!1,d);n.drawLine(d,s,h,s+IWDChartConstant.GRADUATION_TICK_SIZE,h,o,!1);h-=y}h=u.getBottom();ut=h;var bt=this.m_axis.m_dMinValue,g=bt-this.m_dStep,st=!1;for(c=0;c<wt;++c){if(g+=this.m_dStep,st&&Math.abs(h-ut)<=5+a){h-=y;continue}(g!=0||this.isDrawnZero())&&(ut=h,st=!0,l=this.m_tabGraduationLabels[c],l=l===undefined?"":""+l,rt=a*l.split("\n").length,isNaN(parseInt10(l))&&!clWDUtil.bEstChaineNonVide(l)||(ht=h,v=0,pt&&(ht-=y/2),this.m_bVerticalOrientationLabel?(v=this.m_axis.isSecondaryAxis()?s+IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL:s-rt-IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL,p=n.text(t,"axe-vert-label-vert-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawTextVertically(p,l,a,v,ht,Align.CENTER,o,!1)):(this.m_axis.isSecondaryAxis()?(at=Align.LEFT,v=s+IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL):(at=Align.RIGHT,v=s-IWDChartConstant.MARGIN_AXIS_GRADUATION_LABEL),p=n.text(t,"axe-vert-label-horiz-"+(this.m_axis.isSecondaryAxis()?"-2":"")+c),o.addClasse(i.m_sClasseLibelle),o.DesactivePointerEvents(),n.drawText(p,l,a,v,ht-rt/2,at,o,!1)),p.wbData("wbGrfGraduationValeur",g),h-=y))}}}};WDChartAxisRenderer.prototype.isDrawnZero=function(){return!0};WDChartAxisRenderer.prototype.isDrawnAxisLine=function(){return!0};WDBarChartRenderer.prototype=new WDXYChartRenderer;WDBarChartRenderer.prototype.constructor=WDBarChartRenderer;WDBarChartRenderer.prototype.createAxisRenderer=function(){return new WDBarChartAxisRenderer(this)};WDBarChartRenderer.bParametresSupportes=function(n,t){var i,r;if(!WDXYChartRenderer.bParametresSupportes(n,t))return!1;for(i=0,r=0;r<t.m_tabSeries.length;++r)i=Math.max(i,t.m_tabSeries[r].getNbValues());return t.m_oCategories.m_tabValeur=t.m_oCategories.m_tabValeur.slice(0,i),t.m_oCategories.m_tabValeurMS&&t.m_oCategories.m_tabValeurMS.length&&(t.m_oCategories.m_tabValeurMS=t.m_oCategories.m_tabValeurMS.slice(0,i)),!0};WDBarChartRenderer.prototype._animStopColor=function(n,t,i,r,u){var f,o,s,e;r!=!!t.wbData("wbGrfSurbrillanceSerieDepuisMire")&&(f=t[0].attributes.stroke?t[0].attributes.stroke.value||i:i,r&&t.wbData("wbGrfSurbrillanceSerieDepuisMire",{"stop-color":i,stroke:f,fill:i}),u=u||clWDUtil.sCouleurHTMLPlusBrillante(i,.1),u=="#ffffff"&&(u=WDChartRenderer.crPlusFonce(i)),t.wbData("wbGrfSurbrillanceSerieDepuisMireInit")===undefined&&t.wbData("wbGrfSurbrillanceSerieDepuisMireInit",{"stop-color":i,stroke:f,fill:i}),r||(o=t[0].attributes.fill?t[0].attributes.fill.value:undefined,s=t[0].attributes["stop-color"]?t[0].attributes["stop-color"].value:undefined),e=new WDSvgAnimation(this.m_oGraphe,n,t,r?t.wbData("wbGrfSurbrillanceSerieDepuisMire"):{"stop-color":s,stroke:f,fill:o},r?{"stop-color":u,stroke:u,fill:u}:t.wbData("wbGrfSurbrillanceSerieDepuisMireInit")),e.duration=r?100:300,r||(e.m_fFinAnimation=function(){t.wbRemoveData("wbGrfSurbrillanceSerieDepuisMire")}),e.run())};WDBarChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var a,v,y,o,f,nt,e;for(WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments),v=this.m_params.getGradientType()!=IWDChartConstant.FLAG_NO_GRADIENT,y=this.m_params.getType()==WDChartParameters.kMinMax,o=0;(a=n.findFromId(n.m_domBaliseSVG,"groupe-serie-"+o)).length;++o)for(f=a[0].firstChild;f;f=f.nextSibling){y&&(f=f.firstChild);var u=$(f),s=[],p=[],c=[];if(v){var tt=n.findFromId(n.m_domBaliseSVG,u.wbData("wbGrfGradientId"),!0),l=tt[0].childNodes,w=l[0],b=l[l.length-1];c=c.concat([$(w),$(b)]);s=s.concat([w.attributes["stop-color"].value,b.attributes["stop-color"].value])}else{var h=undefined,k=undefined,d=u.wbData("wbGrfGrInfoXY"),g=d?d[IWDChartConstant.GR_CATEGORIE]:undefined;g!==undefined&&(h=this.m_oGraphe.m_oModele.getCategoryColor(g,!0));h==undefined&&(h=this.m_oGraphe.m_oModele.getSeriesColor(o));u.wbData("wbGrfDrawMire")&&(u.wbData("wbGrfDrawMire").couleur!==undefined&&(h=u.wbData("wbGrfDrawMire").couleur),u.wbData("wbGrfDrawMire").couleurDestination!==undefined&&(k=u.wbData("wbGrfDrawMire").couleurDestination));p.push(k);s.push(h);c.push(u)}for(nt=i&&r===o||u.is("rect:hover")||u.is("rect.wbGrfHover"),e=0;e<s.length;++e)this._animStopColor(n,c[e],s[e],nt,p[e])}};WDBarChartRenderer.prototype.drawChart=function(){WDXYChartRenderer.prototype.drawChart.apply(this,arguments);this.m_tabCumulatedValues=undefined};WDBarChartRenderer.prototype.isClipOnAxisRectBeforeDrawingChart=function(){return!this.m_oModele.m_oParametres.isDisplayValuesLabel()};WDBarChartRenderer.prototype.prepareRendering=function(n,t,i,r){var u,f,e,o,s;if(WDXYChartRenderer.prototype.prepareRendering.apply(this,arguments)){if(this.m_nBarSpacing=r.m_nEspacement,u=this.getAxisRendererForType(EAxisType.X),f=u.getGraduationSize(u.getAxisSize(this.m_rectAxis)),f-2*this.m_nBarSpacing<IWDChartConstant.BAR_MIN_WIDTH&&(this.m_nBarSpacing=IWDChartConstant.BAR_MIN_SPACING),f-=2*this.m_nBarSpacing,this.m_nBarWidth=r.isStackedBarChart()||r.isBoursierChart()?f:Math.max(1,Math.floor(f/this.m_oModele.m_tabSeries.length)),u.m_dStep!=1){e=u.m_dStep;switch(this.m_timeScale){case ETimeScale.DATE:o=Math.round(e/864e5);this.m_nBarWidth=Math.round(this.m_nBarWidth/o);break;case ETimeScale.TIME:s=Math.round(e/36e5);this.m_nBarWidth=Math.round(this.m_nBarWidth/s);break;case ETimeScale.NONE:this.m_nBarWidth=this.m_nBarWidth/Math.round(e)}this.m_nBarWidth=Math.max(1,this.m_nBarWidth)}return!0}return!1};WDBarChartRenderer.prototype.createBarGradient=function(n,t){var i={couleurDebut:n,couleurFin:clWDUtil.sCouleurHTMLPlusBrillante(n),spreadMethod:"pad"};switch(t){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:i.bVertical=!0;break;case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:i.bVertical=!1;break;default:return null}return i};WDBarChartRenderer.prototype.getBarBorderColor=function(n,t){return t.isBorderColorAuto()?clWDUtil.sCouleurHTMLPlusBrillante(n):t.m_sCouleurBordure};WDBarChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var bt=this.m_oModele.getAxisByType(EAxisType.X),ut=r.getNbValues(),y=u.isStackedBarChart(),kt=this.m_oModele.m_tabSeries.length,ht=i,ct,dt,v,f,at,pt,it,rt,nt,w,p,st;if(this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||(t.empty(),nt=n.findFromId(n.m_domBaliseSVG,"barre-texte"),nt.length&&(w=n.findFromId(nt,"barre-texte-"+i),w.length&&w.empty())),y)for(v=0;v<kt;++v)ut=Math.max(this.m_oModele.m_tabSeries[v].getNbValues(),ut);if(ct=this.getDrawnValuesCount(ut,bt),ct!=0){y&&this.m_tabCumulatedValues===undefined&&(this.m_tabCumulatedValues=[]);var lt=this.m_oModele.getSeriesColor(i),ri=this.getBarBorderColor(lt,u),ui=this.createBarGradient(lt,u.getGradientType()),o=0,ft,et=u.isDisplayValuesLabel()&&!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();et&&(ft=this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,dt=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),o=parseInt10(dt.fontSize));var gt=u.m_bAfficheSiNulle,ni=r.isOnSecondaryAxis(),fi=this.getYOriginValue(ni),e=this.getFirstDrawnCategoryIndex(bt);for(v=0;v<ct;++v,++e)if(!(e<0)){if(e>=ut)break;f=r.getValueAt(e);at=r.getValueAtWithNull(e)===undefined;f=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,f,e,i);this.getBarRect(this.m_barRect,f,ht,e,fi,y,ni,u);var b=this.m_barRect.getLeft(),s=this.m_barRect.getTop(),h=this.m_barRect.getWidth(),c=this.m_barRect.getHeight(),vt=n.rect(t,"series-"+i+"-barre-"+e),tt=1;if(h>0&&c>0){et&&n.clipRect(this.m_rectAxis,"clip-axes");var ot=lt,yt=ri,k=ui,ti=this.m_oModele.getCategoryColor(e,!0);ti&&(ot=ti,yt=this.getBarBorderColor(ot,u),k=this.createBarGradient(ot,u.getGradientType()));k?this.m_oPaint.setLinearGradient(k.couleurDebut,k.couleurFin,k.spreadMethod,k.bVertical):this.m_oPaint.setFill(ot);pt=this.getSeriesAlphaAt(i);pt<255?this.m_oPaint.setFillOpacity255(pt):this.m_oPaint.setFillOpacity255(255);this.m_oPaint.setStroke(yt,tt);tt>0&&yt&&(!y||ht>0&&e<this.m_tabCumulatedValues.length)&&(it=0,(y?this.m_tabCumulatedValues[e]:f)>0?it=1:y&&(it=-1),it!=0&&(rt=tt*it/2,u.m_bAxeXHorizontal?(s+=rt,c-=rt):(b+=rt,h-=rt)));n.drawRect(vt,new WDRect(b,s,b+h,s+c),this.m_oPaint);vt.wbData("wbGrfGrInfoXY",[i,v,f]);et&&n.restoreClip()}else vt.remove();if(nt=n.g(t.parent().parent(),"barre-texte"),w=n.g(nt,"barre-texte-"+i),et){this.m_oPaint.addClasse(u.m_sClasseValeur);var st=n.text(w,"barre-"+i+"-texte-"+e),l,a,d,g=Align.CENTER,wt=!0,ii=!0;(u.m_bAxeXHorizontal?f>=0&&this.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||f<0&&this.m_barRect.m_nBottom-this.m_rectAxis.m_nBottom>1:f>=0&&this.m_barRect.m_nRight-this.m_rectAxis.m_nRight>1||f<0&&this.m_rectAxis.m_nLeft-this.m_barRect.m_nLeft>1)?wt=!1:(u.m_bAxeXHorizontal?c-2*tt<=o:h-2*tt<=o)&&(ii=!1);y?(p=this.m_tabCumulatedValues[e],wt&&(ii||at&&gt)&&(d=WDChartUtils.formatValue(p>0?Math.abs(f):Math.abs(f)*-1,ft,!0),l=s+(c-o)/2,a=b+h/2,this.m_oPaint.DesactivePointerEvents(),n.drawText(st,d,o,a,l,g,this.m_oPaint)),ht==kt-1&&(this.m_oPaint.addClasse(u.m_sClasseValeur),st=n.text(w,"barre-"+i+"-texte-total-"+e),d=WDChartUtils.formatValue(p,ft,!0),l=p<0?s+c:s-o,a=b+h/2,u.m_bAxeXHorizontal?l+=p<0?IWDChartConstant.MARGIN_LABEL:-IWDChartConstant.MARGIN_LABEL:(l=s+(c-o)/2,a+=(p<0?-1:1)*(h/2+IWDChartConstant.MARGIN_LABEL),g=p<0?Align.RIGHT:Align.LEFT),this.m_oPaint.DesactivePointerEvents(),n.drawText(st,d,o,a,l,g,this.m_oPaint))):wt&&(!at||gt)&&(d=WDChartUtils.formatValue(f,ft,!0),l=f<0?s+c+IWDChartConstant.MARGIN_LABEL:s-o-IWDChartConstant.MARGIN_LABEL,a=b+h/2,u.m_bAxeXHorizontal||(f<0?(l=s+c/2-o/2,a-=IWDChartConstant.MARGIN_LABEL+h/2,g=Align.RIGHT):(l=s+c/2-o/2,a+=IWDChartConstant.MARGIN_LABEL+h/2,g=Align.LEFT)),this.m_oPaint.DesactivePointerEvents(),n.drawText(st,d,o,a,l,g,this.m_oPaint))}}}};WDBarChartRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o){var a=this.dGetYPixelsPerUnit(e),c=Math.ceil((t>0?Math.max(0,t-u):Math.abs(t))*a),l=0,h=0,s;o.m_bAxeXHorizontal?l=this.getCategoryDrawingPositionX(r,e)+this.m_nBarSpacing:(h=this.getCategoryDrawingPositionY(r,e,!1)-this.m_nBarSpacing,f&&(h-=this.m_nBarWidth));f?(s=0,i>0&&r<this.m_tabCumulatedValues.length?(s=this.m_tabCumulatedValues[r],s>0?(o.m_bAxeXHorizontal?h=this.nGetYOrigin(e)-Math.ceil(Math.max(0,s-u)*a)-c:l=this.nGetXOrigin(e)+Math.ceil(Math.max(0,s-u)*a),s+=Math.abs(t)):s<0?(o.m_bAxeXHorizontal?h=this.nGetYOrigin(e)+Math.ceil(Math.abs(s)*a):l=this.nGetXOrigin(e)-Math.ceil(Math.abs(s)*a)-c,s-=Math.abs(t)):(s=t,o.m_bAxeXHorizontal?h=t>0?this.nGetYOrigin(e)-c:this.nGetYOrigin(e):l=t<0?this.nGetXOrigin(e)-c:this.nGetXOrigin(e))):(s=t,o.m_bAxeXHorizontal?h=t>0?this.nGetYOrigin(e)-c:this.nGetYOrigin(e):l=t<0?this.nGetXOrigin(e)-c:this.nGetXOrigin(e)),this.m_tabCumulatedValues[r]=s):o.m_bAxeXHorizontal?(l+=this.m_nBarWidth*i,h=t>0?this.nGetYOrigin(e)-c:this.nGetYOrigin(e)):(h-=this.m_nBarWidth*i,h-=this.m_nBarWidth,l=t>0?this.nGetXOrigin(e):this.nGetXOrigin(e)-c);o.m_bAxeXHorizontal?n.setSizeAndLocation(l,h,this.m_nBarWidth,c):n.setSizeAndLocation(l,h,c,this.m_nBarWidth)};WDBarChartAxisRenderer.prototype=new WDChartAxisRenderer;WDBarChartAxisRenderer.prototype.constructor=WDBarChartAxisRenderer;WDBarChartAxisRenderer.prototype.constructor=WDBarChartAxisRenderer;WDBarChartAxisRenderer.prototype.isDrawLabelsBetweenGraduations=function(){var n=this.m_axis.m_type;return this.m_dStep==1&&(n==EAxisType.X||n==EAxisType.X2)};WDBarChartAxisRenderer.prototype.prepare=function(n,t,i){var o,h,s,u,f;if(WDChartAxisRenderer.prototype.prepare.apply(this,arguments),n.isYAxis()&&t.isDisplayValuesLabel()){var r=n.m_dMinValue,e=n.m_dMaxValue,c=WDPaintCSS.oGetInfoCSS(t.m_sClasseLibelle,Math.abs(r)>Math.abs(e)?r:e,["lineHeight","width"]),l=parseInt10(c.lineHeight),a=parseInt10(c.width),v=this.getGraduationSize(this.getAxisSize(i));e>0&&(o=(this.m_nNbPositiveGraduations-1)*v,n.m_orientation==EAxisOrientation.HORIZONTAL?(u=Math.ceil(e*this.getPixelsPerUnit(i))+a,u>o&&(this.m_dRightOverflow+=u-o)):(h=e,t.isBoursierChart()&&r>0&&(h-=r),f=Math.ceil(h*this.getPixelsPerUnit(i))+l,f>o&&(this.m_dTopOverflow+=f-o)));r<0&&(s=this.m_nNbNegativeGraduations*v,n.m_orientation==EAxisOrientation.HORIZONTAL?(u=Math.ceil(Math.abs(r)*this.getPixelsPerUnit(i))+a,u>s&&(this.m_dLeftOverflow+=u-s)):(f=Math.ceil(Math.abs(r)*this.getPixelsPerUnit(i))+l,f>s&&(this.m_dBottomOverflow+=f-s)))}};WDFunnelChartRenderer.nGetIndicePart=function(n,t){return WDPieChartRenderer.nGetIndicePart(n,t)};WDFunnelChartRenderer.bParametresSupportes=function(n,t){return WDChartRenderer.bParametresSupportes(n,t)?!0:!1};WDFunnelChartRenderer.prototype=new WDChartRenderer;WDFunnelChartRenderer.prototype.constructor=WDFunnelChartRenderer;WDFunnelChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var e,u,f;if(i||r===!0)for(e=t,u=0;u<this.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length;++u)f=Array.prototype.slice.call(arguments,0),f[1]=u,f[2]=e==u?i:!1,WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,f);else WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments)};WDFunnelChartRenderer.prototype.Init=function(){WDChartRenderer.prototype.Init.apply(this,arguments)};WDFunnelChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDPieChartLegendListener,this.m_oGraphe,n)};WDFunnelChartRenderer.eEntonnoirHauteur=0;WDFunnelChartRenderer.eEntonnoirAire=1;WDFunnelChartRenderer.FACTEUR_COURBURE_3D=15;WDFunnelChartRenderer.STInfoPortion=function(){this.m_dY=0;this.m_dHauteurBoutTraverse=0;this.m_dHauteurBoutDroit=0;this.m_dLargeurBase1=0;this.m_dLargeurBase2=0;this.m_dAire=0;this.m_dValeur=0;this.m_nNumCategorie=0};WDFunnelChartRenderer.STInfoPortion.prototype.constructor=WDFunnelChartRenderer.STInfoPortion;WDFunnelChartRenderer.prototype.drawChart=function(n,t,i){var r,u,e,f;if((WDChartRenderer.prototype.drawChart.apply(this,arguments),this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),r=n.g(i,"groupe-serie-0"),this.m_rectChart.getWidth()!=0&&this.m_rectChart.getHeight()!=0)&&(this.bGetPremiereValeurNonDessinee()&&(this.m_params.m_bPremiereValeurNonDessinee=!1,u=n.findFromId(n.m_domBaliseSVG,"legende-groupe-0"),e=n.arc(r,"part-0"),u&&u.clearQueue().finish().css("opacity",.5).find("text").css("text-decoration","line-through"),this.m_oGraphe.m_oVue.setSerieMasquee(0,!1),f=new WDPieChartAnimationSelectionLegende(this.m_oGraphe,n,e,u),f.m_dNow=1,this.m_oGraphe.m_oVue.m_oAnimator.add(f,!1,!0)),this.__bCalculeVariables(n,t,r))&&this.__bCalculeAireDonnees(n,t,r)){switch(this.eGetAlgoEntonnoir()){case WDFunnelChartRenderer.eEntonnoirHauteur:if(!this.__bCalculePortions_Hauteur())return;break;case WDFunnelChartRenderer.eEntonnoirAire:if(!this.__bCalculePortions_Aire())return}!this.__bDessinePortions(n,t,r)}};WDFunnelChartRenderer.prototype.nGetPourcentageHauteurEmbout=function(){return this.m_params.m_nPourcentageHauteurEmbout===undefined?10:this.m_params.m_nPourcentageHauteurEmbout};WDFunnelChartRenderer.prototype.nGetPourcentageLargeurEmbout=function(){return this.m_params.m_nPourcentageLargeurEmbout===undefined?10:this.m_params.m_nPourcentageLargeurEmbout};WDFunnelChartRenderer.prototype.bGetPremiereValeurNonDessinee=function(){return this.m_params.m_bPremiereValeurNonDessinee===undefined?!1:this.m_params.m_bPremiereValeurNonDessinee};WDFunnelChartRenderer.prototype.__bCalculeVariables=function(n,t,i){var r=new WDRect(this.m_rectChart),h=this.m_rectChart.m_nLeft,f=this.m_rectChart.m_nTop,e,o,s,u;for(f=parseInt10(f+r.getWidth()/WDFunnelChartRenderer.FACTEUR_COURBURE_3D/2),r.setLocation(h,f,!0),r.setSize(r.getWidth(),parseInt10(r.getHeight()-r.getWidth()/WDFunnelChartRenderer.FACTEUR_COURBURE_3D/2)),this.m_nHauteurEmbout=parseInt10(r.getHeight()*this.nGetPourcentageHauteurEmbout()/100),this.m_nLargeurEmbout=parseInt10(r.getWidth()*this.nGetPourcentageLargeurEmbout()/100),(this.m_nLargeurEmbout==0||this.m_nHauteurEmbout==0)&&(this.m_nLargeurEmbout=0,this.m_nHauteurEmbout=0),e=this.m_nHauteurEmbout*this.m_nLargeurEmbout,o=(r.getWidth()+this.m_nLargeurEmbout)*(r.getHeight()-this.m_nHauteurEmbout)/2,this.m_nAireTotaleUtile=e+o,this.m_dSommeValeurs=0,s=this.m_oModele.m_tabSeries[0].getNbValues(),u=0;u<s;++u)this.m_dSommeValeurs+=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,u)),u,0);return this.m_clRectCalcul=r,this.m_dSommeValeurs!=0};WDFunnelChartRenderer.prototype.__EmptyPortions=function(){for(var n=0;n<this.m_clTabPortions.length;++n)delete this.m_clTabPortions[n];this.m_clTabPortions=[]};WDFunnelChartRenderer.prototype.__bCalculeAireDonnees=function(n,t,i){var f,r;for(this.__EmptyPortions(),f=this.m_oModele.m_tabSeries[0].getNbValues(),r=0;r<f;++r){var e=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),r,0),o=e/this.m_dSommeValeurs,s=this.m_nAireTotaleUtile*o,u=new WDFunnelChartRenderer.STInfoPortion;u.m_dAire=s;u.m_nNumCategorie=r;u.m_dValeur=e;this.m_clTabPortions.push(u)}return!0};WDFunnelChartRenderer.prototype.nGetEspacement=function(){return this.m_params.m_nEspacement};WDFunnelChartRenderer.prototype.eGetAlgoEntonnoir=function(){return this.m_params.m_eAlgoEntonnoir===undefined?WDFunnelChartRenderer.eEntonnoirHauteur:this.m_params.m_eAlgoEntonnoir};WDFunnelChartRenderer.prototype.__bCalculePortions_Hauteur=function(){for(var n,t,f,o=this.m_clRectCalcul.getHeight(),r=2*(this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout)/(this.m_clRectCalcul.getWidth()-this.m_nLargeurEmbout),i=0,u=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout,e=0;e<this.m_clTabPortions.length;++e)(n=this.m_clTabPortions[e],n.m_dValeur!=0)&&(n.m_dY=i,t=o*(n.m_dValeur/this.m_dSommeValeurs),f=0,i=n.m_dY+t,n.m_dY>u?(f=t,t=0):i>u&&(f=i-u,t=t-(i-u)),n.m_dHauteurBoutDroit=f,n.m_dHauteurBoutTraverse=t,n.m_dHauteurBoutDroit==0?(n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/r,n.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*i/r):n.m_dHauteurBoutTraverse!=0?(n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/r,n.m_dLargeurBase2=this.m_nLargeurEmbout):(n.m_dLargeurBase1=this.m_nLargeurEmbout,n.m_dLargeurBase2=this.m_nLargeurEmbout));return this.__CalculeEspacement(r),!0};WDFunnelChartRenderer.prototype.__CalculeEspacement=function(n){for(var t,i=0,r=0;r<this.m_clTabPortions.length;++r)(t=this.m_clTabPortions[r],t.m_dValeur!=0)&&(t.m_dY+=this.nGetEspacement()/2,t.m_dHauteurBoutDroit==0?t.m_dHauteurBoutTraverse-=this.nGetEspacement()/2:t.m_dHauteurBoutDroit-=this.nGetEspacement()/2,t.m_dHauteurBoutTraverse!=0?(t.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*t.m_dY/n,t.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*(t.m_dY+t.m_dHauteurBoutTraverse)/n,i=t.m_dLargeurBase2):(t.m_dLargeurBase1=i,t.m_dLargeurBase2=i))};WDFunnelChartRenderer.prototype.__bCalculePortions_Aire=function(){for(var n,u,e,i=2*(this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout)/(this.m_clRectCalcul.getWidth()-this.m_nLargeurEmbout),t=0,f=!1,r=0;r<this.m_clTabPortions.length;++r)if(n=this.m_clTabPortions[r],n.m_dValeur!=0){if(n.m_dY=t,f){u=this.m_nLargeurEmbout!=0?n.m_dAire/this.m_nLargeurEmbout:0;n.m_dHauteurBoutDroit=u;t=n.m_dY+u;continue}t=this.__dCalculeYSuivant(n.m_dY,n.m_dAire,i);t>this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout||t==-1?(t==-1&&(t=0),n.m_dHauteurBoutTraverse=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout-n.m_dY,n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/i,n.m_dLargeurBase2=this.m_nLargeurEmbout,e=n.m_dAire-this.__dCalculAireTrapeze(n.m_dY,this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout,i),n.m_dHauteurBoutDroit=this.m_nLargeurEmbout!=0?e/this.m_nLargeurEmbout:0,t=this.m_clRectCalcul.getHeight()-this.m_nHauteurEmbout+n.m_dHauteurBoutDroit,f=!0):(n.m_dHauteurBoutTraverse=t-n.m_dY,n.m_dLargeurBase1=this.m_clRectCalcul.getWidth()-2*n.m_dY/i,n.m_dLargeurBase2=this.m_clRectCalcul.getWidth()-2*t/i)}return this.__CalculeEspacement(i),!0};WDFunnelChartRenderer.prototype.__dCalculeYSuivant=function(n,t,i){if(i==0)return-1;var s=this.m_clRectCalcul.getWidth(),c=-t-s*n+n*n/i,r=s,u=-1/i,f=r*r-4*u*c;if(f<0)return-1;if(f==0)return-r/2*u;var h=Math.sqrt(f),e=(-r-h)/(2*u),o=(-r+h)/(2*u);return e>0&&e<this.m_clRectCalcul.getHeight()?e:o>0&&o<this.m_clRectCalcul.getHeight()?o:-1};WDFunnelChartRenderer.prototype.__dCalculAireTrapeze=function(n,t,i){var r=this.m_clRectCalcul.getWidth()-2*n/i,u=this.m_clRectCalcul.getWidth()-2*t/i;return(r+u)*(t-n)/2};WDFunnelChartRenderer.prototype.__bDessinePortions=function(n,t,i){for(var u,r=this.m_clTabPortions.length-1;r>=0;--r)u=this.m_clTabPortions[r],this.__bDessinePortion(u,n,t,i),this.__bDessineTextePortion(u,n,t,i);return!0};WDFunnelChartRenderer.prototype.__bDessinePortion=function(n,t,i,r){var s=t.arc(r,"part-"+n.m_nNumCategorie),h,c,l,v;if(n.m_nNumCategorie==0&&s.css("display",""),n.m_dValeur==0)return n.m_nNumCategorie==0?(this.liaisonLegendePart(t,s,n.m_nNumCategorie),s.css("display","none")):this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()||s.remove(),!0;h=this.m_oModele.getCategoryColor(n.m_nNumCategorie);c=this.m_params.getGradientType();c==IWDChartConstant.FLAG_VERTICAL_GRADIENT||c==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_oPaint.setLinearGradient(clWDUtil.sCouleurHTMLPlusBrillante(h),h,"pad",!1,1,1,!0):this.m_oPaint.setFill(h);var u=n.m_dY+this.m_clRectCalcul.m_nTop,a=this.m_clRectCalcul.m_nLeft,e=a+this.m_clRectCalcul.getWidth()/2-n.m_dLargeurBase1/2,o=a+this.m_clRectCalcul.getWidth()/2-n.m_dLargeurBase2/2,f=new Path;return n.m_dHauteurBoutDroit==0&&n.m_dHauteurBoutTraverse!=0?(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse),f.lineTo(o,u+n.m_dHauteurBoutTraverse),f.lineTo(e,u)):n.m_dHauteurBoutDroit!=0&&n.m_dHauteurBoutTraverse==0?(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(e+n.m_dLargeurBase1,u+n.m_dHauteurBoutDroit),f.lineTo(o,u+n.m_dHauteurBoutDroit),f.lineTo(o,u)):(f.AjouteLigne(e,u,e+n.m_dLargeurBase1,u),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse),f.lineTo(o+n.m_dLargeurBase2,u+n.m_dHauteurBoutTraverse+n.m_dHauteurBoutDroit),f.lineTo(o,u+n.m_dHauteurBoutDroit+n.m_dHauteurBoutTraverse),f.lineTo(o,u+n.m_dHauteurBoutTraverse),f.lineTo(e,u)),l=this.getSeriesAlphaAt(n.m_nNumCategorie),l<255?this.m_oPaint.setFillOpacity255(l):this.m_oPaint.setFillOpacity255(255),v=this.crPlusFonce(h),this.m_oPaint.setStroke(v),f.close(),this.liaisonLegendePart(t,s,n.m_nNumCategorie),this.m_oPaint=i.tweenPartPaint(s,this.m_oPaint,n,this),t.drawPath(s,f.toD(),this.m_oPaint),!0};WDFunnelChartRenderer.prototype.__bDessineTextePortion=function(n,t,i,r){var a,d,g,nt,u,tt,e,ut,o,l;if(n.m_dValeur==0)a=!1;else{var v={cx:0,cy:0},y={cx:0,cy:0},p={cx:0,cy:0},w="",s="",b="";this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle);var ft=n.m_dY+this.m_clRectCalcul.m_nTop,h=this.m_params.isDisplayValuesLabel(),c=this.m_params.isDisplayPercentage(),f=this.m_params.isDisplayCategoriesLabel(),a=!i.tweenHideLabel(r,!(f||c||h),n.m_nNumCategorie);a||(h=c=f=!1);h&&(d=this.m_params.m_sMasqueValeur,w=WDChartUtils.formatValue(n.m_dValeur,d,!0),u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,w,["width","height","lineHeight"]),v.cy=parseInt10(u.height),v.cx=parseInt10(u.width));f&&(s=this.m_oModele.getCategoryLabelAt(n.m_nNumCategorie),s==""&&(f=!1));f&&(u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,s,["width","height","lineHeight"]),y.cy=parseInt10(u.height),y.cx=parseInt10(u.width));c&&(g=this.m_params.m_sMasquePourcentage,nt=Math.abs(this.m_oModele.getFromSerieValueAt(0,0)),b=WDChartUtils.formatValue(n.m_dValeur/nt*100,g.replace("%",""),!0,"%"),u=WDPaintCSS.oGetInfoCSS(this.m_oPaint,b,["width","height","lineHeight"]),p.cy=parseInt10(u.height),p.cx=parseInt10(u.width));tt=v.cy+y.cy+p.cy;e=n.m_dLargeurBase1;e==0&&(e=this.m_nLargeurEmbout);var et=this.m_clRectCalcul.m_nLeft,it=et+this.m_clRectCalcul.getWidth()/2-e/2,rt=ft+0,k=new WDRect;k.setCorners(parseInt10(it),parseInt10(rt),parseInt10(it+e),parseInt10(rt+n.m_dHauteurBoutTraverse+n.m_dHauteurBoutDroit));ut=k.getCenterY()-tt/2;o=[];f&&o.push(s);h&&o.push(w);c&&o.push(b)}return l=t.text(r,"label-"+n.m_nNumCategorie),a?(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),this.m_oPaint.DesactivePointerEvents(),this.m_oPaint=i.tweenLabelPaint(n.m_nNumCategorie,this.m_oPaint,l),t.drawText(l,o,parseInt10(u.lineHeight),k.getCenterX(),ut,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint)):this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()||l.remove(),!0};WDFunnelChartAnimator.prototype=new WDChartAnimator;WDFunnelChartAnimator.prototype.constructor=WDFunnelChartAnimator;WDFunnelChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDFunnelChartAnimation1erAffichageCoulissantNoDraw(n,t);this.add(i,!0)};WDFunnelChartAnimator.prototype.playSurbrillancePart=function(n,t,i,r,u){r!==undefined&&(n.m_oVue.m_oAnimator.bAnimationPasFinie()||this.add(new WDFunnelChartAnimationSurbrillancePartNoDraw(n,t,i,r,u)))};WDFunnelChartAnimator.prototype.playSelectionPart=function(){return};WDFunnelChartAnimator.prototype.playSelectionLegende=function(n,t,i,r){var o=WDPieChartRenderer.nGetIndicePart(t,i),f=this.m_oGraphe.m_oVue.bEstSerieMasquee(o),e,u;if(!f){for(e=!0,u=this.m_oGraphe.m_oDonnees.m_tabSeries[0].m_tabValeur.length-1;u>=0;u--)if(u!=o&&!1===this.m_oGraphe.m_oVue.bEstSerieMasquee(u)){e=!1;break}if(e)return}r&&r.fadeTo(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0?0:400,f?1:.5).find("text").css("text-decoration",f?"":"line-through");this.add(new WDPieChartAnimationSelectionLegende(n,t,i,r))};WDFunnelChartAnimator.prototype.tweenRectChart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenRectChart")};WDFunnelChartAnimator.prototype.tweenPart=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPart")};WDFunnelChartAnimator.prototype.tweenPartPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenPartPaint")};WDFunnelChartAnimator.prototype.tweenLabelPaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenLabelPaint")};WDFunnelChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDFunnelChartAnimationValeur(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);this.add(i,!0)};WDFunnelChartAnimationSurbrillancePartNoDraw.prototype=new WDChartAnimationNoDraw;WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.constructor=WDFunnelChartAnimationSurbrillancePartNoDraw;WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.run=function(){this.m_domPartEnSurbrillance.clearQueue().finish().animate({opacity:this.m_bEtat?.8:1},{duration:this.m_bEtat?this.duration:1,easing:this.easing,queue:"fx"});this.m_oAnimator.retireAnimation(this.m_domPartEnSurbrillance.wbData("wbGrfAnim"));this.m_domPartEnSurbrillance.wbData("wbGrfAnim",this).clearQueue().finish().animate({content:1},this)};WDFunnelChartAnimationSurbrillancePartNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments),t;n&&(t=n.tween(n.m_nEchelleInitiale,n.m_bEtat?n.m_nEchelle:0,n.m_dNow),n.m_domPartEnSurbrillance.wbData("wbGrfAnimSurbrillanceEcart",t))};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype=new WDChartAnimationNoDraw;WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.constructor=WDFunnelChartAnimation1erAffichageCoulissantNoDraw;WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.run=function(){this.m_oGraphe.m_oVue.Redessine(this.m_oGraphe,WDChartView.ms_nDessinParDefaut);var n=this;this.m_domBaliseAnim.wbData("wbGrfAnim",this);setTimeout(function(){n.done()},this.duration)};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.step=function(){var n=WDChartAnimationNoDraw.prototype.step.apply(this,arguments);n&&n.m_domBaliseAnim.css({opacity:n.tween(0,1,(n.m_oBezier||(n.m_oBezier=new clWDUtil.WDBezier(.42,0,1,-.1))).dCalcule(n.m_dNow,n.duration*(WDPieChartRenderer.nGetIndicePart(n.m_oPicture,n.m_domBaliseAnim)/n.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length)))}).attr("transform","translate(0,"+.8*(n.m_pstPortion.m_dY*n.m_dNow-n.m_pstPortion.m_dY)+")")};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenHideLabel=function(n,t){return t};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenLabelPaint=function(n,t,i){return i.css({opacity:0}).delay(this.duration*2/3).animate({opacity:1},{queue:"fx",duration:this.duration/3,easing:this.easing}),t};WDFunnelChartAnimation1erAffichageCoulissantNoDraw.prototype.tweenPartPaint=function(n,t,i){this.m_oAnimator.retireAnimation(n.wbData("wbGrfAnim"));var r=new WDFunnelChartAnimation1erAffichageCoulissantNoDraw(this.m_oGraphe,this.m_oPicture);return r.m_domBaliseAnim=n,r.m_pstPortion=i,n.wbData("wbGrfAnim",r).clearQueue().finish().animate({content:1},r),t};WDFunnelChartAnimationValeur.prototype=new WDChartAnimationValeur;WDFunnelChartAnimationValeur.prototype.constructor=WDFunnelChartAnimationValeur;WDFunnelChartAnimationValeur.prototype.tweenValue=function(n,t,i){var r=this.m_dNow,u;return this.m_oModelePrecedent===undefined&&(this.m_dNow=Math.exp(r*i)/Math.exp(i)),u=WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments),this.m_dNow=r,u};WDChartRenderer.prototype.drawLegend=function(n,t,i){var ut,nt,st,u,c,ht,dt,ct,w,yt,pt,hi,ci,b,lt,wt,gt,ni,at,pi,wi,ti,ii,ri;this.m_oPaint.raz();for(var f=this.m_params.getLegendPosition(),a=n.g(i,"legende-groupe"),e=this.getNbLegendLabels(),bt=[f],r=0,r=0;r<e;++r)bt.push(this.getLegendLabelAt(r));if(a.wbData("wbGrfCacheDrawLegend")!=bt&&(a.wbData("wbGrfCacheDrawLegend",bt),ut=a.children().length>0,a.empty(),f!==IWDChartConstant.FLAG_LEGEND_POSITION_NONE&&(f!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL||this.m_params.m_oPositionnementManuel&&this.m_params.m_oPositionnementManuel.m_oLegende))){if(e<=0){a.empty();return}t.tweenGroupeLegende(a);var k=0,y=f===IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL?0:IWDChartConstant.MARGIN_LEGEND_BORDER,ft=y*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,et=y*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,ot=y*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,p=y*2+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2;f!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL&&(et+=IWDChartConstant.MARGIN_BORDER,p+=IWDChartConstant.MARGIN_BORDER);var g=0,vt=[],kt=[],ui=[];for(r=0;r<e;++r)nt=this.getLegendLabelAt(r),isNaN(parseInt10(nt))&&!clWDUtil.bEstChaineNonVide(nt)&&(nt="N"+$("<span/>").html("&#176;").text()+(r+1)),oStyle=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,nt,["width","lineHeight","fontSize"],"font-weight:900",!0),st=Math.ceil(parseInt10(oStyle.width)),kt[r]=Math.ceil(parseInt10(oStyle.fontSize)),k=Math.max(k,Math.ceil(parseInt10(oStyle.lineHeight))),st>g&&(g=st),vt[r]=st,p+=IWDChartConstant.LEGEND_SQUARE_SIZE+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*(r>0?2:1)+st,ft+=k+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*(r>0?1:0),ui[r]=nt;if(u=!0,c=!1,this._vbLegendevaleur())u=f==IWDChartConstant.FLAG_LEGEND_POSITION_TOP||f==IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM,c=!1;else switch(f){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:u=ft>WDRect.getHeight(this.m_rectChart);u&&(c=!0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:u=p<=WDRect.getWidth(this.m_rectChart);u||(c=!0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:u=this.m_params.isLegendLabelInRow();u&&this.m_params.m_oPositionnementManuel.m_oLegende.m_nLeft+p>this.m_rectChartInitial.m_nRight?c=!0:!u&&this.m_params.m_oPositionnementManuel.m_oLegende.m_nTop+ft>this.m_rectChartInitial.m_nBottom&&(c=!0)}if(c){var tt=WDRect.getHeight(this.m_rectChartInitial),d=WDRect.getWidth(this.m_rectChartInitial),bi=f;switch(f){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:d=d/2;break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:tt=tt/3;break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:f=this.m_params.isLegendLabelInRow()?IWDChartConstant.FLAG_LEGEND_POSITION_TOP:IWDChartConstant.FLAG_LEGEND_POSITION_LEFT;ht=this.m_params.m_oPositionnementManuel.m_oLegende;this.m_params.isLegendAdaptSizeToContent()?(d-=ht.m_nLeft,tt-=ht.m_nTop):(d=WDRect.getWidth(ht),tt=WDRect.getHeight(ht))}var fi=IWDChartConstant.MARGIN_LEGEND_ELEMENTS+k,ei=IWDChartConstant.LEGEND_SQUARE_SIZE+g+IWDChartConstant.MARGIN_LEGEND_ELEMENTS*2,it=undefined,rt=undefined;switch(f){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:rt=parseInt10(tt/fi);it=parseInt(e/rt)+(e%rt>0?1:0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:it=parseInt10(d/ei);rt=parseInt(e/it)+(e%it>0?1:0);break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:}p=Math.min(d,et+it*ei-IWDChartConstant.MARGIN_LEGEND_ELEMENTS);switch(f){default:case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:d>p&&(dt=parseInt10(e/it),rt=parseInt10(e/dt)+(e%dt>0?1:0));break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:break;case IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL:}ot=Math.min(tt,ot+rt*fi-IWDChartConstant.MARGIN_LEGEND_ELEMENTS);u=!0;f=bi}else et+=IWDChartConstant.LEGEND_SQUARE_SIZE+IWDChartConstant.MARGIN_LEGEND_ELEMENTS+g,ot+=k;var o=0,l=0,s=0,h=0;if(f===IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL)ct=this.m_params.m_oPositionnementManuel.m_oLegende,o=ct.m_nLeft,l=ct.m_nTop,this.m_params.isLegendAdaptSizeToContent()?(s=u?p:et,h=u?ot:ft):(s=WDRect.getWidth(ct),h=WDRect.getHeight(ct));else{s=u?p:et;h=u?ot:ft;switch(f){case IWDChartConstant.FLAG_LEGEND_POSITION_LEFT:o=this.m_rectChart.m_nLeft;l=this.m_rectChart.m_nTop+Math.max(0,(WDRect.getHeight(this.m_rectChart)-h)/2);this.m_rectChart.setLocation(o+s,this.m_rectChart.m_nTop,!1);break;case IWDChartConstant.FLAG_LEGEND_POSITION_RIGHT:o=this.m_rectChart.m_nRight-s;l=this.m_rectChart.m_nTop+Math.max(0,(WDRect.getHeight(this.m_rectChart)-h)/2);this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart)-s,WDRect.getHeight(this.m_rectChart));break;case IWDChartConstant.FLAG_LEGEND_POSITION_TOP:o=this.m_rectChart.m_nLeft+Math.max(0,(WDRect.getWidth(this.m_rectChart)-s)/2);l=this.m_rectChart.m_nTop;this.m_rectChart.setLocation(this.m_rectChart.m_nLeft,l+h,!1);break;case IWDChartConstant.FLAG_LEGEND_POSITION_BOTTOM:o=this.m_rectChart.m_nLeft+Math.max(0,(WDRect.getWidth(this.m_rectChart)-s)/2);l=this.m_rectChart.m_nBottom-h;this.m_rectChart.setSize(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart)-h)}}o+=y;l+=y;s-=2*y;h-=2*y;f!==IWDChartConstant.FLAG_LEGEND_POSITION_MANUAL&&(s-=IWDChartConstant.MARGIN_BORDER);var oi=this.m_params.m_sCouleurLegende,si=this.m_params.m_sCouleurLegendeFond,v=new WDRect(o,l,o+s,l+h);if(si!==undefined&&this.m_oPaint.setFill(si),w=0,oi!==undefined&&(w=1,this.m_oPaint.setStroke(oi,w)),yt=undefined,!this.m_params.m_bLegendeBordArrondi||(yt=10),pt=new WDRect,pt.setLocation(Math.min(v.m_nLeft,v.m_nRight)-w,Math.min(v.m_nTop,v.m_nBottom)-w),pt.setSize(v.getWidth()+2*w,v.getHeight()+2*w),n.clipRect(pt,"clip-legende"),hi=n.path(a,"legende-fond"),ci=this.__oPathBulle(v,w,yt,yt),n.drawPath(hi,ci,this.m_oPaint,this.m_params.m_nDureeAnimation===0||ut?!1:WDSvgAnimationLegende),b=o+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,lt=l+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,this._vbLegendevaleur())this._drawLegendValeurPaint(a,n,t,v,ut);else for(r=0;r<e;++r){wt=this.getLegendColorAt(r*this.m_nPasSerie);gt=this.getSeriesAlphaAt(r);gt<255?this.m_oPaint.setFillOpacity255(gt):this.m_oPaint.setFillOpacity255(255);var li=clWDUtil.sCouleurHTMLPlusBrillante(wt),ai=IWDChartConstant.LEGEND_SQUARE_SIZE,vi=k,yi=this.m_params.getGradientType();switch(yi){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:this.m_oPaint.setLinearGradient(wt,li,"pad",yi==IWDChartConstant.FLAG_VERTICAL_GRADIENT);break;case IWDChartConstant.FLAG_NO_GRADIENT:this.m_oPaint.setFill(wt)}ni=1;this.m_oPaint.setStroke(li,ni);at=n.g(a,"legende-groupe-"+r*this.m_nPasSerie);this.ecouteLegende(at);pi=n.rect(at,"legende-picto-"+r*this.m_nPasSerie);n.drawRect(pi,new WDRect(b,lt,b+ai,lt+vi),this.m_oPaint,undefined,undefined,this.m_params.m_nDureeAnimation===0||ut?!1:WDSvgAnimationLegende);b+=ai+IWDChartConstant.MARGIN_LEGEND_ELEMENTS;this.m_oPaint.addClasse(this.m_params.m_sClasseLegende);wi=n.text(at,"legende-texte-"+r*this.m_nPasSerie);this.m_oPaint=t.tweenLegendPaint(r,this.m_oPaint);n.drawText(wi,ui[r],kt[r],b,lt+(vi/2-kt[r]/2-ni*2),IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||ut?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende);ti=this.bEstLegendeMasquee(r*this.m_nPasSerie);at.fadeTo(this.m_params.m_nDureeAnimation===0?0:400,ti?.5:1).find("text").css("text-decoration",ti?"line-through":"");ii=IWDChartConstant.MARGIN_LEGEND_ELEMENTS+(c?g:vt[r]);ri=k+IWDChartConstant.MARGIN_LEGEND_ELEMENTS;(u||c)&&(b+ii+(r+2==e&&vt[r+1]?vt[r+1]:g)>v.m_nRight?(u=!1,h+=ri):c&&(u=!0));u?b+=ii:(b=o+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,lt+=ri)}n.restoreClip()}};WDLineChartRenderer.bParametresSupportes=function(n,t){return WDXYChartRenderer.bParametresSupportes(n,t)?!0:!1};WDLineChartRenderer.prototype=new WDXYChartRenderer;WDLineChartRenderer.prototype.constructor=WDLineChartRenderer;WDLineChartRenderer.prototype.createAxisRenderer=function(){return new WDLineChartAxisRenderer(this)};WDLineChartRenderer.prototype.isClipOnAxisRectBeforeDrawingChart=function(){return!0};WDLineChartRenderer.prototype.drawChartSeries=function(n,t,i){for(var e=this.m_oModele.m_tabSeries.length,r=0,u,f,o,r=e-1;r>=0;r-=this.m_nPasSerie)u=n.g(t,"groupe-serie-"+r),this.m_oGraphe.m_oVue.bEstSerieMasquee(r)&&i.m_nDureeAnimation==0||this.drawSeries(n,u,r,this.m_oModele.getSeriesAt(r,!1),i),f=n.findFromId(n.m_domBaliseSVG,"legende-groupe-"+r),f.length&&(o=WDChartListener.bind(this.m_ProtoLegendListener,this.m_oGraphe,f,u,r))};WDLineChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var l=this.m_oModele.getAxisByType(EAxisType.X),a=r.getNbValues(),c=this.getDrawnValuesCount(a,l),s,f,y,p,h;if(c!=0){var e=[],v=r.isOnSecondaryAxis(),w=this.getYOriginValue(v),o=this.getFirstDrawnCategoryIndex(l);for(s=0;s<c;++s,++o)if(!(o<0)){if(o>=a)break;if(f=r.getValueAtWithNull(o),f===undefined||f===null)switch(this.getSeriesDessinValeursNullesAt(i)){case eDESSINVALEURNULLE.eValeurNulleIgnoree:continue;case eDESSINVALEURNULLE.eValeurNulleAZero:f=0;break;case eDESSINVALEURNULLE.eValeurNulleNonDessinee:s>0&&s<c-1&&e.push(IWDChartConstant.SPECIAL_VALUE);continue}f=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,f,o,i);y=this.getValueDrawingPosition(f,w,o,v);e.push(y)}p=e.length;p>=2&&(h=this.m_oModele.getSeriesColor(i),this.drawLineBackground(n,t,i,r,e,u,h),this.drawLine(n,t,i,r,e,u,h),this.drawPoints(n,t,i,r,e,u,h))}};WDLineChartRenderer.prototype.createLineBackgroundGradient=function(n,t){var i={couleurDebut:n,couleurFin:clWDUtil.sCouleurHTMLPlusBrillante(n),spreadMethod:"pad"};switch(t){case IWDChartConstant.FLAG_VERTICAL_GRADIENT:i.bVertical=!0;break;case IWDChartConstant.FLAG_HORIZONTAL_GRADIENT:i.bVertical=!1;break;default:return null}return i};WDLineChartRenderer.prototype.drawLineBackground=function(n,t,i,r,u,f,e){var l=n.g(t,"groupe-area-"+i),a,c,p,o,v;if(f.getType()!=WDChartParameters.kAire&&f.getType()!=WDChartParameters.kRadar)return l.children().length>0&&(n.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation>0?l.fadeTo(n.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation,0,"swing",function(){$(this).empty()}):l.empty()),!1;a=this.getSeriesAlphaAt(i);c=this.createLineBackgroundGradient(e,f.getGradientType());c?this.m_oPaint.setLinearGradient(c.couleurDebut,c.couleurFin,c.spreadMethod,c.bVertical,1,a/255):(this.m_oPaint.setFill(clWDUtil.sCouleurHTMLPlusBrillante(e)),a<255?this.m_oPaint.setFillOpacity255(a):this.m_oPaint.setFillOpacity255(255));var y=0,w=0,s=new Path,h=r.isOnSecondaryAxis();for(this.getSeriesSplineAt(i)?u=[{x:this.nGetXOrigin(h),y:this.nGetYOrigin(h)}].concat(u):s.moveTo(this.nGetXOrigin(h),this.nGetYOrigin(h)),p=u.length,o=0;o<p;o++){if(!clWDUtil.isObject(u[o])&&u[o]===IWDChartConstant.SPECIAL_VALUE){o>0&&(s.lineTo(u[o-1].x,this.nGetYOrigin(h)),s.close());v=n.path(l,"serie-area-special-"+o);n.drawPath(v,s.toD(),this.m_oPaint);s.rewind();o+1<p&&s.moveTo(u[o+1].x,this.nGetYOrigin(h));continue}y=u[o].x;w=u[o].y;this.getSeriesSplineAt(i)?this.getPointSpline(s,u,u[o],o):s.lineTo(y,w)}return s.lineTo(y,this.nGetYOrigin(h)),s.close(),this.getSeriesSplineAt(i)?this.m_oPaint.setStrokeLineJoin("round"):this.m_oPaint.setStrokeLineJoin("miter"),v=n.path(l,"serie-area-"+i),n.drawPath(v,s.toD(),this.m_oPaint),!0};WDLineChartRenderer.prototype.drawLine=function(n,t,i,r,u,f,e){var h=new Path,v=r.isOnSecondaryAxis(),c,o,s,y,p,l,a;for(this.getSeriesSplineAt(i)?u=f.getType()==WDChartParameters.kNuage?[{x:u[0].x,y:u[0].y}].concat(u):[{x:this.nGetXOrigin(v),y:this.nGetYOrigin(v)}].concat(u):h.moveTo(u[0].x,u[0].y),c=u.length,o=0;o<c;++o){if(!clWDUtil.isObject(u[o])&&u[o]===IWDChartConstant.SPECIAL_VALUE){for(s=1;o+s<c;){if(!clWDUtil.isObject(u[o+s])&&u[o+s]===IWDChartConstant.SPECIAL_VALUE){++s;continue}h.moveTo(u[o+s].x,u[o+s].y);break}continue}y=u[o].x;p=u[o].y;this.getSeriesSplineAt(i)?this.getPointSpline(h,u,u[o],o):h.lineTo(y,p)}l=undefined;f.getType()==WDChartParameters.kCourbe&&(l=this.getSeriesAlphaAt(i)/255);this.m_oPaint.setStroke(e,r.m_nEpaisseur,l);this.getSeriesSplineAt(i)?this.m_oPaint.setStrokeLineJoin("round"):this.m_oPaint.setStrokeLineJoin("miter");a=n.path(t,"serie-line-"+i);u=!this.getSeriesSplineAt(i)?u:u.slice(1);n.drawPath(a,h.toD(),this.m_oPaint);this.saveLineData(a,i,u)};WDLineChartRenderer.prototype.saveLineData=function(n,t,i){n.wbData("wbGrfSeriePoints",i).wbData("wbGrfGrInfoXY",[t,function(n,t,r){for(var f=i.length<2?10:Math.abs(i[0].x-i[1].x)/2,e=i.length<2?10:Math.abs(i[0].y-i[1].y)/2,u=0;u<i.length;++u)if(Math.abs(i[u].x-t)<f&&Math.abs(i[u].y-r)<e)return u},function(n){return this.m_oModele.m_tabSeries[n.wbData("wbGrfGrInfoXY")[IWDChartConstant.GR_SERIE]].getValueAt(n.wbData("wbGrfGrInfoXY")[IWDChartConstant.GR_CATEGORIE].apply(this,arguments))}])};WDLineChartRenderer.prototype.getPointSpline=function(n,t,i,r){var h=2.5,a=h+1,s=i.x,u=i.y,o=t[r-1],p=t[r+1],w,e,v,f,y;if(o&&p){var k=o.x,c=o.y,d=p.x,l=p.y,b;w=(h*s+k)/a;e=(h*u+c)/a;v=(h*s+d)/a;f=(h*u+l)/a;b=(f-e)*(v-s)/(v-w)+u-f;e+=b;f+=b;e>c&&e>u?(e=Math.max(c,u),f=2*u-e):e<c&&e<u&&(e=Math.min(c,u),f=2*u-e);f>l&&f>u?(f=Math.max(l,u),e=2*u-f):f<l&&f<u&&(f=Math.min(l,u),e=2*u-f);i.rightContX=v;i.rightContY=f}return r?(y=["C",o.rightContX||o.x,o.rightContY||o.y,w||s,e||u,s,u],o.rightContX=o.rightContY=null):y=["M",s,u],n&&n.add(y.join(" ")),y};WDLineChartRenderer.prototype.drawPoints=function(n,t,i,r,u,f,e){for(var a,y,et,s,nt,d,tt,h,p,it,rt,ft,w=r.m_eTypePoint,b=f.getType()!=WDChartParameters.kBulle&&f.getType()!=WDChartParameters.kHeatMap&&f.isDisplayValuesLabel(),k=u.length,v,o=0,g=0;(!b||w==EPointStyle.NONE)&&o<k;o++,g++)a="series-"+i+"-point-"+o,b||(v=n.findFromId(t,a+"-texte"),v&&v.length>0&&v.remove()),w==EPointStyle.NONE&&(h=n.findFromId(t,a),h&&h.length>0&&h.remove());for(y=k;(v=n.findFromId(t,"series-"+i+"-point-"+y+"-texte")).length>0;++y)v.remove();for(y=k;(h=n.findFromId(t,"series-"+i+"-point-"+y)).length>0;++y)h.remove();if(b||w!=EPointStyle.NONE)for(et=f.m_sMasqueValeur,o=0,g=0;o<k;o++,g++)if(s=f.m_nTaillePt,nt=s,clWDUtil.isObject(u[o])||u[o]!==IWDChartConstant.SPECIAL_VALUE){var e=this.m_oModele.getSeriesColor(i),c=u[o].x,l=u[o].y,a="series-"+i+"-point-"+o;u[o].z!==undefined&&(s=clWDUtil.isObject(u[o].z)?u[o].z.width:u[o].z,nt=clWDUtil.isObject(u[o].z)?u[o].z.height:u[o].z);b&&this.m_oPaint.addClasse(f.m_sClasseValeur);d=f.getType()==WDChartParameters.kBulle||f.getType()==WDChartParameters.kHeatMap?this.getSeriesAlphaAt(i):255;w!=EPointStyle.NONE&&(s>1&&(tt=u[o].grandientType||(f.getType()==WDChartParameters.kBulle||f.getType()==WDChartParameters.kHeatMap?f.getGradientType():IWDChartConstant.FLAG_NO_GRADIENT),tt==IWDChartConstant.FLAG_VERTICAL_GRADIENT||tt==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_oPaint.setRadialGradient(c,l,s,clWDUtil.sCouleurHTMLPlusBrillante(u[o].color||e),u[o].color||e,"pad",d/255,d/255,u[o].radialCentre):(this.m_oPaint.setFill(u[o].color||clWDUtil.sCouleurHTMLPlusBrillante(e)),d<255?this.m_oPaint.setFillOpacity255(d):this.m_oPaint.setFillOpacity255(255))),this.m_oPaint.setStroke(u[o].stroke||e,r.m_nEpaisseur));switch(w){case EPointStyle.NONE:h=undefined;break;default:case EPointStyle.CIRCLE:h=n.circle(t,a);n.drawCircle(h,c,l,s,this.m_oPaint);break;case EPointStyle.CROSS:p=new Path;p.moveTo(c-s,l-s);p.lineTo(c+s,l+s);p.moveTo(c-s,l+s);p.lineTo(c+s,l-s);h=n.path(t,a);n.drawPath(h,p.toD(),this.m_oPaint);break;case EPointStyle.DIAMOND:h=n.polygon(t,a);n.drawPolygon(h,[[c,l-s],[c+s,l],[c,l+s],[c-s,l],[c,l-s]],this.m_oPaint);break;case EPointStyle.SQUARE:it=c-s;rt=l-nt;h=n.rect(t,a);u[o].color&&this.m_oPaint.setFill(this.m_oGraphe.m_oVue.m_oAnimator.tweenValuePaint(h,u[o].color,i,o));n.drawRect(h,new WDRect(it,rt,it+2*s,rt+2*nt),this.m_oPaint,undefined,undefined,u[o].fAnimation);break;case EPointStyle.TRIANGLE:h=n.polygon(t,a);n.drawPolygon(h,[[c,l-s],[c+s,l+s],[c-s,l+s],[c,l-s]],this.m_oPaint)}if(h&&u[o].data&&h.wbDataObj(u[o].data),b){var ot=r.getValueAt(g),ut=WDChartUtils.formatValue(ot,et,!0),v=n.text(t,a+"-texte");this.m_oPaint.addClasse(f.m_sClasseLibelle);oStyle=WDPaintCSS.oGetInfoCSS(this.m_oPaint,ut,"lineHeight");ft=Math.ceil(parseInt10(oStyle.lineHeight));o>=k-1?n.drawText(v,ut,ft,c-s-1,l+s+1,Align.RIGHT,this.m_oPaint):n.drawText(v,ut,ft,c+s+1,l+s+1,Align.LEFT,this.m_oPaint)}}};Path.prototype.constructor=Path;Path.prototype.add=function(n){this.d&&(this.d+=" ");this.d+=n};Path.prototype.moveTo=function(n,t){this.add("M "+n+" "+t)};Path.prototype.lineTo=function(n,t){this.add("L "+n+" "+t)};Path.prototype.toD=function(){return this.d};Path.prototype.close=function(){this.add("Z")};Path.prototype.rewind=function(){this.d=""};Path.prototype.AjouteLigne=function(n,t,i,r){this.moveTo(n,t);this.lineTo(i,r)};WDLineChartRenderer.prototype.getValueDrawingPosition=function(n,t,i,r){var u=this.getCategoryDrawingPositionX(i,r),f=this.dGetYPixelsPerUnit(r),e=this.nGetYOrigin(r)-Math.ceil((n-t)*f);return{x:u,y:e}};WDLineChartAxisRenderer.prototype=new WDChartAxisRenderer;WDLineChartAxisRenderer.prototype.constructor=WDLineChartAxisRenderer;WDLineChartAxisRenderer.prototype.isDrawLabelsBetweenGraduations=function(){return!1};WDPieChartRenderer.nGetIndicePart=function(n,t){return parseInt10(n.getId(t).substr(n.getId(t).lastIndexOf("-")+1))};WDPieChartRenderer.bParametresSupportes=function(n,t){return WDChartRenderer.bParametresSupportes(n,t)?!t.m_bPhong?!0:!1:!1};WDPieChartRenderer.prototype=new WDChartRenderer;WDPieChartRenderer.prototype.constructor=WDPieChartRenderer;WDPieChartRenderer.prototype.m_bDessinneSelonBissectire=!0;WDPieChartRenderer.prototype.RecreerRenderer=function(n,t){t==WDChartView.ms_nDessinModifTypeGraphe?this.m_domGroupeSeries.find("text").remove():(this.m_domGroupeSeries&&this.m_domGroupeSeries.empty(),this.tabLabelRenderers=undefined)};WDPieChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r){var e,u,f;if(i||r===!0)for(e=t,u=0;u<this.m_oGraphe.m_oModele.m_tabSeries[0].m_tabValeur.length;++u)f=Array.prototype.slice.call(arguments,0),f[1]=u,f[2]=e==u?i:!1,WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,f);else WDChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments)};WDPieChartRenderer.prototype.Init=function(){WDChartRenderer.prototype.Init.apply(this,arguments);this.m_nCenterX=0;this.m_nCenterY=0;this.m_nRadius=0;this.m_dTotalValue=0};WDPieChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDPieChartLegendListener,this.m_oGraphe,n)};WDPieChartRenderer.prototype.getInitialStartAngle=function(n){return(Number(n.m_dAngle||0).toDeg()+270)%360};WDPieChartRenderer.prototype.getAngleForValue=function(n,t,i){var r=n/t*(i||360);return r>=i&&(r=i-1),r};var normalizeEvent=function(n){return n.offsetX||(n.offsetX=n.pageX-$(n.target).offset().left,n.offsetY=n.pageY-$(n.target).offset().top),n};WDPieChartRenderer.prototype.drawChart=function(n,t,i){var fi,l,v,r,f,d,yt,pt,wt,bt,ti,c,s,oi,st,nt,tt,y,ht,u,ui,ct,it,k;WDChartRenderer.prototype.drawChart.apply(this,arguments);
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
	 * Licensed under the MIT License (LICENSE.txt).
	 *
	 * Version: 3.1.12
	 *
	 * Requires: jQuery 1.2.2+
	 */
if(fi=this,i,l=this.m_params.getType()==WDChartParameters.kHemicycle?180:360,l=t.tweenInitialEndAngle(i,l),i.wbData("wbGrfAnimTweenInitialEndAngle",l),!1!==this.m_oModele.hasPremiereSerieNonVide()){for(v=this.m_oModele.m_tabSeries[0].getNbValues(),this.m_dTotalValue=0,r=0,r=0;r<v;++r)f=t.tweenValue(i,Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),r,0),this.m_dTotalValue+=f;if(this.m_dTotalValue!==0){this.m_dInitialStartAngle=this.m_params.getType()==WDChartParameters.kHemicycle?180:this.getInitialStartAngle(this.m_params);this.m_dInitialStartAngle=t.tweenInitialStartAngle(i,this.m_dInitialStartAngle);i.wbData("wbGrfAnimTweenInitialStartAngle",this.m_dInitialStartAngle);var h=this.m_dInitialStartAngle,ft=0,lt=this.m_params.isDisplayValuesLabel(),at=this.m_params.isDisplayPercentage(),vt=this.m_params.isDisplayCategoriesLabel();if(this.tabLabelRenderers===undefined&&(this.tabLabelRenderers=[]),d=!t.tweenHideLabel(i,!(vt||at||lt),r),d||!this.m_params.m_bBulleActive)for(yt=this.m_params.m_sMasqueValeur,pt=this.m_params.m_sMasquePourcentage,r=0;r<v;++r)(f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f!=0)&&(f=t.tweenValue(i,f,r,0),s=this.getAngleForValue(f,this.m_dTotalValue,l),this.tabLabelRenderers[r]===undefined?u=new WDLabelRenderer(this,h,s,r):(u=this.tabLabelRenderers[r],u.setAngle(h,s)),u.setCategoryLabel(vt,this.m_oModele.getCategoryLabelAt(r)),u.setValueLabel(lt,WDChartUtils.formatValue(f,yt,!0)),u.setPercentLabel(at,WDChartUtils.formatValue(f/this.m_dTotalValue*100,pt.replace("%",""),!0,"%")),this.tabLabelRenderers[r]=u,h+=s);if(h=this.m_dInitialStartAngle,this.m_rectChart=t.tweenRectChart(i,this.m_rectChart),this.m_nCenterX=Math.floor((this.m_rectChart.m_nLeft+this.m_rectChart.m_nRight)/2),this.m_nCenterY=Math.floor((this.m_rectChart.m_nTop+this.m_rectChart.m_nBottom)/2),this.m_params.getType()==WDChartParameters.kHemicycle&&(wt=Math.floor((this.m_rectChart.m_nBottom-this.m_rectChart.m_nTop)/2),this.m_nCenterY+=wt/2),this.m_nRadius=Math.min(WDRect.getWidth(this.m_rectChart),WDRect.getHeight(this.m_rectChart))/2,!(this.m_nRadius<=IWDChartConstant.MARGIN_PIE+IWDChartConstant.MARGIN_LABEL_PIE)){var rt=0,o=undefined,e=undefined;if(d&&(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),bt=WDPaintCSS.oGetInfoCSS(this.m_oPaint,"Ap","lineHeight"),rt=parseInt10(bt.lineHeight),o=new WDRect,!!this.m_params.m_bEtiquetteSecteurExterieures)){var kt=this.m_rectChart.m_nLeft,dt=this.m_rectChart.m_nTop,gt=this.m_rectChart.m_nRight,ni=this.m_rectChart.m_nBottom;for(e=0,r=0;r<v;++r)(ti=this.m_oModele.getPartOffset(r,et),u=this.tabLabelRenderers[r],u)&&(u.getBounds(rt,ti,o),kt-o.m_nLeft>e&&(e=kt-o.m_nLeft),dt-o.m_nTop>e&&(e=dt-o.m_nTop),o.m_nRight-gt>e&&(e=o.m_nRight-gt),o.m_nBottom-ni>e&&(e=o.m_nBottom-ni))}if(e===undefined)for(e=0,r=0;r<v;++r)if(c=this.m_oModele.getPartOffset(r,et),!(c<=0)){if(s=undefined,u=this.tabLabelRenderers[r],u)s=Number(u.m_dAngleR).toDeg();else{if(f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f==0)continue;f=t.tweenValue(i,f,r,0);s=this.getAngleForValue(f,this.m_dTotalValue,l)}y=Number(90-(ft+s/2)).toRad();e=Math.max(e,Math.abs(c*Math.sin(y)));e=Math.max(e,Math.abs(c*Math.cos(y)))}if(this.m_nRadius-=e,this.m_nRadius-=IWDChartConstant.MARGIN_PIE,!(this.m_nRadius<=0)){var et=this.m_params.m_nExcentrageGlobal,ot=new WDRect(this.m_nCenterX-this.m_nRadius,this.m_nCenterY-this.m_nRadius,this.m_nCenterX+this.m_nRadius,this.m_nCenterY+this.m_nRadius),p=this.m_params.getDonutHoleSize(),ei=p>0&&this.m_params.getType()!=WDChartParameters.kSecteur&&this.m_params.getType()!=WDChartParameters.kHemicycle||this.m_params.getType()==WDChartParameters.kDonut,g=0;for(ei?(p<0&&(p=30),g=Math.ceil(this.m_nRadius*p/100)):p=0,g=t.tweenHoleRadius(i,g),i.wbData("wbGrfAnimTweenHoleRadius",g),oi=0,st=[],r=0;r<v;++r)if(nt=0,tt=0,f=Math.abs(this.m_oModele.getFromSerieValueAt(0,r)),f!=0){f=t.tweenValue(i,f,r,0);var s=this.getAngleForValue(f,this.m_dTotalValue,l),c=this.m_oModele.getPartOffset(r,et),ut=this.m_oModele.getCategoryColor(r),si=this.m_params.isBorderColorAuto()?clWDUtil.sCouleurHTMLPlusBrillante(ut):this.m_params.m_sCouleurBordure,ii=this.m_params.getGradientType();ii==IWDChartConstant.FLAG_VERTICAL_GRADIENT||ii==IWDChartConstant.FLAG_HORIZONTAL_GRADIENT?this.m_oPaint.setRadialGradient(this.m_nCenterX,this.m_nCenterY,this.m_nRadius,clWDUtil.sCouleurHTMLPlusBrillante(ut),ut,"pad"):this.m_oPaint.setFill(ut);c>0&&(y=Number(90-(ft+s/2)).toRad(),nt=c*Math.sin(y),tt=c*Math.cos(y),ot.offset(nt,tt));this.m_oPaint.setStroke(si);ht=this.getSeriesAlphaAt(r);ht<255?this.m_oPaint.setFillOpacity255(ht):this.m_oPaint.setFillOpacity255(255);var ri=n.g(i,"groupe-serie-"+r),w=n.g(ri,"part-effect-"+r),a=n.arc(w,"part-"+r),b=new stPath(ot,{rDonut:g,start:this.m_bDessinneSelonBissectire?ft:h,startAngle:h,sweep:s,firstAngle:this.m_dInitialStartAngle});n.drawArc(a,b=t.tweenPart(a,b),this.m_oPaint=t.tweenPartPaint(a,this.m_oPaint));a.wbData("wbGrfGrInfoXY",[0,r,f]);this.m_bDessinneSelonBissectire&&(n.rotate(ri,h+b.options.sweep/2,this.m_nCenterX,this.m_nCenterY,!0),n.rotate(a,-b.options.sweep/2,this.m_nCenterX,this.m_nCenterY,!0));this.liaisonLegendePart(n,a,r);(nt!==0||tt!==0)&&ot.offset(-nt,-tt);(d||!this.m_params.m_bBulleActive)&&(u=this.tabLabelRenderers[r],a.wbData("wbGrfPieLabelRenderer",u),this.m_params.m_bBulleActive||(this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),ui=n.bulle(w,"bulle-"+r),ct=this.m_params.m_sBulleSecteur||"[%CATEGORIE%]\n[%SERIE%]\n[%%%]",n.drawBulle(ui,ct.replace("[%CATEGORIE%]",u.m_strCategoryLabel||"").replace("[%SERIE%]",ct.indexOf("[%VALEUR%]")>-1?this.m_oModele.m_tabSeries[0].m_sLibelle||"":u.m_strValueLabel||"").replace("[%VALEUR%]",u.m_strValueLabel||"").replace("[%%%]",u.m_strPercentLabel||""),this.m_oPaint)),d&&(it=u.getBounds(rt,c,o,p),it&&!this.m_params.m_bAutoriseChevauchementEtiquettes&&(clWDUtil.bForEachIn(st,function(n,t){return WDRect.intersects(o,t)?(it=!1,!1):!0}),st.push(_clone(o))),it&&(k=n.text(w,"label-"+n.getId(w)),this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),u.draw(n,k,o.m_nLeft,o.m_nTop,rt,this.m_oPaint,t),this.m_bDessinneSelonBissectire&&n.rotate(k,-(h+b.options.sweep/2),this.m_nCenterX,this.m_nCenterY,!0)),k=n.findFromId(w,"label-"+n.getId(w)),!it&&k.length>0&&k.remove()));h+=b.options.sweep}}}}}};WDLabelRenderer.prototype.constructor=WDLabelRenderer;WDLabelRenderer.prototype.setAngle=function(n,t){for(this.m_dAngleValueR=Number(t).toRad();n<0;)n+=360;var i=n%360;this.m_dStartAngleR=Number(i%360).toRad();i+=t/2;this.m_dAngleR=Number(90-i).toRad();switch(Math.round(Number(i).toRad()/(Math.PI/4))){case 8:case 0:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_CENTRE;break;case 1:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 2:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 3:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 4:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_HAUT;break;case 5:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS;break;case 6:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS;break;case 7:this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE;this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_BAS}};WDLabelRenderer.prototype.setValueLabel=function(n,t){t!=""&&t!=this.m_strValueLabel&&(this.m_strValueLabel=t,this.m_bValueLabel=n&&t!==undefined,this.m_bValueLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.updateTotalWidth=function(n){var i=WDPaintCSS.oGetInfoCSS(this.m_oRenderer.m_params.m_sClasseLibelle,n,"width"),t=parseInt10(i.width);t>this.m_dWidth&&(this.m_dWidth=t)};WDLabelRenderer.prototype.setCategoryLabel=function(n,t){t!=""&&t!=this.m_strCategoryLabel&&(this.m_strCategoryLabel=t,this.m_bCategoryLabel=n&&t!==undefined,this.m_bCategoryLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.setPercentLabel=function(n,t){t!=""&&t!=this.m_strPercentLabel&&(this.m_strPercentLabel=t,this.m_bPercentLabel=n&&t!==undefined,this.m_bPercentLabel&&this.updateTotalWidth(t))};WDLabelRenderer.prototype.getBounds=function(n,t,i,r){var e=Math.ceil(this.m_dWidth),o=n*this.getNbLines(),h=1,c=1,s=IWDChartConstant.MARGIN_LABEL_PIE,u,f;this.m_oRenderer.m_params.m_bEtiquetteSecteurExterieures||(c=h=.5*(1+r/100),s=0,this.m_nAlignmentH=IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_nAlignmentV=IWDConstante.ALIGNEMENT_VERTICAL_CENTRE);u=Math.round(this.m_oRenderer.m_nCenterX+(this.m_oRenderer.m_nRadius*h+s+t)*Math.sin(this.m_dAngleR));switch(this.m_nAlignmentH){default:case IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE:i.m_nLeft=u;i.m_nRight=u+e;break;case IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:i.m_nLeft=u-e/2;i.m_nRight=u+e/2;break;case IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT:i.m_nLeft=u-e;i.m_nRight=u}f=Math.round(this.m_oRenderer.m_nCenterY+(this.m_oRenderer.m_nRadius*c+s+t)*Math.cos(this.m_dAngleR));switch(this.m_nAlignmentV){default:case IWDConstante.ALIGNEMENT_VERTICAL_HAUT:i.m_nTop=f;i.m_nBottom=f+o;break;case IWDConstante.ALIGNEMENT_VERTICAL_CENTRE:i.m_nTop=f-o/2;i.m_nBottom=f+o/2;break;case IWDConstante.ALIGNEMENT_VERTICAL_BAS:i.m_nTop=f-o;i.m_nBottom=f}return!this.m_oRenderer.m_params.m_bEtiquetteSecteurExterieures&&!this.contains(i,r)?!1:!0};WDLabelRenderer.prototype.contains=function(n,t){if(this.m_dAngleValueR>Math.PI/4)return!0;var r,u,f,e,o,s,i=this.m_oRenderer.m_nRadius,h=this.m_dStartAngleR+this.m_dAngleValueR,c=this.m_dStartAngleR+this.m_dAngleValueR/2;return r=this.m_oRenderer.m_nCenterX+i*(t/100)*Math.cos(c),u=this.m_oRenderer.m_nCenterY+i*(t/100)*Math.sin(c),f=this.m_oRenderer.m_nCenterX+i*Math.cos(this.m_dStartAngleR),e=this.m_oRenderer.m_nCenterY+i*Math.sin(this.m_dStartAngleR),o=this.m_oRenderer.m_nCenterX+i*Math.cos(h),s=this.m_oRenderer.m_nCenterY+i*Math.sin(h),WDChartUtils.is_in_triangle(n.m_nLeft,n.m_nTop,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nRight,n.m_nTop,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nLeft,n.m_nBottom,r,u,f,e,o,s)&&WDChartUtils.is_in_triangle(n.m_nRight,n.m_nBottom,r,u,f,e,o,s)};WDLabelRenderer.prototype.getNbLines=function(){var n=0;return this.m_bValueLabel&&++n,this.m_bCategoryLabel&&++n,this.m_bPercentLabel&&++n,n};WDLabelRenderer.prototype.draw=function(n,t,i,r,u,f,e){this.m_nAlignmentH===IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE?i+=this.m_dWidth/2:this.m_nAlignmentH===IWDConstante.ALIGNEMENT_HORIZONTAL_DROIT&&(i+=this.m_dWidth);var o=[];this.m_bCategoryLabel&&o.push(this.m_strCategoryLabel);this.m_bValueLabel&&o.push(this.m_strValueLabel);this.m_bPercentLabel&&o.push(this.m_strPercentLabel);f.DesactivePointerEvents();f=e.tweenLabelPaint(this.m_nIndice,f,t);n.drawText(t,o,u,i,r,this.m_nAlignmentH,f)};WDCandleStickChartRenderer.prototype=new WDBarChartRenderer;WDCandleStickChartRenderer.prototype.constructor=WDCandleStickChartRenderer;WDCandleStickChartRenderer.bParametresSupportes=function(n,t){return WDBarChartRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bAxeXHorizontal=!0,t.m_oParametres.m_bEchelleTemporelle=!1,!0):!1};WDCandleStickChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r,u){var h,c,f,o,l,a,e,s;if(t!==undefined&&(h=!1,c=this.m_oGraphe.m_oModele.m_tabSeries[t],c)){var y=c.getNbValues(),p=this.m_oModele.getAxisByType(EAxisType.X),v=this.getDrawnValuesCount(y,p);if(v!=0){for(f=0;f<=v;++f)if(o=this.getCategoryDrawingPositionX(f,h),o+=this.m_nBarSpacing+this.m_nBarWidth/2,o>u)break;if(l=this.getCategoryDrawingPositionX(Math.max(f-1,0),h),l+=this.m_nBarSpacing+this.m_nBarWidth/2,f>0&&u-l<o-u&&--f,a=n.g("groupe-serie-"+t),this.m_params.getType()==WDChartParameters.kMinMax){if(e=n.findFromId(a,"series-"+t+"-barre-"+f),!e||!e.length)return;i&&n.addClass(e,"wbGrfHover");WDBarChartRenderer.prototype.surbrillanceSerieDepuisMire.apply(this,arguments);n.removeClass(e,"wbGrfHover")}s=this;a.children().each(function(){var r=$(this),e=parseInt10(n.getId(r).substr(n.getId(r).lastIndexOf("-")+1)),o=i&&e==f,u=n.findFromId(n.m_domBaliseSVG,"axe-horiz-label-horiz-"+e);u&&u.length>0&&u.children().css("fill",o?s.crPlusFonce(s.m_oGraphe.m_oModele.getSeriesColor(t)):"");s.m_params.getType()!=WDChartParameters.kMinMax&&r.children().css("strokeWidth",parseInt10(r.children("line").attr("stroke-width"))+(o?2:0))})}}};WDCandleStickChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var kt=this.m_oModele.getAxisByType(EAxisType.X),dt=r.getNbValues(),gt=i,ct,ui,it,a,v,h,c,b,vt,nt,rt,tt,l,ei,yt,pt,ut,wt,ft,k,et,ot,st,bt,ht,oi,si;if(!(gt>0)&&(this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||t.empty(),ct=this.getDrawnValuesCount(dt,kt),ct!=0)){var ni=i,ti=i+1,ii=i+2,ri=i+3,hi=this.m_oModele.getSeriesAt(ni,!1),ci=this.m_oModele.getSeriesAt(ti,!1),li=this.m_oModele.getSeriesAt(ii,!1),ai=this.m_oModele.getSeriesAt(ri,!1),vi=this.m_oModele.getSeriesColor(i),d=0,lt,at=this.m_params.getType()==WDChartParameters.kMinMax&&u.isDisplayValuesLabel()&&!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();at&&(lt=this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,ui=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),d=parseInt10(ui.fontSize));var yi=this.getYOriginValue(!1),f=this.getFirstDrawnCategoryIndex(kt);for(it=0;it<ct;++it,++f)if(!(f<0)){if(f>=dt)break;a=hi.getValueAt(f);a=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,a,f,ni);v=ci.getValueAt(f);v=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,v,f,ti);h=li.getValueAt(f);h=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,h,f,ii);c=ai.getValueAt(f);c=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,c,f,ri);var e=this.getBarRect(this.m_barRect,a,v,h,c,gt,f,yi,u),o=this.m_barRect.getLeft(),y=this.m_barRect.getTop(),s=this.m_barRect.getWidth(),w=this.m_barRect.getHeight();if(at&&n.clipRect(this.m_rectAxis,"clip-axes"),s>0&&w>0){var p=vi,g=this.getBarBorderColor(p,u),fi=this.m_oModele.getCategoryColor(f,!0);fi&&(p=fi,g=this.getBarBorderColor(p,u));u.getType()==WDChartParameters.kChandelier&&c>=h&&u.m_sCouleurChandelierHausse&&(p=u.m_sCouleurChandelierHausse);b=this.createBarGradient(p,u.getGradientType());b?this.m_oPaint.setLinearGradient(b.couleurDebut,b.couleurFin,b.spreadMethod,b.bVertical):this.m_oPaint.setFill(p);vt=this.getSeriesAlphaAt(i);vt<255?this.m_oPaint.setFillOpacity255(vt):this.m_oPaint.setFillOpacity255(255);u.getType()==WDChartParameters.kBarCharts&&(g=this.crPlusFonce(g));nt=1;this.m_oPaint.setStroke(g,nt);nt>0&&g&&(rt=0,c>h&&(rt=1),rt!=0&&(tt=nt*rt/2,u.m_bAxeXHorizontal?(y+=tt,w-=tt):(o+=tt,s-=tt)));l=n.g(t,"groupe-chandelier-"+i+"-barre-"+f);l.wbData("wbGrfGrInfoXY",[i,it,a,v,h,c]);u.getType()==WDChartParameters.kMinMax?(k=n.rect(l,"series-"+i+"-barre-"+f),n.drawRect(k,new WDRect(o,y,o+s,y+w),this.m_oPaint)):(ei=new WDPaintCSS(_clone(this.m_oPaint)),yt=n.line(l,"series-"+i+"-line-"+f),n.SetAntiAliasing(!1,yt),n.drawLine(yt,o+s/2,y,o+s/2,y+w,ei),u.getType()==WDChartParameters.kBarCharts?(pt=new WDPaintCSS(_clone(this.m_oPaint)),ut=n.line(l,"series-"+i+"-linedebut-"+f),n.SetAntiAliasing(!1,ut),h<c?n.drawLine(ut,e.m_nLeft,e.m_nBottom,o+s/2,e.m_nBottom,pt):n.drawLine(ut,o+s/2,e.m_nBottom,e.m_nRight,e.m_nBottom,pt),wt=this.m_oPaint,ft=n.line(l,"series-"+i+"-linefin-"+f),n.SetAntiAliasing(!1,ft),h>c?n.drawLine(ft,e.m_nLeft,e.m_nTop,o+s/2,e.m_nTop,wt):n.drawLine(ft,o+s/2,e.m_nTop,e.m_nRight,e.m_nTop,wt)):u.getType()==WDChartParameters.kChandelier&&(k=n.rect(l,"series-"+i+"-barre-"+f),n.drawRect(k,e,this.m_oPaint)));k&&k.wbData("wbGrfDrawMire",{valeurMin:a,valeurMax:v,valeurDebut:h,valeurFin:c,couleur:p})}at&&(n.restoreClip(),bt=Align.CENTER,ht=!0,v>=0&&this.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||a<0&&this.m_barRect.m_nBottom-this.m_rectAxis.m_nBottom>1?ht=!1:w-2*nt<=2*d&&(ht=!1),ht&&(this.m_oPaint.addClasse(u.m_sClasseValeur),oi=n.text(l,"barre-"+i+"-textemin-"+f),st=WDChartUtils.formatValue(a,lt,!0),et=y+w+IWDChartConstant.MARGIN_LABEL,ot=o+s/2,this.m_oPaint.DesactivePointerEvents(),n.drawText(oi,st,d,ot,et,bt,this.m_oPaint),this.m_oPaint.addClasse(u.m_sClasseValeur),si=n.text(l,"barre-"+i+"-textemax-"+f),st=WDChartUtils.formatValue(v,lt,!0),et=y-d-IWDChartConstant.MARGIN_LABEL,ot=o+s/2,this.m_oPaint.DesactivePointerEvents(),n.drawText(si,st,d,ot,et,bt,this.m_oPaint)))}}};WDCandleStickChartRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o){var h=!1,c=this.dGetYPixelsPerUnit(h),s=new WDRect,v,a,l;return n.m_nBottom=this.nGetYOrigin(h)-Math.ceil((t-o)*c),n.m_nTop=this.nGetYOrigin(h)-Math.ceil((i-o)*c),s.m_nBottom=this.nGetYOrigin(h)-Math.ceil((r-o)*c),s.m_nTop=this.nGetYOrigin(h)-Math.ceil((u-o)*c),v=this.getCategoryDrawingPositionX(e,h)+this.m_nBarSpacing,n.m_nLeft=v,n.m_nRight=n.m_nLeft+this.m_nBarWidth,s.m_nLeft=n.m_nLeft,s.m_nRight=n.m_nRight,this.m_params.getType()==WDChartParameters.kMinMax||(a=.3*this.m_nBarWidth,s.m_nLeft+=a/2,s.m_nRight-=a/2),n.m_nTop>n.m_nBottom&&(l=n.m_nTop,n.m_nTop=n.m_nBottom,n.m_nBottom=l),s.m_nTop>s.m_nBottom&&(l=s.m_nTop,s.m_nTop=s.m_nBottom,s.m_nBottom=l),s};WDWaterfallChartRenderer.prototype=new WDBarChartRenderer;WDWaterfallChartRenderer.prototype.constructor=WDWaterfallChartRenderer;WDWaterfallChartRenderer.bParametresSupportes=function(n,t){return WDBarChartRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bAxeXHorizontal=!0,!0):!1};WDWaterfallChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var ct=u.m_bAxeXHorizontal?this.m_oModele.getAxisByType(EAxisType.X):this.m_oModele.getAxisByType(EAxisType.Y),lt=r.getNbValues(),at=i,rt,pt,b,f,s,k,o,ot,st,g,nt,w;if(!(at>0)&&(this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasCommencee()||t.empty(),rt=this.getDrawnValuesCount(lt,ct),rt!=0)){var vt=this.m_oModele.getSeriesColor(i),v=0,yt,ut=u.isDisplayValuesLabel()&&!this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie();ut&&(yt=this.m_oGraphe.m_oVue.m_oAnimator.bAnimationPasFinie()?"999 999 999":u.m_sMasqueValeur,pt=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","fontSize"),v=parseInt10(pt.fontSize));var ft=r.isOnSecondaryAxis(),dt=u.m_bAxeXHorizontal?this.getYOriginValue(ft):this.getXOriginValue(ft),e=this.getFirstDrawnCategoryIndex(ct),y=0,p=0;for(b=0;b<rt;++b,++e)if(!(e<0)){if(e>=lt)break;f=r.getValueAt(e);s=this.m_oModele.getWaterfallTypeCategorie(e);s===undefined&&(s=f>0?ETypeCategorieWaterfall.eWaterfallPositif:ETypeCategorieWaterfall.eWaterfallNegatif);k=!1;s==ETypeCategorieWaterfall.eWaterfallSousTotal?(f=p,k=!0):s==ETypeCategorieWaterfall.eWaterfallTotal&&e>0&&(f=y,k=!0);f=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,f,e,i);this.getBarRect(this.m_barRect,f,at,e,dt,y,ft,u,k);s==ETypeCategorieWaterfall.eWaterfallTotal?e>0?(p=0,y=0):(p=0,y=f):s==ETypeCategorieWaterfall.eWaterfallSousTotal?p=0:(y+=f,p+=f);var d=this.m_barRect.getLeft(),h=this.m_barRect.getTop(),c=this.m_barRect.getWidth(),l=this.m_barRect.getHeight();if(ut&&n.clipRect(this.m_rectAxis,"clip-axes"),c>0&&l>0){o=vt;this.m_oModele.m_tabCouleursWaterfall&&this.m_oModele.m_tabCouleursWaterfall[s]&&(o=this.m_oModele.m_tabCouleursWaterfall[s]);o==-3&&(o=vt);var et=this.getBarBorderColor(o,u),a=this.createBarGradient(o,u.getGradientType()),wt=this.m_oModele.getCategoryColor(e,!0);wt&&(o=wt,et=this.getBarBorderColor(o,u),a=this.createBarGradient(o,u.getGradientType()));ot=n.rect(t,"series-"+i+"-barre-"+e);a?this.m_oPaint.setLinearGradient(a.couleurDebut,a.couleurFin,a.spreadMethod,a.bVertical):this.m_oPaint.setFill(o);st=this.getSeriesAlphaAt(i);st<255?this.m_oPaint.setFillOpacity255(st):this.m_oPaint.setFillOpacity255(255);g=1;this.m_oPaint.setStroke(et,g);g>0&&et&&(nt=0,f>0&&(nt=1),nt!=0&&(w=g*nt/2,u.m_bAxeXHorizontal?(h+=w,l-=w):(d+=w,c-=w)));ot.wbData("wbGrfGrInfoXY",[i,b,f]).wbData("wbGrfDrawMire",{valeur:f,couleur:o});n.drawRect(ot,new WDRect(d,h,d+c,h+l),this.m_oPaint)}if(ut){n.restoreClip();this.m_oPaint.addClasse(u.m_sClasseValeur);var gt=n.text(t,"barre-"+i+"-texte-"+e),tt,it,bt,ht=Align.CENTER,kt=!0;(f>=0&&this.m_rectAxis.m_nTop-this.m_barRect.m_nTop>1||f<0&&this.m_barRect.m_nBottom-this.m_rectAxis.m_nBottom>1)&&(kt=!1);kt&&(bt=WDChartUtils.formatValue(f,yt,!0),tt=f<0?h+l+IWDChartConstant.MARGIN_LABEL:h-v-IWDChartConstant.MARGIN_LABEL,it=d+c/2,u.m_bAxeXHorizontal||(f<0?(tt=h+l/2-v/2,it-=IWDChartConstant.MARGIN_LABEL+c/2,ht=Align.RIGHT):(tt=h+l/2-v/2,it+=IWDChartConstant.MARGIN_LABEL+c/2,ht=Align.LEFT)),this.m_oPaint.DesactivePointerEvents(),n.drawText(gt,bt,v,it,tt,ht,this.m_oPaint))}}}};WDWaterfallChartRenderer.prototype.getBarRect=function(n,t,i,r,u,f,e,o,s){s&&(t=-t);var a=this.dGetYPixelsPerUnit(e),c=Math.ceil((t>0?Math.max(0,t-u):Math.abs(t))*a),v=Math.ceil((f>0?Math.max(0,f-u):-Math.abs(f))*a),l=0,h=0;o.m_bAxeXHorizontal&&(l=this.getCategoryDrawingPositionX(r,e)+this.m_nBarSpacing);o.m_bAxeXHorizontal&&(h=this.nGetYOrigin(e)-v,t>0&&(h-=c));o.m_bAxeXHorizontal?n.setSizeAndLocation(l,h,this.m_nBarWidth,c):n.setSizeAndLocation(l,h,c,this.m_nBarWidth)};WDRadarChartRenderer.bParametresSupportes=function(n,t){return WDLineChartRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bSpline=!1,!0):!1};WDRadarChartRenderer.prototype=new WDLineChartRenderer;WDRadarChartRenderer.prototype.constructor=WDRadarChartRenderer;WDRadarChartRenderer.prototype.Init=function(){WDLineChartRenderer.prototype.Init.apply(this,arguments)};WDRadarChartRenderer.ANGLE_DEPART=-90;WDRadarChartRenderer.TAILLE_GRADUATION=5;WDRadarChartRenderer.MINPIXEL_GRADUATION=25;WDChartRenderer.MARGE_LABELSECTEUR=IWDChartConstant.MARGIN_PIE;WDRadarChartRenderer.prototype.drawChartSeries=function(){WDXYChartRenderer.prototype.drawChartSeries.apply(this,arguments)};WDRadarChartRenderer.prototype.nGetYOrigin=function(){return this.m_clCentreRadar.y};WDRadarChartRenderer.prototype.nGetXOrigin=function(){return this.m_clCentreRadar.x};WDRadarChartRenderer.prototype.prepareRendering=function(n,t,r,u){var e,f,o,s,h;if(this.m_rectAxis=new WDRect(this.m_rectChart),this.m_rectChart.getWidth()!=0&&this.m_rectChart.getHeight()!=0){if(e=this.m_oModele.m_lstAxis.length,!this.m_tabAxisRenderer||this.m_tabAxisRenderer.length!=e)for(this.m_tabAxisRenderer=undefined,delete this.m_tabAxisRenderer,this.m_tabAxisRenderer=[],i=0;i<e;++i)this.m_tabAxisRenderer[i]=this.createAxisRenderer();for(f=0;f<e;++f)o=this.m_oModele.m_lstAxis[f],s=this.m_tabAxisRenderer[f],s.prepare(o,u,this.m_rectAxis,this.m_oPaint,o.isDisplayCategories()?this.m_timeScale:ETimeScale.NONE);return r.empty(),h=u.byGetAlpha(),h>=255&&n.g(r,"groupe-series"),this.__bCalculeVariables(n,t,r)}};WDRadarChartRenderer.prototype.drawGrids=function(n,t,i,r){var u=n.g(r,"groupe-grids");n.SetAntiAliasing(t.m_bAntiAliasing,u);u.empty();t.isHorizontalGridShown()&&this.__DessineQuadrillage(n,t,i,u)};WDRadarChartRenderer.prototype.drawAxis=function(n,t,i,r){var u=n.g(i,"groupe-axes");u.empty();r.isHorizontalGridShown()||this.__DessineGraduations(n,r,this.m_rectAxis,u);this.__bDessineAxes(n,t,u,r)&&this.__DessineTexteGraduations(n,t,u,r)};WDRadarChartRenderer.prototype.__DessineQuadrillage=function(n,t,i,r){for(var o,f,e,v,u=this.m_nGradMin+1;u<=this.m_nGradMax;++u){for(o=0,f=new Path,e=0;e<this.m_nNombreCategories;++e){o=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*e;var c=o*Math.PI/180,y=u*this.m_dPas,l=this.__dConvertitVersEcran(y),s=this.m_clCentreRadar.x+l*Math.cos(c),h=this.m_clCentreRadar.y+l*Math.sin(c),a=this.__AjusteCoordonnees(o,s,h);s=a.x;h=a.y;e==0?f.moveTo(s,h):f.lineTo(s,h)}f.close();t.m_bSpline?this.m_oPaint.setStrokeLineJoin("round"):this.m_oPaint.setStrokeLineJoin("miter");v=n.path(r,"grid-vert-"+u);this.m_oPaint.setStroke(t.m_sCouleurQuadrillage);n.drawPath(v,f.toD(),this.m_oPaint)}};WDRadarChartRenderer.prototype.__DessineTexteGraduations=function(n,t,r,u){for(var c,p,b,k,d=WDRadarChartRenderer.ANGLE_DEPART,s=d*Math.PI/180,g=u.isDisplayCategoriesLabel(),o="",h=this.getAxisRendererForType(EAxisType.Y),et=h.m_axis,nt=h.m_axis.isDisplayDecimalValues(u),l=h.m_axis.isYAxis()?u.m_sMasqueAxes:undefined,tt=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,"0","lineHeight"),a=parseInt10(tt.lineHeight),it=Math.floor(h.m_axis.m_dOriginValue),e=this.m_nGradMin+1;e<=this.m_nGradMax;++e){var v=this.__dConvertitVersEcran(this.m_dPas*e),rt=this.m_clCentreRadar.x+v*Math.cos(s),y=this.m_clCentreRadar.y+v*Math.sin(s);o="";c=g;
//!oAnimator.tweenHideLabel(domParent,!(bDisplayCategoriesLabel /*|| bDisplayPercentageLabel || bDisplayValuesLabel*/),j);  	
c&&(o=this.m_oModele.getCategoryLabelAt(i));isNaN(parseInt10(o))&&!clWDUtil.bEstChaineNonVide(o)&&(c=!1);e==this.m_nGradMax&&c&&(p=WDPaintCSS.oGetInfoCSS(u.m_sClasseLibelle,o,["height"]),y+=parseInt10(p.height)/2);var ut=rt+WDRadarChartRenderer.TAILLE_GRADUATION*Math.cos(s+Math.PI/2),ft=y+WDRadarChartRenderer.TAILLE_GRADUATION*Math.sin(s+Math.PI/2),w=e*this.m_dPas+it,f=l?WDChartUtils.formatValue(w,l,nt):w;(f=f===undefined?"":""+f,b=a*f.split("\n").length,!isNaN(parseInt10(f))||clWDUtil.bEstChaineNonVide(f))&&(k=n.text(r,"axe-horiz-label-horiz-"+e),this.m_oPaint.addClasse(u.m_sClasseLibelle),this.m_oPaint.DesactivePointerEvents(),n.drawText(k,f,a,ut,ft-b/2,Align.LEFT,this.m_oPaint,!1))}};WDRadarChartRenderer.prototype.__DessineGraduations=function(n,t,i,r){for(var u,f,h=0,e=0;e<this.m_nNombreCategories;++e)for(h=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*e,u=h*Math.PI/180,f=this.m_nGradMin+1;f<=this.m_nGradMax;++f){var c=this.__dConvertitVersEcran(this.m_dPas*f),o=this.m_clCentreRadar.x+c*Math.cos(u),s=this.m_clCentreRadar.y+c*Math.sin(u),l=this.__AjusteCoordonnees(h,o,s);o=l.x;s=l.y;var v=o+WDRadarChartRenderer.TAILLE_GRADUATION*Math.cos(u+Math.PI/2),y=s+WDRadarChartRenderer.TAILLE_GRADUATION*Math.sin(u+Math.PI/2),a=n.line(r,"axe-graduation-vert-"+e+"-"+f);this.m_oPaint.setStroke(t.m_sCouleurAxe);n.SetAntiAliasing(t.m_bAntiAliasing,a);n.drawLine(a,parseInt10(o),parseInt10(s),parseInt10(v),parseInt10(y),this.m_oPaint,!1)}};WDRadarChartRenderer.prototype.__dConvertitVersEcran=function(n){return(n-this.m_dValeurMin)*this.m_dFacteurEchelle};WDRadarChartRenderer.prototype.__AjusteCoordonnees=function(n,t,i){return n==90||n==270||n==WDRadarChartRenderer.ANGLE_DEPART?t=this.m_clCentreRadar.x:n==180&&(i=this.m_clCentreRadar.y),{x:t,y:i}};WDRadarChartRenderer.prototype.__bDessineAxes=function(n,t,i,r){for(var y,s,h,c,p,l,k,d,a=0,g=r.m_sCouleurAxe,v=[],nt=r.isDisplayCategoriesLabel(),e="",o=0;o<this.m_nNombreCategories;++o){a=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*o;var w=a*Math.PI/180,u=this.m_clCentreRadar.x+this.m_nRayon*Math.cos(w),f=this.m_clCentreRadar.y+this.m_nRayon*Math.sin(w),b=this.__AjusteCoordonnees(a,u,f);if(u=b.x,f=b.y,y=n.line(i,"axe-vert-"+o),this.m_oPaint.setStroke(g),n.SetAntiAliasing(r.m_bAntiAliasing,y),n.drawLine(y,this.m_clCentreRadar.x,this.m_clCentreRadar.y,u,f,this.m_oPaint,!1),e="",s=nt,s&&(e=this.m_oModele.getCategoryLabelAt(o)),isNaN(parseInt10(e))&&!clWDUtil.bEstChaineNonVide(e)&&(s=!1),s){for(h=WDPaintCSS.oGetInfoCSS(r.m_sClasseLibelle,e,["width","height","lineHeight"]),stSize={cx:Math.ceil(parseInt10(h.width)),cy:Math.ceil(parseInt10(h.height))},u<this.m_clCentreRadar.x&&(u-=stSize.cx),f<this.m_clCentreRadar.y&&(f-=stSize.cy),c=new WDRect,c.setSizeAndLocation(parseInt10(u),parseInt10(f),stSize.cx,stSize.cy),p=!1,l=0;l<v.length;++l)if(k=v[l],WDRect.intersects(k,c)){p=!0;break}if(p)continue;v.push(c);d=n.text(i,"axe-vert-label-horiz-"+o);this.m_oPaint.addClasse(r.m_sClasseLibelle);this.m_oPaint.DesactivePointerEvents();n.drawText(d,e,parseInt10(h.lineHeight),parseInt10(u),parseInt10(f)-5,IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,!1)}}return!0};WDRadarChartRenderer.prototype.__bCalculeVariables=function(n,t,i){var u=new WDRect(this.m_rectChart),f,r,e;for(this.m_clCentreRadar={x:u.getCenterX(),y:u.getCenterY()},f=this.getAxisRendererForType(EAxisType.Y),r=f.m_axis,this.m_nNombreCategories=0,e=0;e<r.m_lstData.length;++e)this.m_nNombreCategories=Math.max(this.m_nNombreCategories,r.m_lstData[e].m_tabValeur.length);return this.m_nNombreCategories<=0||this.m_nNombreCategories>360?!1:(this.m_dAngleDelta=360/this.m_nNombreCategories,this.m_nRayon=Math.min(u.getWidth()/2,u.getHeight()/2),this.__AjusteRayon(n,t,i),this.m_dValeurMin=Math.min(0,r.m_dMinValue),this.m_dValeurMax=r.m_dMaxValue,this.m_dValeurMax-this.m_dValeurMin==0)?!1:(this.m_params.getXAxisMin()!==IWDChartConstant.DEFAULT_VALUE&&(this.m_dValeurMin=MIN(this.m_params.getXAxisMin(),this.m_dValeurMin)),this.m_params.getXAxisMax()!==IWDChartConstant.DEFAULT_VALUE&&(this.m_dValeurMax=MAX(this.m_params.getXAxisMax(),this.m_dValeurMax)),this.m_dPas=this.m_params.getAxisStep(f.m_axis),this.m_dPas==IWDChartConstant.DEFAULT_VALUE&&(this.m_dPas=f.getAxisStep(this.m_nRayon/(this.m_dValeurMax-this.m_dValeurMin),WDRadarChartRenderer.MINPIXEL_GRADUATION,!r.isDisplayDecimalValues(this.m_params),ETimeScale.NONE)),this.m_nGradMin=Math.floor(this.m_dValeurMin/this.m_dPas),this.m_nGradMax=Math.ceil(this.m_dValeurMax/this.m_dPas),this.m_dValeurMin=this.m_nGradMin*this.m_dPas,this.m_dValeurMax=this.m_nGradMax*this.m_dPas,this.m_dFacteurEchelle=this.m_nRayon/(this.m_dValeurMax-this.m_dValeurMin),!0)};WDRadarChartRenderer.prototype.__AjusteRayon=function(){for(var u,n,i={},o=this.m_rectChart.getWidth()/2,s=this.m_rectChart.getHeight()/2,f=0,h=this.getAxisRendererForType(EAxisType.Y),c=Math.floor(h.m_axis.m_dOriginValue),r=c;r<this.m_nNombreCategories;r++){var l=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*f,t=l*Math.PI/180,e=this.m_params.isDisplayCategoriesLabel(),a=e;
//!oAnimator.tweenHideLabel(domParent,!(bDisplayCategoriesLabel /*|| bDisplayPercentageLabel || bDisplayValuesLabel*/),nCategorie);  	
(a&&e&&(n=this.m_oModele.getCategoryLabelAt(r)),!isNaN(parseInt10(n))||clWDUtil.bEstChaineNonVide(n))&&(u=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLibelle,n,["width","height"]),i={cx:Math.ceil(parseInt10(u.width)),cy:Math.ceil(parseInt10(u.height))},Math.abs(Math.sin(t))>.01&&(this.m_nRayon=Math.min(this.m_nRayon,parseInt10((o-i.cx-WDChartRenderer.MARGE_LABELSECTEUR)/Math.abs(Math.sin(t))))),Math.abs(Math.cos(t))>.01&&(this.m_nRayon=Math.min(this.m_nRayon,parseInt10((s-i.cy-WDChartRenderer.MARGE_LABELSECTEUR)/Math.abs(Math.cos(t))))),n="",f++)}};WDRadarChartRenderer.prototype.drawSeries=function(n,t,i,r,u){for(var c,l,e,v,s,h=0,b=i,f=[],o=0;o<this.m_nNombreCategories;++o){c=o;h=WDRadarChartRenderer.ANGLE_DEPART+this.m_dAngleDelta*o;l=h*Math.PI/180;e=r.getValueAtWithNull(c);(e===undefined||e===null)&&(e=this.m_dValeurMin);e=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,e,c,i);var a=this.__dConvertitVersEcran(e),y=this.m_clCentreRadar.x+a*Math.cos(l),p=this.m_clCentreRadar.y+a*Math.sin(l),w=this.__AjusteCoordonnees(h,y,p);f.push(w)}v=f.length;v>=2&&(f.push(f[0]),s=this.m_oModele.getSeriesColor(i),this.drawLineBackground(n,t,i,r,f,u,s),this.drawLine(n,t,i,r,f,u,s),f.pop(),this.drawPoints(n,t,i,r,f,u,s))};WDRadarChartLegendListener.prototype=new WDXYChartLegendListener;WDRadarChartLegendListener.prototype.constructor=WDRadarChartLegendListener;WDRadarChartLegendListener.prototype.SurvolLegende=function(n){WDXYChartLegendListener.prototype.SurvolLegende.apply(this,arguments);var t=this.m_oVue.m_oPicture,i=this.m_domGroupeSerie.parent();t.removeClass(i,"wbGrfHover");n&&t.addClass(i,"wbGrfHover");i.find(".wbGrfHover").each(function(){t.removeClass($(this),"wbGrfHover")});n&&t.addClass(this.m_domGroupeSerie,"wbGrfHover")};WDRadarChartAnimator.prototype=new WDXYChartAnimator;WDRadarChartAnimator.prototype.constructor=WDRadarChartAnimator;WDRadarChartAnimator.prototype.TermAnimator=function(){WDChartAnimator.prototype.TermAnimator.apply(this.arguments);this.m_domStyle.remove()};WDScatterChartRenderer.bParametresSupportes=function(n,t){return WDLineChartRenderer.bParametresSupportes(n,t)?!0:!1};WDScatterChartRenderer.prototype=new WDLineChartRenderer;WDScatterChartRenderer.prototype.constructor=WDScatterChartRenderer;WDScatterChartRenderer.prototype.getValueDrawingPosition=function(n,t,i,r){var u=this.getDrawingPositionX(i,r),f=this.getDrawingPositionY(n-t,r);return{x:u,y:f}};WDScatterChartRenderer.prototype.drawChartSeries=function(){WDXYChartRenderer.prototype.drawChartSeries.apply(this,arguments)};WDScatterChartRenderer.prototype.getDrawnValuesCount=function(n){return n};WDScatterChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var f,e,c,b,k,v,d;var o=i,y=i+1,h=this.m_oModele.getSeriesAt(o,!1),l=this.m_oModele.getSeriesAt(y,!1);if(l){var g=this.m_oModele.getAxisByType(EAxisType.X),p=r.getNbValues(),a=this.getDrawnValuesCount(p,g);if(a!=0){var s=[],w=h.isOnSecondaryAxis(),nt=this.getYOriginValue(w),tt=l.getNbValues();for(f=0;f<Math.min(a,p);++f){if(f>=tt)break;if(e=l.getValueAtWithNull(f),c=h.getValueAt(f),e===undefined||e===null)switch(this.getSeriesDessinValeursNullesAt(i)){case eDESSINVALEURNULLE.eValeurNulleIgnoree:continue;case eDESSINVALEURNULLE.eValeurNulleAZero:e=0;break;case eDESSINVALEURNULLE.eValeurNulleNonDessinee:f>0&&f<a-1&&s.push(IWDChartConstant.SPECIAL_VALUE);continue}c=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,c,f,o);e=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,e,f,y);b=this.getValueDrawingPosition(e,nt,c,w);s.push(b)}k=s.length;k>0&&(v=this.m_oModele.getSeriesColor(o),u.m_bLigne&&this.drawLine(n,t,o,h,s,u,v),d=r.m_eTypePoint,r.m_eTypePoint==EPointStyle.NONE&&(r.m_eTypePoint=EPointStyle.CIRCLE),this.drawPoints(n,t,o,h,s,u,v),r.m_eTypePoint=d)}}};WDBubbleChartRenderer.bParametresSupportes=function(n,t){return WDScatterChartRenderer.bParametresSupportes(n,t)?!0:!1};WDBubbleChartRenderer.prototype=new WDScatterChartRenderer;WDBubbleChartRenderer.prototype.constructor=WDBubbleChartRenderer;WDBubbleChartRenderer.eGrapheBulleProportionnelRayon=0;WDBubbleChartRenderer.eGrapheBulleProportionnelSurface=1;WDBubbleChartRenderer.eGrapheBulleProportionnelVolume=2;WDBubbleChartRenderer.prototype.drawChart=function(){this.CalculeBorneZ();this.m_dRayonMaxBulle=this.__dCalculeRayonMaxBulle(this.m_params);WDScatterChartRenderer.prototype.drawChart.apply(this,arguments)};WDBubbleChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var et,ot,f,o,e,a,k;var ht=u.isDisplayCategoriesLabel(),ct=u.isDisplayValuesLabel(),lt=u.m_sMasqueValeur,h=i,d=i+1,g=i+2,v=this.m_oModele.getSeriesAt(h,!1),y=this.m_oModele.getSeriesAt(d,!1),nt=this.m_oModele.getSeriesAt(g,!1);if(y&&nt){var at=this.m_oModele.getAxisByType(EAxisType.X),tt=r.getNbValues(),it=this.getDrawnValuesCount(tt,at);if(it!=0){var s=[],rt=v.isOnSecondaryAxis(),vt=this.getYOriginValue(rt),ut=y.getNbValues(),l=n.g(t,"serie-line-"+h),ft=this.m_oModele.getSeriesColor(h);for(f=0;f<Math.min(it,tt);++f){if(f>=ut)break;var c=nt.getValueAt(f),p=y.getValueAt(f),w=v.getValueAt(f);w=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,w,f,h);p=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,p,f,d);o=this.getValueDrawingPosition(p,vt,w,rt);e="";ht&&(e+=this.m_oModele.getCategoryLabelAt(f));ct&&(e.length&&(e+="\n"),e+=WDChartUtils.formatValue(c,lt,!0));o.label=e;c=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,c,f,g);o.z=this.__dCalculeRayonBulle(Math.abs(c),u);c<0&&(o.color=clWDUtil.sCouleurHTMLPlusBrillante(clWDUtil.sGetCouleurHTMLAssocie(ft)));s.push(o)}for(et=s.length,et>0&&(this.saveLineData(l,h,s),ot=r.m_eTypePoint,r.m_eTypePoint=EPointStyle.CIRCLE,this.drawPoints(n,l,h,v,s,u,ft),r.m_eTypePoint=ot),f=0;f<s.length;++f){if(f>=ut)break;if(o=s[f],e=o.label,e.length){a=n.text(l,"label-"+i+"-"+ +f);this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle);this.m_oPaint.DesactivePointerEvents();var b=WDPaintCSS.oGetInfoCSS(this.m_oPaint,e,["width","height","lineHeight"]),st=parseInt10(b.lineHeight),yt=parseInt10(b.height),pt=parseInt10(b.width);n.drawText(a,e,st,o.x,o.y-.5*st*((e.split("\n").length||0)+1),IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint)}}for(k=s.length;(a=n.findFromId(l,"label-"+i+"-"+ +k)).length>0;++k)a.remove()}}};WDBubbleChartRenderer.prototype.__dCalculeRayonMaxBulle=function(n){var t=this.m_rectChart,i=Math.min(t.m_nRight-t.m_nLeft,t.m_nBottom-t.m_nTop),r;return i/=10,r=n.m_nEchelleTailleBulle===undefined?1:n.m_nEchelleTailleBulle/100,i*r};WDBubbleChartRenderer.prototype.__dCalculeRayonBulle=function(n,t){var i=Math.PI,r,u,f,e;switch(t.m_eAlgoGrapheBulle){case WDBubbleChartRenderer.eGrapheBulleProportionnelSurface:return r=i*this.m_dRayonMaxBulle*this.m_dRayonMaxBulle,u=n/this.m_dValeurMaxZ*r,Math.sqrt(u/i);case WDBubbleChartRenderer.eGrapheBulleProportionnelVolume:return f=4/3*i*this.m_dRayonMaxBulle*this.m_dRayonMaxBulle*this.m_dRayonMaxBulle,e=n/this.m_dValeurMaxZ*f,Math.pow(3*e/(4*i),1/3);case WDBubbleChartRenderer.eGrapheBulleProportionnelRayon:default:return n/this.m_dValeurMaxZ*this.m_dRayonMaxBulle}};WDBubbleChartRenderer.prototype.CalculeBorneZ=function(){for(var i,f,n,t,o=this.m_oModele.m_tabSeries.length,u=2;u<o;u+=3)if(i=this.m_oModele.getSeriesAt(u,!1),i){var h=this.m_oModele.getAxisByType(EAxisType.Z),e=i.getNbValues(),s=e,r=0;for(f=0;f<s;++f,++r)if(!(r<0)){if(r>=e)break;(t=i.getValueAtWithNull(r),t!==undefined&&t!==IWDChartConstant.NULL_VALUE)&&(n===undefined||t>n)&&(n=t)}}this.m_dValeurMaxZ=n=Math.max(n,0)};WDHeatmapChartRenderer.bParametresSupportes=function(n,t){return WDScatterChartRenderer.bParametresSupportes(n,t)?(t.m_oParametres.m_bSpline=!1,!0):!1};WDHeatmapChartRenderer.prototype=new WDScatterChartRenderer;WDHeatmapChartRenderer.prototype.constructor=WDHeatmapChartRenderer;WDHeatmapChartRenderer.prototype._vbLegendevaleur=function(){return!0};WDHeatmapChartRenderer.prototype.Init=function(){WDScatterChartRenderer.prototype.Init.apply(this,arguments)};WDHeatmapChartRenderer.prototype.drawChart=function(){WDScatterChartRenderer.prototype.drawChart.apply(this,arguments)};WDHeatmapChartRenderer.prototype.drawGrids=function(n,t,i,r){WDXYChartRenderer.prototype.drawGrids.apply(this,arguments);var u=n.rect(r,"CouleurHeatMapValeurVide");this.m_oModele.m_oParametres.m_sCouleurHeatMapValeurVide?(this.m_oPaint.setFill(this.m_oModele.m_oParametres.m_sCouleurHeatMapValeurVide),n.drawRect(u,this.m_rectAxis,this.m_oPaint)):u.remove()};WDHeatmapChartRenderer.prototype.getValueDrawingPosition=function(n,t,i,r){var u=this.getDrawingPositionX(i+(i<0?1:0),r),f=this.getDrawingPositionY(n-t+(n<t?1:0),r);return{x:u,y:f}};WDHeatmapChartRenderer.prototype.drawSeries=function(n,t,i,r,u){var st,ht,ct,f,e,o,v,k;var g=u.isDisplayCategoriesLabel(),at=u.isDisplayValuesLabel(),vt=u.m_sMasqueValeur,c=i,nt=i+1,tt=i+2,y=this.m_oModele.getSeriesAt(c,!1),p=this.m_oModele.getSeriesAt(nt,!1),it=this.m_oModele.getSeriesAt(tt,!1);if(p&&it){var yt=this.m_oModele.getAxisByType(EAxisType.X),rt=r.getNbValues(),ut=this.getDrawnValuesCount(rt,yt);if(ut!=0){var s=[],l=y.isOnSecondaryAxis(),pt=this.getYOriginValue(l),ft=p.getNbValues(),h=n.g(t,"serie-line-"+c);WDHeatmapChartAnimator.ms_bAnimationPluie&&h.empty();var et=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLibelle,"0"+(g?"\n0":""),["width","height","lineHeight"]),ot=parseInt10(et.lineHeight),wt=parseInt10(et.height);for(f=0;f<Math.min(ut,rt);++f){if(f>=ft)break;var a=it.getValueAt(f),w=p.getValueAt(f),b=y.getValueAt(f);b=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,b,f,c);w=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,w,f,nt);e=this.getValueDrawingPosition(w,pt,b,l);o="";g&&(o+=this.m_oModele.getCategoryLabelAt(f));at&&(o.length&&(o+="\n"),o+=WDChartUtils.formatValue(a,vt,!0));e.label=o;a=this.m_oGraphe.m_oVue.m_oAnimator.tweenValue(t,a,f,tt);e.z={width:this.dGetXPixelsPerUnit(l)/2,height:this.dGetYPixelsPerUnit(l)/2};e.x-=this.dGetXPixelsPerUnit(l)/2;e.y+=this.dGetYPixelsPerUnit(l)/2;e.color=this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(a);e.stroke="transparent";e.fAnimation=!1;e.radialCentre=!0;e.data={wbGrfDonneesInfos:{i:f}};s.push(e)}for(st=s.length,st>0&&(ht=this.m_oModele.getSeriesColor(c),this.saveLineData(h,c,s),ct=r.m_eTypePoint,r.m_eTypePoint=EPointStyle.SQUARE,this.drawPoints(n,h,c,y,s,u,ht),r.m_eTypePoint=ct),f=0;f<s.length;++f){if(f>=ft)break;e=s[f];o=e.label;o.length&&wt<e.z.height*2&&(v=n.text(h,"label-"+i+"-"+ +f),this.m_oPaint.addClasse(this.m_params.m_sClasseLibelle),this.m_oPaint.DesactivePointerEvents(),n.drawText(v,o,ot,e.x,e.y-ot*o.split("\n").length*.5,IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE,this.m_oPaint,!1))}for(k=s.length;(v=n.findFromId(h,"label-"+i+"-"+ +k)).length>0;++k)v.remove();if(WDHeatmapChartAnimator.ms_bAnimationPluie){var d=1,bt="opacity:0;animation:"+u.m_nDureeAnimation*d+"ms fadeInDownBig, "+u.m_nDureeAnimation*d+"ms fadeIn forwards;",lt=h.find("rect");lt.each(function(t){var r=bt+"animation-delay:"+t/lt.length*u.m_nDureeAnimation*d+"ms";$(this).add(n.findFromId(h,"label-"+i+"-"+ +t)).attr("style",r).animate({content:1},{queue:"fx",duration:u.m_nDureeAnimation,always:function(){$(this).removeAttr("style")}})})}}}};WDHeatmapChartRenderer.prototype.getNbLegendLabels=function(){return 10};WDHeatmapChartRenderer.prototype.getLegendColorAt=function(n){return n==0?this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMinZ):this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMaxZ)};WDHeatmapChartRenderer.prototype.getLegendLabelAt=function(n){var t=this.m_params.m_sMasqueValeur;return WDChartUtils.formatValue(n==0?this.m_dValeurMinZ:this.m_dValeurMaxZ,t,!0)};WDHeatmapChartRenderer.prototype.CalculeBorneZ=function(){for(var r,n=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY,u=this.m_oModele.m_tabSeries.length,i=2;i<u;i+=this.m_nPasSerie)r=this.m_oModele.getSeriesAt(i),t=Math.max(t,Math.max.apply(null,r.m_tabValeur)),n=Math.min(n,Math.min.apply(null,r.m_tabValeur));this.m_dValeurMinZ=Math.min(n,0);this.m_dValeurMaxZ=Math.max(t,0);this.m_clCouleurAltitudeHeatMap=new CCouleurAltitude(this.m_oGraphe.m_oModele.m_oParametres);this.m_dValeurMaxZ-this.m_dValeurMinZ>0&&!this.m_clCouleurAltitudeHeatMap.bUtiliseCouleurAltitude()&&(this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude(this.m_dValeurMinZ,"#00FF00"),this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude((this.m_dValeurMinZ+this.m_dValeurMaxZ)/2,"#FFFF00"),this.m_clCouleurAltitudeHeatMap.AddCouleurAltitude(this.m_dValeurMaxZ,"#FF0000"))};WDHeatmapChartRenderer.prototype.draw=function(n){WDScatterChartRenderer.prototype.draw.apply(this,arguments);var t=n.g(this.m_domGroupeSeries,"groupe-grids");this.m_domGroupeSeries.append(t.detach())};WDHeatmapChartRenderer.prototype.drawLegend=function(){this.CalculeBorneZ();WDScatterChartRenderer.prototype.drawLegend.apply(this,arguments)};WDHeatmapChartRenderer.prototype.createAxisRenderer=function(){return new WDHeatMapChartAxisRenderer(this)};WDHeatmapChartRenderer.prototype._surbrillanceGraduation=function(n,t,i,r){var u=n.findFromId(n.m_domBaliseSVG,"groupe-axes");u.find("tspan").css("font-weight","");r&&(n.findFromId(u,"groupe-axe-0").find("text").each(function(){if($(this).wbData("wbGrfGraduationValeur")==t)return $(this).find("tspan").css("font-weight","bolder"),!1}),n.findFromId(u,"groupe-axe-1").find("text").each(function(){if($(this).wbData("wbGrfGraduationValeur")==i)return $(this).find("tspan").css("font-weight","bolder"),!1}))};WDHeatmapChartRenderer.prototype._surbrillancePointeurLegende=function(n,t,i){var s=n.polygon(this.m_domGroupeLegendeEtTitre,"legende-curseur"),o,h,l;if(!i)return s&&s.length&&s.finish().fadeOut({always:function(){this.visible=!1}}),t;if(o=n.findFromId(this.m_domGroupeLegendeEtTitre,"legende-degrade"),!o||!o.length)return t;var e=o.wbData("wbGrfDrawInfos"),u=e.x,f=e.y,r=5,c=e.height>e.width,a=undefined;clWDUtil.isObject(t)&&(a=!1,h=o.wbData("wbGrfOnScrollResize"),h||$(window).on("scroll.wb.grf.heatmap.legende resize.wb.grf.heatmap.legende trigger.wb.grf.heatmap.legende",function(){o.wbData("wbGrfOnScrollResize",h=o.offset())}).trigger("trigger.wb.grf.heatmap.legende"),t=c?this.m_dValeurMinZ+(1-(t.y-h.top)/e.height)*(this.m_dValeurMaxZ-this.m_dValeurMinZ):this.m_dValeurMinZ+(t.x-h.left)/e.width*(this.m_dValeurMaxZ-this.m_dValeurMinZ));l=1-(t-this.m_dValeurMinZ)/(this.m_dValeurMaxZ-this.m_dValeurMinZ);c?f+=e.height*l:u+=e.width*(1-l);s[0].visible||s.finish().fadeIn({always:function(){this.visible=!0}});this.m_oPaint.setFill("black");var y=this.m_params.m_sMasqueValeur,p=WDChartUtils.formatValue(t,y,!0),v=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,p,["color"]);return v.color&&this.m_oPaint.setFill(v.color),n.drawPolygon(s,c?[[u-r,f-r],[u+r,f],[u-r,f+r],[u-r,f-r]]:[[u-r,f-r],[u+r,f-r],[u,f+r],[u-r,f-r]],this.m_oPaint,a),t};WDHeatmapChartRenderer.prototype.surbrillanceSerieDepuisMire=function(n,t,i,r,u,f,e){var h,c,l,o,s;if(i){if(o=e?e.wbData("wbGrfDonneesInfos"):this.m_oGraphe.grInfoXY("i",u,f,"wbGrfDonneesInfos"),!o)return;if(s=o.i,this.sDernierAppelSurbrillanceSerieDepuisMire==s)return;this.sDernierAppelSurbrillanceSerieDepuisMire=s;var a=this.m_oGraphe.m_oModele.getSeriesAt(0,!1),v=this.m_oGraphe.m_oModele.getSeriesAt(1,!1),y=this.m_oGraphe.m_oModele.getSeriesAt(2,!1);h=a.getValueAt(o.i);c=v.getValueAt(o.i);l=y.getValueAt(o.i)}else this.sDernierAppelSurbrillanceSerieDepuisMire=undefined;this._surbrillancePointeurLegende(n,l,i);this._surbrillanceGraduation(n,h,c,i)};WDHeatmapChartRenderer.prototype._drawLegendValeurPaint=function(n,t,i,r,u){var e=WDRect.getHeight(r)>WDRect.getWidth(r),o=this.m_params.m_sMasqueValeur,y=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,WDChartUtils.formatValue(this.m_dValeurMinZ,o,!0),["width","lineHeight","fontSize"]),f=parseInt10(y.fontSize),s=new WDRect,h=new WDRect,p,w,b,c,a,l,v;for(e?(h={x:r.m_nLeft+WDRect.getWidth(r)/2,y:r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS},s={x:r.m_nLeft+WDRect.getWidth(r)/2,y:r.m_nBottom-IWDChartConstant.MARGIN_LEGEND_ELEMENTS-f},r.m_nTop+=f+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nBottom-=f+IWDChartConstant.MARGIN_LEGEND_ELEMENTS):(p=WDPaintCSS.oGetInfoCSS(this.m_params.m_sClasseLegende,WDChartUtils.formatValue(this.m_dValeurMaxZ,o,!0),["width","lineHeight","fontSize"]),h={x:r.m_nRight-IWDChartConstant.MARGIN_LEGEND_ELEMENTS,y:r.m_nTop+WDRect.getHeight(r)/2-f/2},s={x:r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,y:r.m_nTop+WDRect.getHeight(r)/2-f/2},r.m_nLeft+=parseInt10(y.fontSize)+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nRight-=parseInt10(p.fontSize)+IWDChartConstant.MARGIN_LEGEND_ELEMENTS),w=t.text(n,"legende-texte-min"),this.m_oPaint.addClasse(this.m_params.m_sClasseLegende),t.drawText(w,WDChartUtils.formatValue(this.m_dValeurMinZ,o,!0),f,s.x,s.y,e?IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:IWDConstante.ALIGNEMENT_HORIZONTAL_GAUCHE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||u?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende),b=t.text(n,"legende-texte-max"),this.m_oPaint.addClasse(this.m_params.m_sClasseLegende),t.drawText(b,WDChartUtils.formatValue(this.m_dValeurMaxZ,o,!0),f,h.x,h.y,e?IWDConstante.ALIGNEMENT_HORIZONTAL_CENTRE:IWDConstante.ALIGNEMENT_HORIZONTAL_DROITE,this.m_oPaint,this.m_params.m_nDureeAnimation===0||u?!1:bIEAvec11?WDSvgAnimation:WDSvgAnimationLegende),this.m_oPaint.setLinearGradient(this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMinZ),this.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_dValeurMaxZ),"pad",e,1,1,!1),c=0;c<this.m_clCouleurAltitudeHeatMap.nGetNbCouleurs();++c)a=this.m_clCouleurAltitudeHeatMap.stGetI(c),l=parseFloat((a.m_dAltitude-this.m_dValeurMinZ)*100/(this.m_dValeurMaxZ-this.m_dValeurMinZ)),e&&(l=100-l),this.m_oPaint.m_stLinearGradient.stop[l]={color:a.m_crCouleur,opacity:1};v=t.rect(n,"legende-degrade");this.ecouteLegende(v);t.drawRect(v,new WDRect(r.m_nLeft+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nTop+IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nRight-IWDChartConstant.MARGIN_LEGEND_ELEMENTS,r.m_nBottom-IWDChartConstant.MARGIN_LEGEND_ELEMENTS),this.m_oPaint,undefined,undefined,this.m_params.m_nDureeAnimation===0||u?!1:WDSvgAnimationLegende)};WDHeatmapChartRenderer.prototype.ecouteLegende=function(n){return WDChartListener.bind(WDHeatmapChartLegendListener,this.m_oGraphe,n)};WDHeatmapChartLegendListener.prototype=new WDXYChartLegendListener;WDHeatmapChartLegendListener.prototype.constructor=WDHeatmapChartLegendListener;WDHeatmapChartLegendListener.prototype.SurvolLegende=function(n){var f,i,t;if(this.event){var e=this.m_oGraphe.m_oVue.m_oRenderer,r=this.m_oGraphe.m_oVue.m_oPicture,o=e._surbrillancePointeurLegende(r,{x:this.event.pageX,y:this.event.pageY},n),s=r.findFromId(r.m_domBaliseSVG,"serie-line-0"),u=s.find("rect");if(u.attr("fill-opacity",1),n)for(f=this.m_oGraphe.m_oModele.getSeriesAt(2,!1),t=undefined,i=0;i<u.length;++i)t=$(u[i]),f.getValueAt(t.wbData("wbGrfDonneesInfos").i)<o&&t.attr("fill-opacity",.25)}};WDHeatmapChartLegendListener.prototype.mousemove=function(){WDHeatmapChartLegendListener.prototype.mouseenter.apply(this,arguments)};WDHeatmapChartLegendListener.prototype.SelectionneLegende=function(){};WDHeatmapChartAnimator.prototype=new WDXYChartAnimator;WDHeatmapChartAnimator.prototype.constructor=WDHeatmapChartAnimator;WDHeatmapChartAnimator.ms_bAnimationPluie=!1;WDHeatmapChartAnimator.prototype.playMajDonnees=function(n,t){if(n.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeurHeatMap(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);WDHeatmapChartAnimator.ms_bAnimationPluie&&(i.m_oModelePrecedent=undefined,i.duration=1);this.add(i,!0)};WDHeatmapChartAnimator.prototype.play1erAffichage=function(n,t){if(this.m_oGraphe.m_oModele.m_oParametres.m_nDureeAnimation===0){WDChartAnimator.prototype.play1erAffichage.apply(this,arguments);return}var i=new WDChartAnimationValeurHeatMap(n,t);n.m_oModele.m_oParametres.m_nDureeAnimation>0&&(i.duration=n.m_oModele.m_oParametres.m_nDureeAnimation);i.m_oModelePrecedent=undefined;WDHeatmapChartAnimator.ms_bAnimationPluie&&(i.duration=1);this.add(i)};WDHeatmapChartAnimator.prototype.tweenValuePaint=function(){for(var t=new Array(arguments.length),n=0;n<arguments.length;n++)t[n]=arguments[n];return this.call(t,"tweenValuePaint")};WDChartAnimationValeurHeatMap.prototype=new WDChartAnimationValeur;WDChartAnimationValeurHeatMap.prototype.constructor=WDChartAnimationValeurHeatMap;WDChartAnimationValeurHeatMap.prototype.tweenValue=function(n,t,i,r){switch((r+1)%3){case 0:return t;case 1:if(this.m_oModelePrecedent)break;return t;case 2:if(this.m_oModelePrecedent)break;return t;default:return t}return WDChartAnimationValeur.prototype.tweenValue.apply(this,arguments)};WDChartAnimationValeurHeatMap.prototype.tweenValuePaint=function(n,t,i,r){var u=clWDUtil.tabHTML2RVBA(t),f,e;if(this.m_oModelePrecedent&&n&&n.length){n.wbData("fill")||(n.wbData("fill",n.attr("fill")),n.wbData("fill")=="none"&&n.wbData("fill",this.m_oGraphe.m_oVue.m_oRenderer.m_clCouleurAltitudeHeatMap.sGetCouleurAltitude(this.m_oGraphe.m_oVue.m_oRenderer.m_dValeurMinZ)));var o=this.m_oGraphe.m_oModele.getSeriesAt(i,!1),h=o.getValueAt(r),s=(h-1)/o.getMaxValue();if(this.m_dNow<s)return n.wbData("fill");f=1-(1-this.m_dNow)/(1-s);e=clWDUtil.tabHTML2RVBA(n.wbData("fill")||t);u[0]=this.tween(e[0],u[0],f);u[1]=this.tween(e[1],u[1],f);u[2]=this.tween(e[2],u[2],f);this.m_dNow==1&&n.wbRemoveData("fill")}else u[3]=u[3]*this.m_dNow;return clWDUtil.sRVBA2HTML(u)};WDHeatMapChartAxisRenderer.prototype=new WDLineChartAxisRenderer;WDHeatMapChartAxisRenderer.prototype.constructor=WDHeatMapChartAxisRenderer;WDHeatMapChartAxisRenderer.prototype.isDrawLabelsBetweenGraduations=function(){return!0};WDHeatMapChartAxisRenderer.prototype.isDrawnZero=function(){return!1};WDHeatMapChartAxisRenderer.prototype.isDrawnAxisLine=function(){return!1};WDHeatMapChartAxisRenderer.getAxisStep=WDHeatMapChartAxisRenderer.prototype.getAxisStep=function(){return 1}